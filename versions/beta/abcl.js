!function(){"use strict";var e={};!function(e){!function(){const t="1.2.0";function n(e){alert("Mod ERROR:\n"+e);const t=new Error(e);throw console.error(t),t}const i=new TextEncoder;function s(e){return!!e&&"object"==typeof e&&!Array.isArray(e)}function r(e){const t=new Set;return e.filter((e=>!t.has(e)&&t.add(e)))}const a=new Map,o=new Set;function l(e){o.has(e)||(o.add(e),console.warn(e))}function c(e){const t=[],n=new Map,i=new Set;for(const s of h.values()){const r=s.patching.get(e.name);if(r){t.push(...r.hooks);for(const[t,a]of r.patches.entries())n.has(t)&&n.get(t)!==a&&l(`ModSDK: Mod '${s.name}' is patching function ${e.name} with same pattern that is already applied by different mod, but with different pattern:\nPattern:\n${t}\nPatch1:\n${n.get(t)||""}\nPatch2:\n${a}`),n.set(t,a),i.add(s.name)}}t.sort(((e,t)=>t.priority-e.priority));const s=function(e,t){if(0===t.size)return e;let n=e.toString().replaceAll("\r\n","\n");for(const[i,s]of t.entries())n.includes(i)||l(`ModSDK: Patching ${e.name}: Patch ${i} not applied`),n=n.replaceAll(i,s);return(0,eval)(`(${n})`)}(e.original,n);let r=function(t){var n,r;const a=null===(r=(n=y.errorReporterHooks).hookChainExit)||void 0===r?void 0:r.call(n,e.name,i),o=s.apply(this,t);return null==a||a(),o};for(let n=t.length-1;n>=0;n--){const i=t[n],s=r;r=function(t){var n,r;const a=null===(r=(n=y.errorReporterHooks).hookEnter)||void 0===r?void 0:r.call(n,e.name,i.mod),o=i.hook.apply(this,[t,e=>{if(1!==arguments.length||!Array.isArray(t))throw new Error(`Mod ${i.mod} failed to call next hook: Expected args to be array, got ${typeof e}`);return s.call(this,e)}]);return null==a||a(),o}}return{hooks:t,patches:n,patchesSources:i,enter:r,final:s}}function u(e,t=!1){let n=a.get(e);if(n)t&&(n.precomputed=c(n));else{let t=window;const r=e.split(".");for(let n=0;n<r.length-1;n++)if(t=t[r[n]],!s(t))throw new Error(`ModSDK: Function ${e} to be patched not found; ${r.slice(0,n+1).join(".")} is not object`);const o=t[r[r.length-1]];if("function"!=typeof o)throw new Error(`ModSDK: Function ${e} to be patched not found`);const l=function(e){let t=-1;for(const n of i.encode(e)){let e=255&(t^n);for(let t=0;t<8;t++)e=1&e?-306674912^e>>>1:e>>>1;t=t>>>8^e}return(~t>>>0).toString(16).padStart(8,"0").toUpperCase()}(o.toString().replaceAll("\r\n","\n")),u={name:e,original:o,originalHash:l};n=Object.assign(Object.assign({},u),{precomputed:c(u),router:()=>{},context:t,contextProperty:r[r.length-1]}),n.router=function(e){return function(...t){return e.precomputed.enter.apply(this,[t])}}(n),a.set(e,n),t[n.contextProperty]=n.router}return n}function d(){for(const e of a.values())e.precomputed=c(e)}function p(){const e=new Map;for(const[t,n]of a)e.set(t,{name:t,original:n.original,originalHash:n.originalHash,sdkEntrypoint:n.router,currentEntrypoint:n.context[n.contextProperty],hookedByMods:r(n.precomputed.hooks.map((e=>e.mod))),patchedByMods:Array.from(n.precomputed.patchesSources)});return e}const h=new Map;function m(e){h.get(e.name)!==e&&n(`Failed to unload mod '${e.name}': Not registered`),h.delete(e.name),e.loaded=!1,d()}function f(e,t){e&&"object"==typeof e||n("Failed to register mod: Expected info object, got "+typeof e),"string"==typeof e.name&&e.name||n("Failed to register mod: Expected name to be non-empty string, got "+typeof e.name);let i=`'${e.name}'`;"string"==typeof e.fullName&&e.fullName||n(`Failed to register mod ${i}: Expected fullName to be non-empty string, got ${typeof e.fullName}`),i=`'${e.fullName} (${e.name})'`,"string"!=typeof e.version&&n(`Failed to register mod ${i}: Expected version to be string, got ${typeof e.version}`),e.repository||(e.repository=void 0),void 0!==e.repository&&"string"!=typeof e.repository&&n(`Failed to register mod ${i}: Expected repository to be undefined or string, got ${typeof e.version}`),null==t&&(t={}),t&&"object"==typeof t||n(`Failed to register mod ${i}: Expected options to be undefined or object, got ${typeof t}`);const r=!0===t.allowReplace,a=h.get(e.name);a&&(a.allowReplace&&r||n(`Refusing to load mod ${i}: it is already loaded and doesn't allow being replaced.\nWas the mod loaded multiple times?`),m(a));const o=e=>{let t=p.patching.get(e.name);return t||(t={hooks:[],patches:new Map},p.patching.set(e.name,t)),t},l=(e,t)=>(...s)=>{var r,a;const o=null===(a=(r=y.errorReporterHooks).apiEndpointEnter)||void 0===a?void 0:a.call(r,e,p.name);p.loaded||n(`Mod ${i} attempted to call SDK function after being unloaded`);const l=t(...s);return null==o||o(),l},c={unload:l("unload",(()=>m(p))),hookFunction:l("hookFunction",((e,t,s)=>{"string"==typeof e&&e||n(`Mod ${i} failed to patch a function: Expected function name string, got ${typeof e}`);const r=u(e),a=o(r);"number"!=typeof t&&n(`Mod ${i} failed to hook function '${e}': Expected priority number, got ${typeof t}`),"function"!=typeof s&&n(`Mod ${i} failed to hook function '${e}': Expected hook function, got ${typeof s}`);const l={mod:p.name,priority:t,hook:s};return a.hooks.push(l),d(),()=>{const e=a.hooks.indexOf(l);e>=0&&(a.hooks.splice(e,1),d())}})),patchFunction:l("patchFunction",((e,t)=>{"string"==typeof e&&e||n(`Mod ${i} failed to patch a function: Expected function name string, got ${typeof e}`);const r=u(e),a=o(r);s(t)||n(`Mod ${i} failed to patch function '${e}': Expected patches object, got ${typeof t}`);for(const[s,r]of Object.entries(t))"string"==typeof r?a.patches.set(s,r):null===r?a.patches.delete(s):n(`Mod ${i} failed to patch function '${e}': Invalid format of patch '${s}'`);d()})),removePatches:l("removePatches",(e=>{"string"==typeof e&&e||n(`Mod ${i} failed to patch a function: Expected function name string, got ${typeof e}`);const t=u(e);o(t).patches.clear(),d()})),callOriginal:l("callOriginal",((e,t,s)=>{"string"==typeof e&&e||n(`Mod ${i} failed to call a function: Expected function name string, got ${typeof e}`);const r=u(e);return Array.isArray(t)||n(`Mod ${i} failed to call a function: Expected args array, got ${typeof t}`),r.original.apply(null!=s?s:globalThis,t)})),getOriginalHash:l("getOriginalHash",(e=>("string"==typeof e&&e||n(`Mod ${i} failed to get hash: Expected function name string, got ${typeof e}`),u(e).originalHash)))},p={name:e.name,fullName:e.fullName,version:e.version,repository:e.repository,allowReplace:r,api:c,loaded:!0,patching:new Map};return h.set(e.name,p),Object.freeze(c)}function g(){const e=[];for(const t of h.values())e.push({name:t.name,fullName:t.fullName,version:t.version,repository:t.repository});return e}let y;const _=void 0===window.bcModSdk?window.bcModSdk=function(){const e={version:t,apiVersion:1,registerMod:f,getModsInfo:g,getPatchingInfo:p,errorReporterHooks:Object.seal({apiEndpointEnter:null,hookEnter:null,hookChainExit:null})};return y=e,Object.freeze(e)}():(s(window.bcModSdk)||n("Failed to init Mod SDK: Name already in use"),1!==window.bcModSdk.apiVersion&&n(`Failed to init Mod SDK: Different version already loaded ('1.2.0' vs '${window.bcModSdk.version}')`),window.bcModSdk.version!==t&&alert(`Mod SDK warning: Loading different but compatible versions ('1.2.0' vs '${window.bcModSdk.version}')\nOne of mods you are using is using an old version of SDK. It will work for now but please inform author to update`),window.bcModSdk);Object.defineProperty(e,"__esModule",{value:!0}),e.default=_}()}(e);var t=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(e);const n=new class{constructor(){this.logsArray=[],this.maxLogSize=100}log(e,t,n){const i={message:t,level:e,version:"2.1.0",timestamp:(new Date).toISOString()};n("%cABCL:","font-weight: bold; color: #f6cbde;",i),this.logsArray.push(i),this.logsArray.length>this.maxLogSize&&this.logsArray.shift()}info(e){this.log("INFO",e,console.log)}debug(e){this.log("DEBUG",e,console.debug)}warn(e){this.log("WARN",e,console.warn)}error(e){this.log("ERROR",e,console.error)}getLogs(){return this.logsArray}};const i={ItemDefinitions:{BabyItems:["Bows Dress","Babydoll Dress","Puffy Dress","Shiny dress","Summmer flower dress","Adult Baby Harness","Tutu","Frilled Bikni","Padded Mittens","Paw Mittens","Short Smooth Leather Mittens","Changing Table","Crib","Fox Plush","Bunny Plush","Shark Plush","Little's Highchair"],Pants:["Long Leggings","Short Leggings","Business Trousers","Latex Pants","Long Latex Pants","Ripped Jeans","Jeans","Pajama"]},DiaperColors:{clean:"#8F8F8F",middlewet:"#ffe58b",maximumwet:"#ffd33e",middlemess:"#423019",maximummess:"#3C302C",selfwet:"#242103",selfmess:"#1f170d",indicatorAccident:"#1e47a6"},DiaperSizeScale:{none:0,small:300,regular:500,overnight:800,light_adult:900,moderate_adult:1500,heavy_adult:2500,specialized:3500},Diapers:{"Patterned Diaper":{color:[0],size:"overnight"},"Bulky Diaper":{color:[0,1],size:"light_adult"},"Bulky Chastity Diaper":{color:[1,0],size:"moderate_adult"},"Poofy Diaper":{color:[1,0],size:"light_adult"},"Poofy Chastity Diaper 1":{color:[1,0],size:"heavy_adult"},"Poofy Chastity Diaper":{color:[1,0],size:"moderate_adult"},"Plastic Covered Diaper":{color:[0],size:"light_adult"},"Satin Covered Diaper":{color:[0],size:"light_adult"},Diaper:{size:"regular"},"Diaper Harness":{size:"none"},"Untrainers Diaper":{size:"overnight",gradients:[1],indicator:[6]},"Cutest Diaper":{size:"light_adult",gradients:[4],indicator:[5]}}},s={Tickle:{wetting:.05,messing:.01},TickleItem:{wetting:.08,messing:.01},Spank:{wetting:.12,messing:.15},ShockItem:{wetting:.15,messing:.2},Kick:{wetting:.05,messing:.05},Rub:{wetting:.01},SpankItem:{wetting:.15,messing:.2},Slap:{wetting:.03,messing:.04},Grope:{wetting:.06,messing:.05}},r="2.1.0",a="ABCL",o="ABCL",l="Normal",c="Deny",u="Ask",d="Allow",p={Disabled:0,Slow:.5,Normal:1,Fast:1.5,Faster:2,Fastest:3};var h;!function(e){e[e.Anyone=0]="Anyone",e[e.ItemPermission=1]="ItemPermission",e[e.Friends=2]="Friends",e[e.Lovers=3]="Lovers",e[e.Owner=5]="Owner",e[e.Self=6]="Self"}(h||(h={}));var m="object"==typeof global&&global&&global.Object===Object&&global,f="object"==typeof self&&self&&self.Object===Object&&self,g=m||f||Function("return this")(),y=g.Symbol,_=Object.prototype,b=_.hasOwnProperty,v=_.toString,A=y?y.toStringTag:void 0;var C=Object.prototype.toString;var P="[object Null]",S="[object Undefined]",w=y?y.toStringTag:void 0;function M(e){return null==e?void 0===e?S:P:w&&w in Object(e)?function(e){var t=b.call(e,A),n=e[A];try{e[A]=void 0;var i=!0}catch(e){}var s=v.call(e);return i&&(t?e[A]=n:delete e[A]),s}(e):function(e){return C.call(e)}(e)}function B(e){return null!=e&&"object"==typeof e}var L="[object Symbol]";var D=Array.isArray,N=/\s/;var k=/^\s+/;function I(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&N.test(e.charAt(t)););return t}(e)+1).replace(k,""):e}function x(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var F=NaN,T=/^[-+]0x[0-9a-f]+$/i,O=/^0b[01]+$/i,z=/^0o[0-7]+$/i,$=parseInt;function G(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||B(e)&&M(e)==L}(e))return F;if(x(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=x(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=I(e);var n=O.test(e);return n||z.test(e)?$(e.slice(2),n?2:8):T.test(e)?F:+e}function R(e){return e}var V="[object AsyncFunction]",j="[object Function]",H="[object GeneratorFunction]",W="[object Proxy]";function U(e){if(!x(e))return!1;var t=M(e);return t==j||t==H||t==V||t==W}var Y,q=g["__core-js_shared__"],X=(Y=/[^.]+$/.exec(q&&q.keys&&q.keys.IE_PROTO||""))?"Symbol(src)_1."+Y:"";var K=Function.prototype.toString;var Z=/^\[object .+?Constructor\]$/,J=Function.prototype,Q=Object.prototype,ee=J.toString,te=Q.hasOwnProperty,ne=RegExp("^"+ee.call(te).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ie(e){return!(!x(e)||(t=e,X&&X in t))&&(U(e)?ne:Z).test(function(e){if(null!=e){try{return K.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}function se(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return ie(n)?n:void 0}var re=Object.create,ae=function(){function e(){}return function(t){if(!x(t))return{};if(re)return re(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();var oe=Date.now;var le,ce,ue,de=function(){try{var e=se(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),pe=de?function(e,t){return de(e,"toString",{configurable:!0,enumerable:!1,value:(n=t,function(){return n}),writable:!0});var n}:R,he=(le=pe,ce=0,ue=0,function(){var e=oe(),t=16-(e-ue);if(ue=e,t>0){if(++ce>=800)return arguments[0]}else ce=0;return le.apply(void 0,arguments)}),me=9007199254740991,fe=/^(?:0|[1-9]\d*)$/;function ge(e,t){var n=typeof e;return!!(t=null==t?me:t)&&("number"==n||"symbol"!=n&&fe.test(e))&&e>-1&&e%1==0&&e<t}function ye(e,t,n){"__proto__"==t&&de?de(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function _e(e,t){return e===t||e!=e&&t!=t}var be=Object.prototype.hasOwnProperty;function ve(e,t,n){var i=e[t];be.call(e,t)&&_e(i,n)&&(void 0!==n||t in e)||ye(e,t,n)}var Ae=Math.max;function Ce(e,t){return he(function(e,t,n){return t=Ae(void 0===t?e.length-1:t,0),function(){for(var i=arguments,s=-1,r=Ae(i.length-t,0),a=Array(r);++s<r;)a[s]=i[t+s];s=-1;for(var o=Array(t+1);++s<t;)o[s]=i[s];return o[t]=n(a),function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}(e,this,o)}}(e,t,R),e+"")}var Pe=9007199254740991;function Se(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Pe}function we(e){return null!=e&&Se(e.length)&&!U(e)}var Me=Object.prototype;function Be(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Me)}function Le(e){return B(e)&&"[object Arguments]"==M(e)}var De=Object.prototype,Ne=De.hasOwnProperty,ke=De.propertyIsEnumerable,Ie=Le(function(){return arguments}())?Le:function(e){return B(e)&&Ne.call(e,"callee")&&!ke.call(e,"callee")},Ee=Ie;var xe="object"==typeof exports&&exports&&!exports.nodeType&&exports,Fe=xe&&"object"==typeof module&&module&&!module.nodeType&&module,Te=Fe&&Fe.exports===xe?g.Buffer:void 0,Oe=(Te?Te.isBuffer:void 0)||function(){return!1},ze={};ze["[object Float32Array]"]=ze["[object Float64Array]"]=ze["[object Int8Array]"]=ze["[object Int16Array]"]=ze["[object Int32Array]"]=ze["[object Uint8Array]"]=ze["[object Uint8ClampedArray]"]=ze["[object Uint16Array]"]=ze["[object Uint32Array]"]=!0,ze["[object Arguments]"]=ze["[object Array]"]=ze["[object ArrayBuffer]"]=ze["[object Boolean]"]=ze["[object DataView]"]=ze["[object Date]"]=ze["[object Error]"]=ze["[object Function]"]=ze["[object Map]"]=ze["[object Number]"]=ze["[object Object]"]=ze["[object RegExp]"]=ze["[object Set]"]=ze["[object String]"]=ze["[object WeakMap]"]=!1;var $e="object"==typeof exports&&exports&&!exports.nodeType&&exports,Ge=$e&&"object"==typeof module&&module&&!module.nodeType&&module,Re=Ge&&Ge.exports===$e&&m.process,Ve=function(){try{var e=Ge&&Ge.require&&Ge.require("util").types;return e||Re&&Re.binding&&Re.binding("util")}catch(e){}}(),je=Ve&&Ve.isTypedArray,He=je?function(e){return function(t){return e(t)}}(je):function(e){return B(e)&&Se(e.length)&&!!ze[M(e)]},We=Object.prototype.hasOwnProperty;function Ue(e,t){var n=D(e),i=!n&&Ee(e),s=!n&&!i&&Oe(e),r=!n&&!i&&!s&&He(e),a=n||i||s||r,o=a?function(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}(e.length,String):[],l=o.length;for(var c in e)!t&&!We.call(e,c)||a&&("length"==c||s&&("offset"==c||"parent"==c)||r&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||ge(c,l))||o.push(c);return o}var Ye=Object.prototype.hasOwnProperty;function qe(e){if(!x(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=Be(e),n=[];for(var i in e)("constructor"!=i||!t&&Ye.call(e,i))&&n.push(i);return n}function Xe(e){return we(e)?Ue(e,!0):qe(e)}var Ke=se(Object,"create");var Ze=Object.prototype.hasOwnProperty;var Je=Object.prototype.hasOwnProperty;function Qe(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function et(e,t){for(var n=e.length;n--;)if(_e(e[n][0],t))return n;return-1}Qe.prototype.clear=function(){this.__data__=Ke?Ke(null):{},this.size=0},Qe.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Qe.prototype.get=function(e){var t=this.__data__;if(Ke){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return Ze.call(t,e)?t[e]:void 0},Qe.prototype.has=function(e){var t=this.__data__;return Ke?void 0!==t[e]:Je.call(t,e)},Qe.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Ke&&void 0===t?"__lodash_hash_undefined__":t,this};var tt=Array.prototype.splice;function nt(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}nt.prototype.clear=function(){this.__data__=[],this.size=0},nt.prototype.delete=function(e){var t=this.__data__,n=et(t,e);return!(n<0)&&(n==t.length-1?t.pop():tt.call(t,n,1),--this.size,!0)},nt.prototype.get=function(e){var t=this.__data__,n=et(t,e);return n<0?void 0:t[n][1]},nt.prototype.has=function(e){return et(this.__data__,e)>-1},nt.prototype.set=function(e,t){var n=this.__data__,i=et(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this};var it=se(g,"Map");function st(e,t){var n,i,s=e.__data__;return("string"==(i=typeof(n=t))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?s["string"==typeof t?"string":"hash"]:s.map}function rt(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}rt.prototype.clear=function(){this.size=0,this.__data__={hash:new Qe,map:new(it||nt),string:new Qe}},rt.prototype.delete=function(e){var t=st(this,e).delete(e);return this.size-=t?1:0,t},rt.prototype.get=function(e){return st(this,e).get(e)},rt.prototype.has=function(e){return st(this,e).has(e)},rt.prototype.set=function(e,t){var n=st(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this};var at=function(e,t){return function(n){return e(t(n))}}(Object.getPrototypeOf,Object),ot="[object Object]",lt=Function.prototype,ct=Object.prototype,ut=lt.toString,dt=ct.hasOwnProperty,pt=ut.call(Object);function ht(e){var t=this.__data__=new nt(e);this.size=t.size}ht.prototype.clear=function(){this.__data__=new nt,this.size=0},ht.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},ht.prototype.get=function(e){return this.__data__.get(e)},ht.prototype.has=function(e){return this.__data__.has(e)},ht.prototype.set=function(e,t){var n=this.__data__;if(n instanceof nt){var i=n.__data__;if(!it||i.length<199)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new rt(i)}return n.set(e,t),this.size=n.size,this};var mt="object"==typeof exports&&exports&&!exports.nodeType&&exports,ft=mt&&"object"==typeof module&&module&&!module.nodeType&&module,gt=ft&&ft.exports===mt?g.Buffer:void 0,yt=gt?gt.allocUnsafe:void 0;var _t=g.Uint8Array;function bt(e,t){var n,i,s=t?(n=e.buffer,i=new n.constructor(n.byteLength),new _t(i).set(new _t(n)),i):e.buffer;return new e.constructor(s,e.byteOffset,e.length)}var vt,At=function(e,t,n){for(var i=-1,s=Object(e),r=n(e),a=r.length;a--;){var o=r[vt?a:++i];if(!1===t(s[o],o,s))break}return e},Ct=function(){return g.Date.now()},Pt=Math.max,St=Math.min;function wt(e,t,n){(void 0!==n&&!_e(e[t],n)||void 0===n&&!(t in e))&&ye(e,t,n)}function Mt(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function Bt(e){return function(e,t,n,i){var s=!n;n||(n={});for(var r=-1,a=t.length;++r<a;){var o=t[r],l=i?i(n[o],e[o],o,n,e):void 0;void 0===l&&(l=e[o]),s?ye(n,o,l):ve(n,o,l)}return n}(e,Xe(e))}function Lt(e,t,n,i,s,r,a){var o=Mt(e,n),l=Mt(t,n),c=a.get(l);if(c)wt(e,n,c);else{var u,d=r?r(o,l,n+"",e,t,a):void 0,p=void 0===d;if(p){var h=D(l),m=!h&&Oe(l),f=!h&&!m&&He(l);d=l,h||m||f?D(o)?d=o:B(u=o)&&we(u)?d=function(e,t){var n=-1,i=e.length;for(t||(t=Array(i));++n<i;)t[n]=e[n];return t}(o):m?(p=!1,d=function(e,t){if(t)return e.slice();var n=e.length,i=yt?yt(n):new e.constructor(n);return e.copy(i),i}(l,!0)):f?(p=!1,d=bt(l,!0)):d=[]:function(e){if(!B(e)||M(e)!=ot)return!1;var t=at(e);if(null===t)return!0;var n=dt.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&ut.call(n)==pt}(l)||Ee(l)?(d=o,Ee(o)?d=Bt(o):x(o)&&!U(o)||(d=function(e){return"function"!=typeof e.constructor||Be(e)?{}:ae(at(e))}(l))):p=!1}p&&(a.set(l,d),s(d,l,i,r,a),a.delete(l)),wt(e,n,d)}}function Dt(e,t,n,i,s){e!==t&&At(t,(function(r,a){if(s||(s=new ht),x(r))Lt(e,t,a,n,Dt,i,s);else{var o=i?i(Mt(e,a),r,a+"",e,t,s):void 0;void 0===o&&(o=r),wt(e,a,o)}}),Xe)}var Nt,kt=(Nt=function(e,t,n){Dt(e,t,n)},Ce((function(e,t){var n=-1,i=t.length,s=i>1?t[i-1]:void 0,r=i>2?t[2]:void 0;for(s=Nt.length>3&&"function"==typeof s?(i--,s):void 0,r&&function(e,t,n){if(!x(n))return!1;var i=typeof t;return!!("number"==i?we(n)&&ge(t,n.length):"string"==i&&t in n)&&_e(n[t],e)}(t[0],t[1],r)&&(s=i<3?void 0:s,i=1),e=Object(e);++n<i;){var a=t[n];a&&Nt(e,a,n,s)}return e})));const It={PeeMetabolism:l,PoopMetabolism:l,OpenRemoteSettings:!1,LockedOutOfSettings:!1,DisableWettingLeaks:!1,DisableSoilingLeaks:!0,OnDiaperChange:u,VisibleMessages:{changeDiaper:!0,checkDiaper:!0,lickPuddle:!0,wetDiaper:!0,wetClothing:!0,soilDiaper:!0,soilClothing:!0,usePotty:!0,useToilet:!0,wipePuddle:!0,statusMessages:!1,playerActivity:!0},StatusMessages:{Bladder:!0,Bowel:!0,Soiliness:!0,Wetness:!0,MentalRegression:!0,Incontinence:!0,PuddleSize:!0},DisableClothingStains:!1,DisableDiaperStains:!1,AccidentsByActivities:!0},Et={PuddleSize:{value:0},Bladder:{value:0,size:300},Bowel:{value:0,size:200},Soiliness:{value:0},Wetness:{value:0},WaterIntake:{value:15},FoodIntake:{value:200/60},Incontinence:{value:0},MentalRegression:{value:0}},xt={Settings:It,Stats:Et},Ft=function(e,t,n){var i,s,r,a,o,l,c=0,u=!1,d=!1,p=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function h(t){var n=i,r=s;return i=s=void 0,c=t,a=e.apply(r,n)}function m(e){var n=e-l;return void 0===l||n>=t||n<0||d&&e-c>=r}function f(){var e=Ct();if(m(e))return g(e);o=setTimeout(f,function(e){var n=t-(e-l);return d?St(n,r-(e-c)):n}(e))}function g(e){return o=void 0,p&&i?h(e):(i=s=void 0,a)}function y(){var e=Ct(),n=m(e);if(i=arguments,s=this,l=e,n){if(void 0===o)return function(e){return c=e,o=setTimeout(f,t),u?h(e):a}(l);if(d)return clearTimeout(o),o=setTimeout(f,t),h(l)}return void 0===o&&(o=setTimeout(f,t)),a}return t=G(t)||0,x(n)&&(u=!!n.leading,r=(d="maxWait"in n)?Pt(G(n.maxWait)||0,t):r,p="trailing"in n?!!n.trailing:p),y.cancel=function(){void 0!==o&&clearTimeout(o),c=0,i=l=s=o=void 0},y.flush=function(){return void 0===o?a:g(Ct())},y}((()=>{const e=LZString.compressToBase64(JSON.stringify(Player.ABCL));Player.ExtensionSettings.ABCL=e,ServerPlayerExtensionSettingsSync("ABCL"),_i()}),1e3),Tt=t.registerMod({name:a,fullName:a,version:r,repository:"https://github.com/zoe-64/ABCL"});var Ot;!function(e){e[e.OBSERVE=0]="OBSERVE",e[e.ADD_BEHAVIOR=1]="ADD_BEHAVIOR",e[e.MODIFY_BEHAVIOR=5]="MODIFY_BEHAVIOR",e[e.OVERRIDE_BEHAVIOR=10]="OVERRIDE_BEHAVIOR",e[e.TOP=100]="TOP"}(Ot||(Ot={}));const zt=(e,t=[],n,i=!0)=>{if(!ServerPlayerIsInChatRoom())return;const s=document.createElement("div");s.innerHTML=(i?"(local) ":"")+e.split("\n").map((e=>e.trim())).join("<br/>"),s.classList.add("ABCLLocalMessage","ChatMessage",...t),n&&(s.style.cssText=n),document.querySelector("#TextAreaChatLog")?.appendChild(s),ElementScrollToEnd("TextAreaChatLog")};const $t=async(e,t={})=>new Promise(((n,i)=>{const s=document.querySelector(e);if(s)return void n(s);const r=new MutationObserver((()=>{const i=document.querySelector(e);i&&(!t.childCheck||i.childElementCount>0)&&(r.disconnect(),clearTimeout(a),n(i))}));r.observe(document.body,{childList:!0,subtree:!0});const a=setTimeout((()=>{r.disconnect(),console.warn(`Element with selector "${e}" not found within timeout`)}),t.timeout||1e4)})),Gt=e=>`${e=e||"ABCL"}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;class Rt{constructor(e){this.lastCallTime=0,this.allowedCallInterval=e}check(){return Date.now()-this.lastCallTime>this.allowedCallInterval&&(this.lastCallTime=Date.now(),!0)}reset(){this.lastCallTime=0}isReady(){return Date.now()-this.lastCallTime>this.allowedCallInterval}}const Vt=e=>"Default"!==e&&"string"==typeof e,jt=(e,t)=>("string"==typeof e&&"Default"!==e&&n.warn(`Unknown color: ${e}`),e&&"Default"!==e?Array.isArray(e)?e.map((e=>"Default"===e?"#FFFFFF":e)):[e]:[...t.DefaultColor.map((e=>"Default"===e?"#FFFFFF":e))]),Ht=(e,t)=>{const n=e.querySelector(t);if(n)return n;throw new Error(`Element with selector "${t}" not found`)},Wt={state:0,memberNumber:0,setState:e=>{Wt.state=e(Wt.state)},setMemberNumber:e=>{Wt.memberNumber=e},update:()=>{Wt.setState((e=>e+1))}};class Ut{constructor(e,t=!1){this.newX=0,this.newY=0,this.oldX=0,this.oldY=0,this.isDragging=!1,this.isResizing=!1,this.resizeDirection=null,this.edgeThreshold=10,this.resizable=!0,this.element=e,this.resizable=t,this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseEnter=this.onMouseEnter.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this),this.onMouseMoveForCursor=this.onMouseMoveForCursor.bind(this),this.element.addEventListener("mousedown",this.onMouseDown),this.element.addEventListener("mousemove",this.onMouseMoveForCursor),this.element.style.position="fixed",this.resizable&&(this.element.style.resize="none",this.element.addEventListener("mouseenter",this.onMouseEnter),this.element.addEventListener("mouseleave",this.onMouseLeave))}onMouseEnter(e){this.element.addEventListener("mousemove",this.onMouseMoveForCursor)}onMouseLeave(e){this.element.removeEventListener("mousemove",this.onMouseMoveForCursor),this.element.style.cursor="default"}onMouseMoveForCursor(e){const{offsetX:t,offsetY:n}=e,{offsetWidth:i,offsetHeight:s}=this.element;this.resizable&&(t<this.edgeThreshold||t>i-this.edgeThreshold?this.element.style.cursor="ew-resize":n<this.edgeThreshold||n>s-this.edgeThreshold?this.element.style.cursor="ns-resize":this.element.style.cursor="default")}onMouseDown(e){const{offsetX:t,offsetY:n}=e,{offsetWidth:i,offsetHeight:s}=this.element;this.resizable?t<this.edgeThreshold?(this.isResizing=!0,this.resizeDirection="left"):t>i-this.edgeThreshold?(this.isResizing=!0,this.resizeDirection="right"):n<this.edgeThreshold?(this.isResizing=!0,this.resizeDirection="top"):n>s-this.edgeThreshold?(this.isResizing=!0,this.resizeDirection="bottom"):this.isDragging=!0:this.isDragging=!0,(this.isDragging||this.isResizing)&&(e.preventDefault(),this.oldX=e.clientX,this.oldY=e.clientY,document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp))}onMouseMove(e){if(this.isDragging)this.newX=this.oldX-e.clientX,this.newY=this.oldY-e.clientY,this.oldX=e.clientX,this.oldY=e.clientY,this.element.style.top=this.element.offsetTop-this.newY+"px",this.element.style.left=this.element.offsetLeft-this.newX+"px";else if(this.isResizing){const t=e.clientX-this.oldX,n=e.clientY-this.oldY,i=getComputedStyle(this.element),s=parseInt(i.left,10),r=parseInt(i.top,10),a=parseInt(i.width,10),o=parseInt(i.height,10);switch(this.resizeDirection){case"left":this.element.style.width=a-t+"px",this.element.style.left=`${s+t/2}px`;break;case"right":this.element.style.width=`${a+t}px`,this.element.style.left=`${s+t/2}px`;break;case"top":this.element.style.height=o-n+"px",this.element.style.top=`${r+n/2}px`;break;case"bottom":this.element.style.height=`${o+n}px`,this.element.style.top=`${r+n/2}px`}this.oldX=e.clientX,this.oldY=e.clientY}}onMouseUp(e){e.preventDefault(),this.isDragging=!1,this.isResizing=!1,this.resizeDirection=null,document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp)}}class Yt{constructor(e,t,n,i=-1){this.prompt=document.createElement("div"),new Ut(this.prompt),this.id=Gt(),this.message=e,this.onAccept=t,this.onDeny=n,this.show(),-1!==i&&setTimeout((()=>{this.prompt.remove()}),i)}show(){this.prompt.classList.add("ABCLPrompt"),this.prompt.id=this.id,this.prompt.innerHTML=`<p>${this.message}</p><button class="ABCLPromptNo ABCLButton">Deny</button><button class="ABCLPromptYes ABCLButton">Accept</button>`,qt.appendChild(this.prompt),this.prompt.querySelector(`#${this.id} .ABCLPromptYes`)?.addEventListener("click",(()=>{this.onAccept(),this.prompt.remove()})),this.prompt.querySelector(`#${this.id} .ABCLPromptNo`)?.addEventListener("click",(()=>{this.onDeny(),this.prompt.remove()}))}}const qt=document.createElement("div");qt.id="ABCLOverlay";let Xt=[];const Kt=()=>{if("loading"===document.readyState)return;const e=Array.from(qt.querySelectorAll("*")).filter((e=>"true"!==e.getAttribute("indexed")&&(e=>{if(!e||!e.isConnected)return!1;if(null===e.offsetParent)return!1;const t=getComputedStyle(e);if("hidden"===t.visibility||"0"===t.opacity||e.classList.contains("no-resize"))return!1;let n=e.parentElement;for(;n&&n!==document.body;){const e=getComputedStyle(n);if("none"===e.display||"hidden"===e.visibility||n.classList.contains("no-resize"))return!1;n=n.parentElement}return!0})(e))),t=qt.getBoundingClientRect();Xt.push(...e.map((e=>{const n=e.getBoundingClientRect(),i=e.id||Gt();return e.id=i,e.setAttribute("indexed","true"),{id:i,y:n.top-t.top,x:n.left-t.left,width:n.width,height:n.height,fontSize:parseInt(getComputedStyle(e).fontSize,10)}}))),Xt.forEach((e=>{ElementPositionFix(e.id,e.fontSize,e.x,e.y,e.width,e.height)}))};window.addEventListener("resize",Kt),qt.classList.add("ABCLOverlay");const Zt=e=>{if(!e)return;if("object"==typeof e)return e;return ChatRoomCharacter.filter((t=>{const n=t.Name.toLowerCase(),i=t.Nickname?.toLowerCase(),s=`${e}`.toLowerCase();return t.MemberNumber==e||n===s||i===s||n.startsWith(s)||i?.startsWith(s)}))[0]},Jt=e=>{const t=e.join(" "),n=Zt(t);if(n)return n},Qt=(e,t,n=Player.ABCL.Version)=>Boolean(e?.ABCL&&(!t||e.ABCL.Version===n));function en(e){if(!e)return"Unknown";const t=Zt(e);return t?t.Nickname?t.Nickname:t.Name:"Unknown"}function tn(e,t=null,n=""){let i=e,s="He/Him"===CharacterPronounDescription(Player),r=s?"His":"Her",a=s?"Him":"Her",o=s?"He":"She",l="He/Him"===(t?CharacterPronounDescription(t):"They/Them"),c=t?.IsPlayer()?l?"himself":"herself":t?CharacterNickname(t):n,u=l?"His":"Her",d=t==Player?l?"Himself":"Herself":l?"Him":"Her",p=l?"He":"She";return i.replaceAll("%NAME%",CharacterNickname(Player)).replaceAll("%POSSESSIVE%",r.toLocaleLowerCase()).replaceAll("%PRONOUN%",o.toLocaleLowerCase()).replaceAll("%INTENSIVE%",a.toLocaleLowerCase()).replaceAll("%CAP_POSSESSIVE%",r).replaceAll("%CAP_PRONOUN%",o).replaceAll("%CAP_INTENSIVE%",a).replaceAll("%OPP_NAME%",c).replaceAll("%OPP_PRONOUN%",p.toLocaleLowerCase()).replaceAll("%OPP_POSSESSIVE%",u.toLocaleLowerCase()).replaceAll("%OPP_INTENSIVE%",d.toLocaleLowerCase()).replaceAll("%CAP_OPP_PRONOUN%",p).replaceAll("%CAP_OPP_POSSESSIVE%",u).replaceAll("%CAP_OPP_INTENSIVE%",d)}const nn=(e,t,n=!1)=>{if(0===t)return;if(n&&(t*=100),t=Number(t.toPrecision(2)),void 0===Player.ABCL.Settings.StatusMessages[e])return;if(!Player.ABCL.Settings.StatusMessages[e])return;const i=Player.ABCL.Settings.StatusMessages[e],s=`[${t>0?"+":"-"}${Math.abs(t)}${n?"%":""} ${{Bladder:"PEE",Bowel:"POO",Incontinence:"INCON",MentalRegression:"REG",Soiliness:"MESS",Wetness:"WET",PuddleSize:"PUDL"}[e]}]`;i?zt(s,["ChatMessageAction","ChatMessageNonDialogue"],"--label-color:#ff4949"):yi("onABCLMessage",{message:`${en(Player.MemberNumber)}: ${s}`,local:i})};function sn(e,t=null,n,i){let s=tn(e,t);if(!n)return void ServerSend("ChatRoomChat",{Content:"Beep",Type:"Action",Dictionary:[{Tag:"Beep",Text:"msg"},{Tag:"发送私聊",Text:"msg"},{Tag:"Biep",Text:"msg"},{Tag:"Sonner",Text:"msg"},{Tag:"msg",Text:s}]});const r=!Player.ABCL.Settings.VisibleMessages[n];zt(s,["ChatMessageAction","ChatMessageNonDialogue"],"--label-color:#ff4949",r),r?i&&i.MemberNumber!==Player.MemberNumber&&yi("onABCLMessage",{message:s,local:r},i.MemberNumber):yi("onABCLMessage",{message:s,local:r})}const rn=()=>{CharacterRefresh(Player,!0),ChatRoomCharacterUpdate(Player)},an=new Rt(72e5),on=new Rt(72e5),ln=new Rt(3e5),cn={onAccident:()=>{cn.stats.MentalRegression+=Ln()??0},update:()=>{an.allowedCallInterval=12e4/Math.max(.1,p[Player.ABCL.Settings.PoopMetabolism]),on.allowedCallInterval=12e4/Math.max(.1,p[Player.ABCL.Settings.PeeMetabolism]),ln.check()&&(cn.stats.MentalRegression+=Mn()??0),on.check()&&(cn.stats.BladderValue+=cn.stats.WaterIntake*p[Player.ABCL.Settings.PeeMetabolism],"Disabled"!==Player.ABCL.Settings.PeeMetabolism&&cn.attemptWetting()),an.check()&&(cn.stats.BowelValue+=cn.stats.FoodIntake*p[Player.ABCL.Settings.PoopMetabolism],"Disabled"!==Player.ABCL.Settings.PoopMetabolism&&cn.attemptSoiling()),un.save()},wetClothing:()=>{if(zt("You've had a wet accident in your clothes!"),cn.stats.PuddleSize+=cn.stats.BladderValue,cn.stats.BladderValue=0,fn()?sn("%NAME%'s diaper leaks and wet %POSSESSIVE% clothes causing a puddle to form.",void 0,"wetClothing"):sn("%NAME%'s wets %POSSESSIVE% clothes and leaks onto the floor.",void 0,"wetClothing"),_i(),Player.ABCL.Settings.DisableClothingStains)return;const e="#96936C",t=InventoryGet(Player,"Panties");if(t&&!mn(t)){const n=jt(t.Color||t.Asset.DefaultColor,t.Asset);for(let t=0;t<n.length;t++)Vt(n[t])&&(n[t]=gn(n[t],e,.3));t.Color=n}for(const t of Player.Appearance)if(i.ItemDefinitions.Pants.some((e=>e===t.Asset.Description))){const n=jt(t.Color||t.Asset.DefaultColor,t.Asset);for(let t=0;t<n.length;t++)Vt(n[t])&&(n[t]=gn(n[t],e,.3));t.Color=n}rn()},soilClothing:()=>{if(cn.stats.BowelValue=0,fn()?sn("%NAME%'s diaper leaks and soils %POSSESSIVE% clothes.",void 0,"soilClothing"):sn("%NAME% soils %POSSESSIVE% clothes.",void 0,"soilClothing"),_i(),Player.ABCL.Settings.DisableClothingStains)return;const e="#261a16",t=InventoryGet(Player,"Panties");if(t&&!mn(t)){const n=jt(t.Color||t.Asset.DefaultColor,t.Asset);for(let t=0;t<n.length;t++)Vt(n[t])&&(n[t]=gn(n[t],e,.3));t.Color=n}for(const t of Player.Appearance)if(i.ItemDefinitions.Pants.some((e=>e===t.Asset.Description))){const n=jt(t.Color||t.Asset.DefaultColor,t.Asset);for(let t=0;t<n.length;t++)Vt(n[t])&&(n[t]=gn(n[t],e,.3));t.Color=n}rn()},wetDiaper:()=>{const e=An(),t=Math.min(cn.stats.BladderValue,Math.max(0,e-cn.stats.WetnessValue));sn("%NAME% wets %POSSESSIVE% diaper.",void 0,"wetDiaper"),cn.stats.BladderValue-=t,cn.stats.WetnessValue+=t,cn.stats.WetnessValue>=e&&cn.wetClothing()},soilDiaper:()=>{const e=An(),t=Math.min(cn.stats.BowelValue,Math.max(0,e-cn.stats.SoilinessValue));sn("%NAME% soils %POSSESSIVE% diaper.",void 0,"soilDiaper"),cn.stats.BowelValue-=t,cn.stats.SoilinessValue+=t,cn.stats.SoilinessValue>=e&&cn.soilClothing()},attemptWetting:()=>{const e=Pn(cn.stats.Incontinence),t=Sn(cn.stats.Incontinence,cn.stats.BladderFullness);(Math.random()<t||cn.stats.BladderFullness>e)&&dn.check()&&MiniGameStart("WetMinigame",30*t,"noOp")},attemptSoiling:()=>{const e=Pn(cn.stats.Incontinence),t=Sn(cn.stats.Incontinence,cn.stats.BowelFullness);(Math.random()<t||cn.stats.BowelFullness>e)&&dn.check()&&MiniGameStart("MessMinigame",30*t,"noOp")},wet:(e=!1)=>{const t=.3*cn.stats.Incontinence,n=cn.stats.BladderFullness<.3-t,i=!n,s=cn.stats.BladderFullness>.6-t;n&&e?zt("You try to pee, but it doesn't seem to be working."):(i&&(fn()?cn.wetDiaper():cn.wetClothing()),s&&e?cn.stats.Incontinence-=Bn(cn.stats.Incontinence):cn.stats.Incontinence+=Bn(cn.stats.Incontinence))},soil:(e=!1)=>{const t=.3*cn.stats.Incontinence,n=cn.stats.BowelFullness<.3-t,i=!n,s=cn.stats.BowelFullness>.6-t;n&&e?zt("You try to let go, but nothing seems to happen."):(i&&(fn()?cn.soilDiaper():cn.soilClothing()),s&&e?cn.stats.Incontinence-=.01:cn.stats.Incontinence+=.02)},stats:{set PuddleSize(e){e<0&&(e=0),e>250&&(e=250);const t=e-Player.ABCL.Stats.PuddleSize.value;nn("PuddleSize",t),Player.ABCL.Stats.PuddleSize.value=e},get PuddleSize(){return Player.ABCL.Stats.PuddleSize.value},set MentalRegression(e){e<0&&(e=0),e>1&&(e=1);const t=e-Player.ABCL.Stats.MentalRegression.value;nn("MentalRegression",t,!0),Player.ABCL.Stats.MentalRegression.value=e,Wt.update()},get MentalRegression(){return Player.ABCL.Stats.MentalRegression.value},set Incontinence(e){e<0&&(e=0),e>1&&(e=1);const t=e-Player.ABCL.Stats.Incontinence.value;nn("Incontinence",t,!0),Player.ABCL.Stats.Incontinence.value=e,Wt.update()},get Incontinence(){return Player.ABCL.Stats.Incontinence.value},set WaterIntake(e){e<0&&(e=0),Player.ABCL.Stats.WaterIntake.value=e},get WaterIntake(){return Player.ABCL.Stats.WaterIntake.value},set FoodIntake(e){e<0&&(e=0),Player.ABCL.Stats.FoodIntake.value=e},get FoodIntake(){return Player.ABCL.Stats.FoodIntake.value},set BladderValue(e){e<0&&(e=0);const t=e/this.BladderSize-this.BladderFullness;nn("Bladder",t,!0),Player.ABCL.Stats.Bladder.value=e,Wt.update()},get BladderValue(){return Player.ABCL.Stats.Bladder.value},set BladderSize(e){e<0&&(e=0),Player.ABCL.Stats.Bladder.size=e,Wt.update()},get BladderSize(){return Player.ABCL.Stats.Bladder.size},set WetnessValue(e){e<0&&(e=0);const t=e/An()-this.WetnessPercentage;nn("Wetness",t,!0),Player.ABCL.Stats.Wetness.value=e,vn(),Wt.update()},get WetnessValue(){return Player.ABCL.Stats.Wetness.value},set BladderFullness(e){e<0&&(e=0),this.BladderValue=e*this.BladderSize,Wt.update()},get BladderFullness(){return this.BladderValue/this.BladderSize},set BowelValue(e){e<0&&(e=0);const t=e/this.BowelSize-this.BowelFullness;nn("Bowel",t,!0),Player.ABCL.Stats.Bowel.value=e,Wt.update()},get BowelValue(){return Player.ABCL.Stats.Bowel.value},set BowelSize(e){e<0&&(e=0),Player.ABCL.Stats.Bowel.size=e,Wt.update()},get BowelSize(){return Player.ABCL.Stats.Bowel.size},set SoilinessValue(e){e<0&&(e=0);const t=e/An()-this.SoilinessPercentage;nn("Soiliness",t,!0),Player.ABCL.Stats.Soiliness.value=e,vn(),Wt.update()},get SoilinessValue(){return Player.ABCL.Stats.Soiliness.value},set BowelFullness(e){e<0&&(e=0),this.BowelValue=e*this.BowelSize,Wt.update()},get BowelFullness(){return this.BowelValue/this.BowelSize},get SoilinessPercentage(){return 0==An()?0:this.SoilinessValue/An()},set SoilinessPercentage(e){e<0&&(e=0),this.SoilinessValue=e*An()},get WetnessPercentage(){return 0==An()?0:this.WetnessValue/An()},set WetnessPercentage(e){e<0&&(e=0),this.WetnessValue=e*An()}}},un=new class{constructor(e){this.lastSaveTime=0,this.allowedSaveInterval=e}save(){Date.now()-this.lastSaveTime>this.allowedSaveInterval&&(Ft(),this.lastSaveTime=Date.now())}}(12e4),dn=new Rt(12e4);window.abclPlayer=cn;const pn=(e="any")=>{const t=An();return"pee"===e?cn.stats.PuddleSize>0:"poop"===e?cn.stats.SoilinessValue>=t:cn.stats.SoilinessValue>=t||cn.stats.WetnessValue>=t},hn=()=>{const e=An();return cn.stats.SoilinessValue+cn.stats.WetnessValue>=e/2},mn=e=>e.Asset.Description.toLowerCase().includes("diaper")&&e.Asset.Description in i.Diapers;function fn(e=Player){if(!e)return!1;const t=InventoryGet(e,"ItemPelvis"),n=InventoryGet(e,"Panties");return Boolean(t&&mn(t)||n&&mn(n))}function gn(e,t,n=.5){let i=DrawHexToRGB(e),s=DrawHexToRGB(t),r={r:Math.round(i.r*n+s.r*(1-n)),g:Math.round(i.g*n+s.g*(1-n)),b:Math.round(i.b*n+s.b*(1-n))};return DrawRGBToHex([r.r,r.g,r.b])}function yn(e,t,n,i){return e>.75?e>.9?t:gn(t,n,e-.75):gn(n,i,e)}const _n=(e=Player)=>{if(!fn())return!1;const t=InventoryGet(e,"ItemPelvis");return Boolean(t&&mn(t)&&(Player.MemberNumber===e.MemberNumber?t.Property?.LockedBy:!(t.Property?.LockMemberNumber===e.MemberNumber||"ExclusivePadlock"===t.Property?.LockedBy)))},bn=(e,t,n=Player)=>{if(Player.ABCL.Settings.DisableDiaperStains)return;const s=InventoryGet(n,e);if(s&&mn(s)){const e=s.Color&&"string"!=typeof s.Color?s.Color:s.Asset.DefaultColor,n=i.Diapers[s.Asset.Description],r=Math.min(cn.stats.SoilinessValue+cn.stats.WetnessValue/An(),1);if("indicator"in n)for(const t of n.indicator)e[t]=gn(i.DiaperColors.indicatorAccident,s.Asset.DefaultColor[t],r);if("gradients"in n)for(const i of n.gradients)s.Property?.Opacity&&"object"==typeof s.Property.Opacity&&(s.Property.Opacity[i]=r,e[i]=t);if("color"in n)for(const i of n.color)e[i]=t;console.log(e),s.Color=e}},vn=()=>{const e=cn.stats.SoilinessValue/An(),t=cn.stats.WetnessValue/An(),n=yn(e,i.DiaperColors.maximummess,i.DiaperColors.middlemess,i.DiaperColors.clean),s=yn(t,i.DiaperColors.maximumwet,i.DiaperColors.middlewet,i.DiaperColors.clean),r=Math.max(Math.min((e+(1-t))/2,2),0),a=gn(n,s,r);console.log(r,a),bn("ItemPelvis",a,Player),bn("Panties",a,Player),rn()};function An(e=Player){const t=InventoryGet(e,"ItemPelvis"),n=InventoryGet(e,"Panties");let i=50;return t&&mn(t)&&(i+=Cn(t)),n&&mn(n)&&(i+=Cn(n)),i}function Cn(e){return"Poofy Chastity Diaper"===e.Asset.Description&&1===e.Property?.TypeRecord?.typed?i.DiaperSizeScale.heavy_adult:i.DiaperSizeScale[i.Diapers[e.Asset.Description].size]}const Pn=e=>.9-.5*e;function Sn(e,t){const n=.6*Math.pow(e,2)+.8*Math.pow(t,3);return Math.min(Math.max(n,0),1)}const wn=()=>{const e=Player.Appearance.map((e=>e.Asset.Description)),t=i.ItemDefinitions.BabyItems.concat(["milk","pacifier","bib"]).filter((t=>e.some((e=>e.toLocaleLowerCase().includes(t)))));return Math.min(.25*t.length,1)},Mn=()=>{let e=-.5+wn();Player.Appearance.some((e=>i.ItemDefinitions.BabyItems.includes(e.Asset.Description)))&&(e+=1),hn()&&(e+=.25),pn()&&(e+=.5),e=Math.max(-1,Math.min(e,1));const t=cn.stats.MentalRegression;let n;if(e>0)n=1+Math.pow(15*t,2);else{if(!(e<0))return 0;n=1+Math.pow(15*(1-t),2)}return 5*e*.1/n},Bn=e=>{const t=[{increase:.01,start:0,end:.25},{increase:.005,start:.25,end:.5},{increase:.0025,start:.5,end:.75},{increase:.001,start:.75,end:1}];for(const{increase:n,start:i,end:s}of t)if(e>=i&&e<s)return n;return 0},Ln=()=>{const e=1+wn();return cn.stats.MentalRegression<.25||.25>cn.stats.MentalRegression&&cn.stats.MentalRegression<.5&&hn()?e/500:.5>cn.stats.MentalRegression&&cn.stats.MentalRegression<.75&&pn()?e/1e3:.75>cn.stats.MentalRegression&&cn.stats.MentalRegression<1&&pn()?e/1500:0},Dn=e=>{if(e.MemberNumber!==Player.MemberNumber)return yi("changeDiaper-pending",void 0,e.MemberNumber);Nn(e)},Nn=e=>{sn(tn(e.MemberNumber===Player.MemberNumber?"%NAME% changes %POSSESSIVE% diaper.":"%OPP_NAME% changes %NAME%'s diaper.",e),void 0,"changeDiaper",e),cn.stats.WetnessValue=0,cn.stats.SoilinessValue=0,vn()},kn={activity:{ID:"change-diaper",Name:"Change Diaper",Image:"https://zoe-64.github.io/ABCL/versions/beta/assets/activity/changeDiaper.svg",Target:["ItemPelvis"],OnClick:(e,t)=>Dn(e),Criteria:e=>fn(e)&&Qt(e)&&!Player.IsRestrained()&&!_n()},command:{Tag:"change-diaper",Action:(e,t,n)=>{const i=Jt(n)??Player;if(!kn.activity.Criteria(i))return zt("Is either not diapered or not an ABCL player or you are restrained or diaper is locked.");Dn(i)},Description:" [MemberNumber|Name|Nickname]: Changes someone's diaper."},listeners:{"changeDiaper-accepted":({Sender:e})=>zt(`${en(e)} accepted your change diaper request.`),"changeDiaper-rejected":({Sender:e})=>zt(`${en(e)} rejected your change diaper request.`),"changeDiaper-pending":({Sender:e})=>{switch(Player.ABCL.Settings.OnDiaperChange){case u:new Yt(`${en(e)} wants to change your diaper.`,(()=>{Nn(Zt(e)??Player),yi("changeDiaper-accepted",void 0,e)}),(()=>yi("changeDiaper-rejected",void 0,e)),1e4);break;case d:Nn(Zt(e)??Player),yi("changeDiaper-accepted",void 0,e);break;case c:yi("changeDiaper-rejected",void 0,e)}}}},In=e=>{const t=e.MemberNumber===Player.MemberNumber;if(Wt.setMemberNumber(e.MemberNumber),Ht(document.body,"#ABCLStatsPanel").classList.remove("ABCLHidden"),setTimeout((()=>{Kt()}),250),!(Math.random()<.75))return fn(e)?sn(tn(t?"%NAME% checks %POSSESSIVE% diaper.":"%NAME% checks %OPP_NAME%'s diaper.",e),void 0,"checkDiaper",e):sn(tn(t?"%NAME% checks %POSSESSIVE% clothes for any accidents.":"%NAME% checks %OPP_NAME%'s clothes for any accidents.",e),void 0,"checkDiaper",e)},En={activity:{ID:"check-diaper",Name:"Check Diaper",Image:"https://zoe-64.github.io/ABCL/versions/beta/assets/activity/diaperCheck.png",OnClick:(e,t)=>In(e),Target:["ItemPelvis"],Criteria:e=>Qt(e)&&!Player.IsRestrained()},command:{Tag:"check-diaper",Description:" [MemberNumber|Name|Nickname]: Checks someone's diaper.",Action:(e,t,n)=>{const i=Jt(n)??Player;if(!En.activity.Criteria(i))return zt("Is not an ABCL player or you are restrained.");In(i)}}},xn=e=>{sn(tn("%OPP_NAME% rubs %OPP_POSSESSIVE% diaper against %NAME%'s face.",e),void 0,"playerActivity",e),ActivityEffectFlat(e,Player,8,"ItemVulva",1),CharacterSetFacialExpression(Player,"Blush","Medium",5),CharacterSetFacialExpression(Player,"Eyebrows","Soft",10),CharacterSetFacialExpression(Player,"Eyes","Dizzy",10),cn.stats.MentalRegression+=.02},Fn={activity:{ID:"diaper-face-rub",Name:"Rub Diaper Against Face",Image:"https://zoe-64.github.io/ABCL/versions/beta/assets/activity/diaperFaceRub.png",Target:["ItemNose"],OnClick:(e,t)=>(e=>{if(e.MemberNumber!==Player.MemberNumber)return ActivityEffectFlat(Player,Player,12,"ItemVulva",1),yi("diaper-face-rub",void 0,e.MemberNumber);xn(e)})(e),Criteria:e=>fn(e)&&Qt(e)&&!Player.IsRestrained()&&e.MemberNumber!==Player.MemberNumber},listeners:{"diaper-face-rub":({Sender:e})=>xn(Zt(e)??Player)}},Tn=e=>{sn(tn("%OPP_NAME% sits with her diapered butt on %NAME%'s face.",e),void 0,"playerActivity",e),cn.stats.MentalRegression+=.03,ActivityEffectFlat(Player,Player,8,"ItemNose",1),CharacterSetFacialExpression(Player,"Blush","ShortBreath",30),CharacterSetFacialExpression(Player,"Eyebrows","Soft",30),CharacterSetFacialExpression(Player,"Eyes","Dizzy",30)},On={activity:{ID:"diaper-face-sit",Name:"Sits with Diaper on Face",Image:"https://zoe-64.github.io/ABCL/versions/beta/assets/activity/diaperFaceSit.png",Target:["ItemNose"],OnClick:(e,t)=>(e=>{if(e.MemberNumber!==Player.MemberNumber)return ActivityEffectFlat(Player,Player,5,"ItemButt",1),yi("diaper-face-sit",void 0,e.MemberNumber);Tn(e)})(e),Criteria:e=>fn(Player)&&Qt(e)&&!Player.IsRestrained()&&e.MemberNumber!==Player.MemberNumber},listeners:{"diaper-face-sit":({Sender:e})=>Tn(Zt(e)??Player)}},zn=e=>{const t=e.MemberNumber===Player.MemberNumber;ActivityEffectFlat(Player,Player,1,"ItemButt",1),sn(tn(t?"%NAME% pats %POSSESSIVE% diapered butt.":"%OPP_NAME% pats %NAME%'s diapered butt.",e),void 0,"playerActivity",e)},$n={activity:{ID:"diaper-pat-back",Name:"Diaper Pat Bottom",Image:"https://zoe-64.github.io/ABCL/versions/beta/assets/activity/diaperPatBack.png",Target:["ItemButt"],OnClick:(e,t)=>(e=>{if(e.MemberNumber!==Player.MemberNumber)return yi("diaper-pat-back",void 0,e.MemberNumber);zn(e)})(e),Criteria:e=>Qt(e)&&fn(e)&&!Player.IsRestrained()},listeners:{"diaper-pat-back":({Sender:e})=>zn(Zt(e)??Player)}},Gn=e=>{sn(tn(e.MemberNumber===Player.MemberNumber?"%NAME% pats %POSSESSIVE% diapered crotch.":"%OPP_NAME% pats %NAME%'s diapered crotch.",e),void 0,"playerActivity",e),ActivityEffectFlat(Player,Player,1,"ItemVulva",1)},Rn={activity:{ID:"diaper-pat-front",Name:"Diaper Pat Crotch",Image:"https://zoe-64.github.io/ABCL/versions/beta/assets/activity/diaperPatFront.png",Target:["ItemVulva"],OnClick:(e,t)=>(e=>{if(e.MemberNumber!==Player.MemberNumber)return yi("diaper-pat-front",void 0,e.MemberNumber);Gn(e)})(e),Criteria:e=>Qt(e)&&fn(e)&&!Player.IsRestrained()},listeners:{"diaper-pat-front":({Sender:e})=>Gn(Zt(e)??Player)}},Vn=(e,t)=>{sn(tn("%OPP_NAME% tugs %NAME%'s diaper waistband and pees inside.",e),void 0,"playerActivity",e),CharacterSetFacialExpression(Player,"Blush","Low",8),CharacterSetFacialExpression(Player,"Eyebrows","Soft",8),CharacterSetFacialExpression(Player,"Eyes","Surprised",5),cn.stats.WetnessValue+=t??0},jn={activity:{ID:"pee-in-diaper",Name:"Pees in Diaper",Image:"https://zoe-64.github.io/ABCL/versions/beta/assets/activity/diaperPeeOthersDiaper.png",Target:["ItemPelvis"],OnClick:(e,t)=>((e,t)=>{if(e.MemberNumber!==Player.MemberNumber)return yi("diaper-pee-others-diaper",{volume:t},e.MemberNumber);cn.stats.BladderValue=0,Vn(e,t)})(e,cn.stats.BladderValue),Criteria:e=>Qt(e)&&fn(e)&&cn.stats.BladderValue>0&&e!==Player&&!Player.IsRestrained()},listeners:{"diaper-pee-others-diaper":({Sender:e},{volume:t})=>Vn(Zt(e)??Player,t)}},Hn=e=>{sn(tn(e.MemberNumber===Player.MemberNumber?"%NAME% pours water in %POSSESSIVE% diaper.":"%OPP_NAME% pours water in %NAME%'s diaper.",e),void 0,"playerActivity",e),cn.stats.WetnessValue+=500,CharacterSetFacialExpression(Player,"Blush","Low",8),CharacterSetFacialExpression(Player,"Eyebrows","Soft",8),CharacterSetFacialExpression(Player,"Eyes","Surprised",5),CharacterSetFacialExpression(Player,"Eyes","Daydream",2)},Wn={activity:{ID:"diaper-pour",Name:"Pour Water in Diaper",Image:"https://zoe-64.github.io/ABCL/versions/beta/assets/activity/diaperPour.png",Target:["ItemPelvis"],OnClick:(e,t)=>(e=>{if(e.MemberNumber!==Player.MemberNumber)return yi("diaper-pour",void 0,e.MemberNumber);Hn(e)})(e),Criteria:e=>fn(e)&&Qt(e)&&!Player.IsRestrained()},listeners:{"diaper-pour":({Sender:e})=>Hn(Zt(e)??Player)}},Un=e=>{sn(tn(e.MemberNumber===Player.MemberNumber?"%NAME% rubs %POSSESSIVE% diapered butt.":"%OPP_NAME% rubs %NAME%'s diapered butt.",e),void 0,"playerActivity",e),ActivityEffectFlat(Player,Player,5,"ItemButt",1),cn.stats.Incontinence>Math.random()&&cn.attemptSoiling()},Yn={activity:{ID:"diaper-rub-back",Name:"Diaper Rub Bottom",Image:"https://zoe-64.github.io/ABCL/versions/beta/assets/activity/diaperRubBack.png",Target:["ItemButt"],OnClick:(e,t)=>(e=>{if(e.MemberNumber!==Player.MemberNumber)return yi("diaper-rub-back",void 0,e.MemberNumber);Un(e)})(e),Criteria:e=>Qt(e)&&fn(e)&&!Player.IsRestrained()},listeners:{"diaper-rub-back":({Sender:e})=>Un(Zt(e)??Player)}},qn=e=>{sn(tn(e.MemberNumber===Player.MemberNumber?"%NAME% rubs %POSSESSIVE% diapered crotch.":"%OPP_NAME% rubs %NAME%'s diapered crotch.",e),void 0,"playerActivity",e),ActivityEffectFlat(Player,Player,10,"ItemVulva",1),cn.stats.Incontinence>Math.random()&&cn.attemptWetting()},Xn={activity:{ID:"diaper-rub-front",Name:"Diaper Rub",Image:"https://zoe-64.github.io/ABCL/versions/beta/assets/activity/diaperRubFront.png",Target:["ItemVulva"],OnClick:(e,t)=>(e=>{if(e.MemberNumber!==Player.MemberNumber)return yi("diaper-rub-front",void 0,e.MemberNumber);qn(e)})(e),Criteria:e=>Qt(e)&&fn(e)&&!Player.IsRestrained()},listeners:{"diaper-rub-front":({Sender:e})=>qn(Zt(e)??Player)}},Kn=e=>{sn(tn(e.MemberNumber===Player.MemberNumber?"%NAME% squishes %POSSESSIVE% diapered butt.":"%OPP_NAME% squishes %NAME%'s diapered butt.",e),void 0,"playerActivity",e)},Zn={activity:{ID:"diaper-squish-back",Name:"Diaper Squish Bottom",Image:"https://zoe-64.github.io/ABCL/versions/beta/assets/activity/diaperSquishBack.png",Target:["ItemButt"],OnClick:(e,t)=>(e=>{if(e.MemberNumber!==Player.MemberNumber)return yi("diaper-squish-back",void 0,e.MemberNumber);Kn(e)})(e),Criteria:e=>Qt(e)&&fn(e)&&!Player.IsRestrained()},listeners:{"diaper-squish-back":({Sender:e})=>Kn(Zt(e)??Player)}},Jn=e=>{sn(tn(e.MemberNumber===Player.MemberNumber?"%NAME% squishes %POSSESSIVE% diapered crotch.":"%OPP_NAME% squishes %NAME%'s diapered crotch.",e),void 0,"playerActivity",e)},Qn={activity:{ID:"diaper-squish-front",Name:"Diaper Squish Crotch",Image:"https://zoe-64.github.io/ABCL/versions/beta/assets/activity/diaperSquishFront.png",Target:["ItemVulva"],OnClick:(e,t)=>(e=>{if(e.MemberNumber!==Player.MemberNumber)return yi("diaper-squish-front",void 0,e.MemberNumber);Jn(e)})(e),Criteria:e=>Qt(e)&&fn(e)&&!Player.IsRestrained()},listeners:{"diaper-squish-front":({Sender:e})=>Jn(Zt(e)??Player)}},ei=e=>{if(!(e.MemberNumber===Player.MemberNumber))return yi("lick-puddle",void 0,e.MemberNumber);ti(Player)},ti=e=>{sn(tn(e.MemberNumber===Player.MemberNumber?"%NAME% licks %POSSESSIVE% puddle of pee.":"%OPP_NAME% licks %NAME%'s puddle of pee.",e),void 0,"lickPuddle",e),CharacterSetFacialExpression(Player,"Fluids","DroolLow",20),_i(),rn(),cn.stats.PuddleSize-=50},ni={activity:{ID:"lick-puddle",Name:"Lick Puddle",Image:"https://zoe-64.github.io/ABCL/versions/beta/assets/activity/lickPuddle.png",Target:["ItemBoots"],OnClick:(e,t)=>ei(e),Criteria:e=>Qt(e)&&e.ABCL.Stats.PuddleSize.value>0},command:{Tag:"lick-puddle",Action:(e,t,n)=>{const i=Jt(n)??Player;if(!ni.activity.Criteria(i))return zt("Is either not an ABCL player or has no puddle.");ei(i)},Description:" [MemberNumber|Name|Nickname]: Licks a puddle of pee."},listeners:{"lick-puddle":({Sender:e})=>ti(Zt(e)??Player)}},ii={listeners:{onABCLMessage:({Sender:e},{message:t,local:n})=>{zt(t,void 0,"background: #FFA9A93B",n)}}},si={listeners:{sync:({Sender:e},t)=>{if(!e)return;console.log("sync:ABCL"),n.debug({message:"Received updated data",data:t});const i=Zt(e);i&&(i.ABCL={Stats:t.stats,Version:t.version,Settings:t.settings})},init:({Sender:e})=>{console.log("init"),n.debug("Received request for data"),_i(e)}}},ri={activity:{ID:"pee",Name:"Pee",Image:"https://zoe-64.github.io/ABCL/versions/beta/assets/activity/wetDiaper.svg",OnClick:(e,t)=>cn.wet(!0),TargetSelf:["ItemPelvis"]},command:{Tag:"pee",Action:(e,t,n)=>cn.wet(!0),Description:" Lets go of your bladder."}},ai={activity:{ID:"poop",Name:"Poop",Image:"https://zoe-64.github.io/ABCL/versions/beta/assets/activity/soilDiaper.svg",OnClick:(e,t)=>cn.soil(!0),TargetSelf:["ItemPelvis"]},command:{Tag:"poop",Action:()=>cn.soil(!0),Description:" Relaxes your bowels."}},oi=()=>{const e=.3*cn.stats.Incontinence,t=cn.stats.BladderFullness>.6||cn.stats.BowelFullness>.6,n=cn.stats.BladderFullness<.3-e&&cn.stats.BowelFullness<.3-e,i=cn.stats.MentalRegression>.9,s=cn.stats.MentalRegression<.3;if(n)return void sn("%NAME% tries to use the potty but can't seem to get anything out.",void 0,"usePotty");cn.stats.BowelFullness=0,cn.stats.BladderFullness=0;let r="";s&&(r="and feels embarrased",CharacterSetFacialExpression(Player,"Blush","Low",10),cn.stats.MentalRegression+=.04),t&&!i&&(r+=s?" but is releaved":"and feels releaved",cn.stats.Incontinence+=-.01,cn.stats.MentalRegression-=.02,CharacterSetFacialExpression(Player,"Mouth","Happy",8)),sn("%NAME% sits down and uses the potty "+r+".",void 0,"usePotty")},li={activity:{ID:"potty",Name:"Sit and Use Potty",Image:"https://zoe-64.github.io/ABCL/versions/beta/assets/activity/potty-temp.png",OnClick:(e,t)=>oi(),TargetSelf:["ItemButt"],Criteria:e=>!(fn(e)&&_n()||Player.IsRestrained())},command:{Tag:"use-potty",Action:(e,t,n)=>{if(!li.activity?.Criteria(Player))return zt("You are restrained or diaper is locked.");oi()},Description:" Sit down and use the potty."}},ci=()=>{const e=.3*cn.stats.Incontinence,t=cn.stats.BladderFullness<.3&&cn.stats.BowelFullness<.3,n=cn.stats.BladderFullness>.6-e||cn.stats.BowelFullness>.6-e;if(t)return zt("You try to use the toilet but you can't seem to get anything out.");let i="";n&&(i="and feels releaved",cn.stats.MentalRegression-=.02,cn.stats.Incontinence+=-.01),cn.stats.BladderFullness=0,cn.stats.BowelFullness=0,sn("%NAME% goes to the bathroom and uses the toilet "+i+".",void 0,"useToilet")},ui={activity:{ID:"toilet",Name:"Sit and Use Toilet",Image:"https://zoe-64.github.io/ABCL/versions/beta/assets/activity/toilet-temp.png",OnClick:e=>ci(),Criteria:e=>cn.stats.MentalRegression<.3&&!(fn(e)&&_n())&&!Player.IsRestrained(),TargetSelf:["ItemButt"]},command:{Tag:"use-toilet",Action:()=>cn.stats.MentalRegression<.3?(CharacterSetFacialExpression(Player,"Eyes","Dizzy",8),zt("You feel uncomfortable, the toilet is cold and hard almost like ice. You can't use it.")):fn()&&(Player.IsRestrained()||_n())?zt("You can't use the toilet while your diaper is locked."):void ci(),Description:" Sit down and use the toilet."}},di=e=>{if(e.MemberNumber!==Player.MemberNumber)return yi("wipe-puddle",void 0,e.MemberNumber);pi(Player)},pi=e=>{if(cn.stats.PuddleSize=0,_i(),rn(),e.MemberNumber!==Player.MemberNumber)return sn(tn("%OPP_NAME% wipes %NAME%'s puddle of pee.",e),void 0,"wipePuddle",e);sn(tn("%NAME% wipes %POSSESSIVE% puddle of pee.",e),void 0,"wipePuddle",e)},hi={activity:{ID:"wipe-puddle",Name:"Wipe Puddle",Image:"./Assets/Female3DCG/ItemHandheld/Preview/Towel.png",Target:["ItemBoots"],OnClick:(e,t)=>di(e),Criteria:e=>Qt(e)&&e.ABCL.Stats.PuddleSize.value>0&&!Player.IsRestrained()},command:{Tag:"wipe-puddle",Action:(e,t,n)=>{const i=Zt(n[0])??Player;if(!hi.activity.Criteria(i))return zt("Is either not an ABCL player or has no puddle. Or you are restrained.");di(i)},Description:" [MemberNumber|Name|Nickname]: Wipes a puddle of pee."},listeners:{"wipe-puddle":({Sender:e})=>{pi(Zt(e)??Player)}}};class mi{constructor(e,t,n,i,s,r,a){this.id=e,this.name=t,this.image=n,this.onClick=i,this.target=s,this.targetSelf=r,this.criteria=a}fitsCriteria(e,t){return Boolean((!this.criteria||this.criteria(e))&&(this.target?.includes(t)||this.targetSelf?.includes(t)&&Player.MemberNumber===e?.MemberNumber))}createButton(){const e=document.createElement("button");return e.id=this.id,e.name=`ABCL_${this.name}`,e.dataset.group="ItemArms",e.className="blank-button button button-styling HideOnPopup dialog-grid-button",e.innerHTML=`<img decoding="async" loading="lazy" src="${this.image}" class="button-image"><span class="button-label button-label-bottom">${this.name}</span>`,e.addEventListener("click",(e=>{const t=CurrentCharacter?.FocusGroup?CurrentCharacter:Player,n=t?.FocusGroup?.Name;this.onClick&&n&&(this.onClick(t,n),DialogLeave())})),e}static isInserted(e){return Boolean(document.getElementById(e))}}const fi=[kn,En,ri,ai,li,ui,si,ni,hi,ii,Fn,On,$n,Rn,jn,Wn,Xn,Yn,Zn,Qn],gi=fi.reduce(((e,{command:t})=>t?[...e,t]:e),[]);fi.reduce(((e,{activity:t})=>t?[...e,t]:e),[]);const yi=(e,t,n)=>{const i={Type:"Hidden",Content:`${o}Msg`,Sender:Player.MemberNumber,Target:n,Dictionary:[{type:e,data:t}]};ServerSend("ChatRoomChat",i),console.log("sendDataToAction",e,t,n)},_i=e=>{console.log("sendUpdateMyData target",e),yi("sync",{settings:Player[o].Settings,stats:Player[o].Stats,version:r},e),n.debug({message:`Sending updated data to ${e??"everyone"}`})},bi=()=>{yi("init",1),n.debug("Requesting data from others.")},vi=async()=>{await async function(e,t=(()=>!1)){for(;!e();){if(t())return!1;await new Promise((e=>setTimeout(e,10)))}return!0}((()=>ServerSocket&&ServerIsConnected)),Tt.hookFunction("DrawCharacter",1,((e,t)=>{const[n,i,s,r]=e;if(Qt(n)&&n.ABCL.Stats.PuddleSize.value>0){const e=n.ABCL.Stats.PuddleSize.value/300,t=512*e,a=235*e;DrawImageResize("https://zoe-64.github.io/ABCL/versions/beta/assets/puddle.png",i+(250*r-t/2),s+(940*r-a/2),t,a)}return t(e)})),Tt.hookFunction("ChatRoomSync",1,((e,t)=>(_i(),t(e)))),Tt.hookFunction("ChatRoomMessage",1,((e,t)=>{if("ServerEnter"!==e[0].Content||e[0].Sender!==Player.MemberNumber)return(e=>{if("ABCLMsg"!==e?.Content)return;if(!e.Sender||!e.Dictionary)return;if(e.Sender===Player.MemberNumber)return;if("Hidden"!==e.Type)return;if(!e.Dictionary[0]?.type)return;const t=e.Dictionary[0]?.type,n=e.Dictionary[0]?.data;for(const i of fi){const s=i.listeners?.[t];s&&s(e,n)}console.log("receivePacket",t,n,e.Sender)})(e[0]),t(e);bi()})),Tt.hookFunction("CharacterAppearanceSetItem",1,((e,t)=>{let[n,i,s]=e;const r=t(e);return"ItemPelvis"===i&&s&&mn({Asset:s})&&vn(),r})),Tt.hookFunction("ActivityRun",1,((e,t)=>{const n=t(e),[i,r,a,o,...l]=e,c=o?.Activity;if(Player.ABCL.Settings.AccidentsByActivities&&r.MemberNumber===Player.MemberNumber&&c.Name in s){const e=s[c.Name];"Disabled"!==Player.ABCL.Settings.PeeMetabolism&&e.wetting&&Math.random()<e.wetting*(1+2*cn.stats.Incontinence)&&cn.attemptWetting(),"Disabled"!==Player.ABCL.Settings.PoopMetabolism&&e.messing&&Math.random()<e.messing*(1+2*cn.stats.Incontinence)&&cn.attemptSoiling()}return n})),Tt.hookFunction("PreferenceSubscreenChatClick",1,((e,t)=>{if(MouseIn(1815,75,90,90)){const e=Player.ChatSettings?.ColorTheme??"Light";e.startsWith("Light")&&qt&&!qt.classList.contains("sl-theme-light")&&(qt.classList.remove("sl-theme-dark"),qt.classList.add("sl-theme-light"),qt.style.color="black",n.info("SL theme switching: Light")),e.startsWith("Dark")&&qt&&!qt.classList.contains("sl-theme-dark")&&(qt.classList.remove("sl-theme-light"),qt.classList.add("sl-theme-dark"),qt.style.color="white",n.info("SL theme switching: Dark"))}return t(e)}))},Ai=[];window.addEventListener("error",(async e=>{if(console.error(e.filename),!e.filename.toLowerCase().includes("abcl"))return;const n=`${e.message} at ${e.filename} ${e.lineno}`;if(Ai.includes(n))return;Ai.push(n);const i={username:`${Player.Name} ${""===Player.Nickname?"":`aka ${Player.Nickname}`} (${Player.MemberNumber})`,thread_name:`${o} ${r} Error ${e.message}`.slice(0,100),content:`\n    error: ${n}\n\`\`\`\n${e.error.stack}\n\`\`\`\nmods: ${t.getModsInfo().map((e=>e.name)).join(", ")}`};await fetch("https://discord.com/api/webhooks/1340000414506029162/aqt7qruFnzDMM5BN_kLtv9gCcallIF-JeRVYl9k23uSIlxrHRvcFMy5mtPUPGDpWZhHX",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})}));var Ci,Pi,Si,wi,Mi,Bi,Li,Di,Ni,ki,Ii,Ei={},xi=[],Fi=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Ti=Array.isArray;function Oi(e,t){for(var n in t)e[n]=t[n];return e}function zi(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function $i(e,t,n,i,s){var r={type:e,props:t,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:null==s?++Si:s,__i:-1,__u:0};return null==s&&null!=Pi.vnode&&Pi.vnode(r),r}function Gi(e){return e.children}function Ri(e,t){this.props=e,this.context=t}function Vi(e,t){if(null==t)return e.__?Vi(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?Vi(e):null}function ji(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return ji(e)}}function Hi(e){(!e.__d&&(e.__d=!0)&&wi.push(e)&&!Wi.__r++||Mi!==Pi.debounceRendering)&&((Mi=Pi.debounceRendering)||Bi)(Wi)}function Wi(){for(var e,t,n,i,s,r,a,o=1;wi.length;)wi.length>o&&wi.sort(Li),e=wi.shift(),o=wi.length,e.__d&&(n=void 0,s=(i=(t=e).__v).__e,r=[],a=[],t.__P&&((n=Oi({},i)).__v=i.__v+1,Pi.vnode&&Pi.vnode(n),Ji(t.__P,n,i,t.__n,t.__P.namespaceURI,32&i.__u?[s]:null,r,null==s?Vi(i):s,!!(32&i.__u),a),n.__v=i.__v,n.__.__k[n.__i]=n,Qi(r,n,a),n.__e!=s&&ji(n)));Wi.__r=0}function Ui(e,t,n,i,s,r,a,o,l,c,u){var d,p,h,m,f,g,y=i&&i.__k||xi,_=t.length;for(l=function(e,t,n,i,s){var r,a,o,l,c,u=n.length,d=u,p=0;for(e.__k=new Array(s),r=0;r<s;r++)null!=(a=t[r])&&"boolean"!=typeof a&&"function"!=typeof a?(l=r+p,(a=e.__k[r]="string"==typeof a||"number"==typeof a||"bigint"==typeof a||a.constructor==String?$i(null,a,null,null,null):Ti(a)?$i(Gi,{children:a},null,null,null):void 0===a.constructor&&a.__b>0?$i(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):a).__=e,a.__b=e.__b+1,o=null,-1!==(c=a.__i=qi(a,n,l,d))&&(d--,(o=n[c])&&(o.__u|=2)),null==o||null===o.__v?(-1==c&&(s>u?p--:s<u&&p++),"function"!=typeof a.type&&(a.__u|=4)):c!=l&&(c==l-1?p--:c==l+1?p++:(c>l?p--:p++,a.__u|=4))):e.__k[r]=null;if(d)for(r=0;r<u;r++)null!=(o=n[r])&&!(2&o.__u)&&(o.__e==i&&(i=Vi(o)),ns(o,o));return i}(n,t,y,l,_),d=0;d<_;d++)null!=(h=n.__k[d])&&(p=-1===h.__i?Ei:y[h.__i]||Ei,h.__i=d,g=Ji(e,h,p,s,r,a,o,l,c,u),m=h.__e,h.ref&&p.ref!=h.ref&&(p.ref&&ts(p.ref,null,h),u.push(h.ref,h.__c||m,h)),null==f&&null!=m&&(f=m),4&h.__u||p.__k===h.__k?l=Yi(h,l,e):"function"==typeof h.type&&void 0!==g?l=g:m&&(l=m.nextSibling),h.__u&=-7);return n.__e=f,l}function Yi(e,t,n){var i,s;if("function"==typeof e.type){for(i=e.__k,s=0;i&&s<i.length;s++)i[s]&&(i[s].__=e,t=Yi(i[s],t,n));return t}e.__e!=t&&(t&&e.type&&!n.contains(t)&&(t=Vi(e)),n.insertBefore(e.__e,t||null),t=e.__e);do{t=t&&t.nextSibling}while(null!=t&&8==t.nodeType);return t}function qi(e,t,n,i){var s,r,a=e.key,o=e.type,l=t[n];if(null===l&&null==e.key||l&&a==l.key&&o===l.type&&!(2&l.__u))return n;if(i>(null==l||2&l.__u?0:1))for(s=n-1,r=n+1;s>=0||r<t.length;){if(s>=0){if((l=t[s])&&!(2&l.__u)&&a==l.key&&o===l.type)return s;s--}if(r<t.length){if((l=t[r])&&!(2&l.__u)&&a==l.key&&o===l.type)return r;r++}}return-1}function Xi(e,t,n){"-"==t[0]?e.setProperty(t,null==n?"":n):e[t]=null==n?"":"number"!=typeof n||Fi.test(t)?n:n+"px"}function Ki(e,t,n,i,s){var r;e:if("style"==t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof i&&(e.style.cssText=i=""),i)for(t in i)n&&t in n||Xi(e.style,t,"");if(n)for(t in n)i&&n[t]===i[t]||Xi(e.style,t,n[t])}else if("o"==t[0]&&"n"==t[1])r=t!=(t=t.replace(Di,"$1")),t=t.toLowerCase()in e||"onFocusOut"==t||"onFocusIn"==t?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+r]=n,n?i?n.t=i.t:(n.t=Ni,e.addEventListener(t,r?Ii:ki,r)):e.removeEventListener(t,r?Ii:ki,r);else{if("http://www.w3.org/2000/svg"==s)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!=t&&"height"!=t&&"href"!=t&&"list"!=t&&"form"!=t&&"tabIndex"!=t&&"download"!=t&&"rowSpan"!=t&&"colSpan"!=t&&"role"!=t&&"popover"!=t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null==n||!1===n&&"-"!=t[4]?e.removeAttribute(t):e.setAttribute(t,"popover"==t&&1==n?"":n))}}function Zi(e){return function(t){if(this.l){var n=this.l[t.type+e];if(null==t.u)t.u=Ni++;else if(t.u<n.t)return;return n(Pi.event?Pi.event(t):t)}}}function Ji(e,t,n,i,s,r,a,o,l,c){var u,d,p,h,m,f,g,y,_,b,v,A,C,P,S,w,M,B=t.type;if(void 0!==t.constructor)return null;128&n.__u&&(l=!!(32&n.__u),r=[o=t.__e=n.__e]),(u=Pi.__b)&&u(t);e:if("function"==typeof B)try{if(y=t.props,_="prototype"in B&&B.prototype.render,b=(u=B.contextType)&&i[u.__c],v=u?b?b.props.value:u.__:i,n.__c?g=(d=t.__c=n.__c).__=d.__E:(_?t.__c=d=new B(y,v):(t.__c=d=new Ri(y,v),d.constructor=B,d.render=is),b&&b.sub(d),d.props=y,d.state||(d.state={}),d.context=v,d.__n=i,p=d.__d=!0,d.__h=[],d._sb=[]),_&&null==d.__s&&(d.__s=d.state),_&&null!=B.getDerivedStateFromProps&&(d.__s==d.state&&(d.__s=Oi({},d.__s)),Oi(d.__s,B.getDerivedStateFromProps(y,d.__s))),h=d.props,m=d.state,d.__v=t,p)_&&null==B.getDerivedStateFromProps&&null!=d.componentWillMount&&d.componentWillMount(),_&&null!=d.componentDidMount&&d.__h.push(d.componentDidMount);else{if(_&&null==B.getDerivedStateFromProps&&y!==h&&null!=d.componentWillReceiveProps&&d.componentWillReceiveProps(y,v),!d.__e&&(null!=d.shouldComponentUpdate&&!1===d.shouldComponentUpdate(y,d.__s,v)||t.__v==n.__v)){for(t.__v!=n.__v&&(d.props=y,d.state=d.__s,d.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some((function(e){e&&(e.__=t)})),A=0;A<d._sb.length;A++)d.__h.push(d._sb[A]);d._sb=[],d.__h.length&&a.push(d);break e}null!=d.componentWillUpdate&&d.componentWillUpdate(y,d.__s,v),_&&null!=d.componentDidUpdate&&d.__h.push((function(){d.componentDidUpdate(h,m,f)}))}if(d.context=v,d.props=y,d.__P=e,d.__e=!1,C=Pi.__r,P=0,_){for(d.state=d.__s,d.__d=!1,C&&C(t),u=d.render(d.props,d.state,d.context),S=0;S<d._sb.length;S++)d.__h.push(d._sb[S]);d._sb=[]}else do{d.__d=!1,C&&C(t),u=d.render(d.props,d.state,d.context),d.state=d.__s}while(d.__d&&++P<25);d.state=d.__s,null!=d.getChildContext&&(i=Oi(Oi({},i),d.getChildContext())),_&&!p&&null!=d.getSnapshotBeforeUpdate&&(f=d.getSnapshotBeforeUpdate(h,m)),w=u,null!=u&&u.type===Gi&&null==u.key&&(w=es(u.props.children)),o=Ui(e,Ti(w)?w:[w],t,n,i,s,r,a,o,l,c),d.base=t.__e,t.__u&=-161,d.__h.length&&a.push(d),g&&(d.__E=d.__=null)}catch(e){if(t.__v=null,l||null!=r)if(e.then){for(t.__u|=l?160:128;o&&8==o.nodeType&&o.nextSibling;)o=o.nextSibling;r[r.indexOf(o)]=null,t.__e=o}else for(M=r.length;M--;)zi(r[M]);else t.__e=n.__e,t.__k=n.__k;Pi.__e(e,t,n)}else null==r&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):o=t.__e=function(e,t,n,i,s,r,a,o,l){var c,u,d,p,h,m,f,g=n.props,y=t.props,_=t.type;if("svg"==_?s="http://www.w3.org/2000/svg":"math"==_?s="http://www.w3.org/1998/Math/MathML":s||(s="http://www.w3.org/1999/xhtml"),null!=r)for(c=0;c<r.length;c++)if((h=r[c])&&"setAttribute"in h==!!_&&(_?h.localName==_:3==h.nodeType)){e=h,r[c]=null;break}if(null==e){if(null==_)return document.createTextNode(y);e=document.createElementNS(s,_,y.is&&y),o&&(Pi.__m&&Pi.__m(t,r),o=!1),r=null}if(null===_)g===y||o&&e.data===y||(e.data=y);else{if(r=r&&Ci.call(e.childNodes),g=n.props||Ei,!o&&null!=r)for(g={},c=0;c<e.attributes.length;c++)g[(h=e.attributes[c]).name]=h.value;for(c in g)if(h=g[c],"children"==c);else if("dangerouslySetInnerHTML"==c)d=h;else if(!(c in y)){if("value"==c&&"defaultValue"in y||"checked"==c&&"defaultChecked"in y)continue;Ki(e,c,null,h,s)}for(c in y)h=y[c],"children"==c?p=h:"dangerouslySetInnerHTML"==c?u=h:"value"==c?m=h:"checked"==c?f=h:o&&"function"!=typeof h||g[c]===h||Ki(e,c,h,g[c],s);if(u)o||d&&(u.__html===d.__html||u.__html===e.innerHTML)||(e.innerHTML=u.__html),t.__k=[];else if(d&&(e.innerHTML=""),Ui("template"===t.type?e.content:e,Ti(p)?p:[p],t,n,i,"foreignObject"==_?"http://www.w3.org/1999/xhtml":s,r,a,r?r[0]:n.__k&&Vi(n,0),o,l),null!=r)for(c=r.length;c--;)zi(r[c]);o||(c="value","progress"==_&&null==m?e.removeAttribute("value"):void 0!==m&&(m!==e[c]||"progress"==_&&!m||"option"==_&&m!==g[c])&&Ki(e,c,m,g[c],s),c="checked",void 0!==f&&f!==e[c]&&Ki(e,c,f,g[c],s))}return e}(n.__e,t,n,i,s,r,a,l,c);return(u=Pi.diffed)&&u(t),128&t.__u?void 0:o}function Qi(e,t,n){for(var i=0;i<n.length;i++)ts(n[i],n[++i],n[++i]);Pi.__c&&Pi.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){Pi.__e(e,t.__v)}}))}function es(e){return"object"!=typeof e||null==e?e:Ti(e)?e.map(es):Oi({},e)}function ts(e,t,n){try{if("function"==typeof e){var i="function"==typeof e.__u;i&&e.__u(),i&&null==t||(e.__u=e(t))}else e.current=t}catch(e){Pi.__e(e,n)}}function ns(e,t,n){var i,s;if(Pi.unmount&&Pi.unmount(e),(i=e.ref)&&(i.current&&i.current!==e.__e||ts(i,null,t)),null!=(i=e.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(e){Pi.__e(e,t)}i.base=i.__P=null}if(i=e.__k)for(s=0;s<i.length;s++)i[s]&&ns(i[s],t,n||"function"!=typeof e.type);n||zi(e.__e),e.__c=e.__=e.__e=void 0}function is(e,t,n){return this.constructor(e,n)}function ss(e,t,n){var i,s,r,a;t==document&&(t=document.documentElement),Pi.__&&Pi.__(e,t),s=(i="function"==typeof n)?null:n&&n.__k||t.__k,r=[],a=[],Ji(t,e=(!i&&n||t).__k=function(e,t,n){var i,s,r,a={};for(r in t)"key"==r?i=t[r]:"ref"==r?s=t[r]:a[r]=t[r];if(arguments.length>2&&(a.children=arguments.length>3?Ci.call(arguments,2):n),"function"==typeof e&&null!=e.defaultProps)for(r in e.defaultProps)void 0===a[r]&&(a[r]=e.defaultProps[r]);return $i(e,a,i,s,null)}(Gi,null,[e]),s||Ei,Ei,t.namespaceURI,!i&&n?[n]:s?null:t.firstChild?Ci.call(t.childNodes):null,r,!i&&n?n:s?s.__e:t.firstChild,i,a),Qi(r,e,a)}Ci=xi.slice,Pi={__e:function(e,t,n,i){for(var s,r,a;t=t.__;)if((s=t.__c)&&!s.__)try{if((r=s.constructor)&&null!=r.getDerivedStateFromError&&(s.setState(r.getDerivedStateFromError(e)),a=s.__d),null!=s.componentDidCatch&&(s.componentDidCatch(e,i||{}),a=s.__d),a)return s.__E=s}catch(t){e=t}throw e}},Si=0,Ri.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=Oi({},this.state),"function"==typeof e&&(e=e(Oi({},n),this.props)),e&&Oi(n,e),null!=e&&this.__v&&(t&&this._sb.push(t),Hi(this))},Ri.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),Hi(this))},Ri.prototype.render=Gi,wi=[],Bi="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Li=function(e,t){return e.__v.__b-t.__v.__b},Wi.__r=0,Di=/(PointerCapture)$|Capture$/i,Ni=0,ki=Zi(!1),Ii=Zi(!0);var rs=0;function as(e,t,n,i,s,r){t||(t={});var a,o,l=t;if("ref"in l)for(o in l={},t)"ref"==o?a=t[o]:l[o]=t[o];var c={type:e,props:l,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--rs,__i:-1,__u:0,__source:s,__self:r};if("function"==typeof e&&(a=e.defaultProps))for(o in a)void 0===l[o]&&(l[o]=a[o]);return Pi.vnode&&Pi.vnode(c),c}function os({checked:e,setChecked:t,label:n}){return as("div",{style:{display:"flex",alignItems:"center",width:"fit-content",padding:"10px 10px",whiteSpace:"nowrap"},children:[as("input",{style:{width:"6vh",height:"6vh"},type:"checkbox",checked:e,onChange:e=>t(e.target.checked)}),as("p",{style:{marginLeft:"5px"},children:n})]})}function ls({options:e,value:t,setValue:n,label:i}){return as("div",{style:{display:"flex",alignItems:"center",width:"fit-content",padding:"5px 0"},children:[as("p",{style:{marginRight:"10px"},children:i}),e.map(((e,i)=>as("button",{style:{backgroundColor:e===t?"var(--tmd-accent,rgb(0, 0, 0))":"var(--tmd-element,rgb(145, 145, 145))",color:"var(--tmd-text, #fff)",border:"1px solid var(--tmd-element, #262626)",padding:"5px",cursor:"pointer"},onClick:()=>n(e),children:e},i)))]})}var cs,us,ds,ps,hs=0,ms=[],fs=Pi,gs=fs.__b,ys=fs.__r,_s=fs.diffed,bs=fs.__c,vs=fs.unmount,As=fs.__;function Cs(e,t){fs.__h&&fs.__h(us,e,hs||t),hs=0;var n=us.__H||(us.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function Ps(e){return hs=1,function(e,t,n){var i=Cs(cs++,2);if(i.t=e,!i.__c&&(i.__=[n?n(t):Ns(void 0,t),function(e){var t=i.__N?i.__N[0]:i.__[0],n=i.t(t,e);t!==n&&(i.__N=[n,i.__[1]],i.__c.setState({}))}],i.__c=us,!us.__f)){var s=function(e,t,n){if(!i.__c.__H)return!0;var s=i.__c.__H.__.filter((function(e){return!!e.__c}));if(s.every((function(e){return!e.__N})))return!r||r.call(this,e,t,n);var a=i.__c.props!==e;return s.forEach((function(e){if(e.__N){var t=e.__[0];e.__=e.__N,e.__N=void 0,t!==e.__[0]&&(a=!0)}})),r&&r.call(this,e,t,n)||a};us.__f=!0;var r=us.shouldComponentUpdate,a=us.componentWillUpdate;us.componentWillUpdate=function(e,t,n){if(this.__e){var i=r;r=void 0,s(e,t,n),r=i}a&&a.call(this,e,t,n)},us.shouldComponentUpdate=s}return i.__N||i.__}(Ns,e)}function Ss(e,t){var n=Cs(cs++,3);!fs.__s&&function(e,t){return!e||e.length!==t.length||t.some((function(t,n){return t!==e[n]}))}(n.__H,t)&&(n.__=e,n.u=t,us.__H.__h.push(n))}function ws(){for(var e;e=ms.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Ls),e.__H.__h.forEach(Ds),e.__H.__h=[]}catch(t){e.__H.__h=[],fs.__e(t,e.__v)}}fs.__b=function(e){us=null,gs&&gs(e)},fs.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),As&&As(e,t)},fs.__r=function(e){ys&&ys(e),cs=0;var t=(us=e.__c).__H;t&&(ds===us?(t.__h=[],us.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.u=e.__N=void 0}))):(t.__h.forEach(Ls),t.__h.forEach(Ds),t.__h=[],cs=0)),ds=us},fs.diffed=function(e){_s&&_s(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==ms.push(t)&&ps===fs.requestAnimationFrame||((ps=fs.requestAnimationFrame)||Bs)(ws)),t.__H.__.forEach((function(e){e.u&&(e.__H=e.u),e.u=void 0}))),ds=us=null},fs.__c=function(e,t){t.some((function(e){try{e.__h.forEach(Ls),e.__h=e.__h.filter((function(e){return!e.__||Ds(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],fs.__e(n,e.__v)}})),bs&&bs(e,t)},fs.unmount=function(e){vs&&vs(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{Ls(e)}catch(e){t=e}})),n.__H=void 0,t&&fs.__e(t,n.__v))};var Ms="function"==typeof requestAnimationFrame;function Bs(e){var t,n=function(){clearTimeout(i),Ms&&cancelAnimationFrame(t),setTimeout(e)},i=setTimeout(n,100);Ms&&(t=requestAnimationFrame(n))}function Ls(e){var t=us,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),us=t}function Ds(e){var t=us;e.__c=e.__(),us=t}function Ns(e,t){return"function"==typeof t?t(e):t}function ks(){const[e,t]=Ps(Player.ABCL.Settings.PeeMetabolism),[n,i]=Ps(Player.ABCL.Settings.PoopMetabolism),[s,r]=Ps(Player.ABCL.Settings.OnDiaperChange);return as("div",{style:{top:"20px",left:"100px",padding:"80px"},id:"ABCLSettingsPage",className:"ABCLHidden",children:[as("h1",{style:{textAlign:"center",width:"fit-content"},children:" Settings "}),as("div",{children:[as("h2",{children:"Wet and Soiling"}),as("div",{children:[as("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr"},children:[as(os,{checked:Player.ABCL.Settings.DisableWettingLeaks,setChecked:e=>Player.ABCL.Settings.DisableWettingLeaks=e,label:"Disable Wetting Leaks / Puddles"}),as(os,{checked:Player.ABCL.Settings.DisableSoilingLeaks,setChecked:e=>Player.ABCL.Settings.DisableSoilingLeaks=e,label:"Disable Messy Leaks"}),as(os,{checked:Player.ABCL.Settings.DisableClothingStains,setChecked:e=>Player.ABCL.Settings.DisableClothingStains=e,label:"Disable Clothing Stains"}),as(os,{checked:Player.ABCL.Settings.DisableDiaperStains,setChecked:e=>Player.ABCL.Settings.DisableDiaperStains=e,label:"Disable Diaper Stains"}),as(os,{checked:Player.ABCL.Settings.AccidentsByActivities,setChecked:e=>Player.ABCL.Settings.AccidentsByActivities=e,label:"Accidents by Activities (Experimental)"}),as("div",{}),as("div",{}),as("div",{})]}),as(ls,{options:["Disabled","Slow","Normal","Fast","Faster","Fastest"],value:e,setValue:e=>{t(e),Player.ABCL.Settings.PeeMetabolism=e},label:"Pee Metabolism"}),as(ls,{options:["Disabled","Slow","Normal","Fast","Faster","Fastest"],value:n,setValue:e=>{i(e),Player.ABCL.Settings.PoopMetabolism=e},label:"Poop Metabolism"}),as(ls,{options:["Deny","Ask","Allow"],value:s,setValue:e=>{r(e),Player.ABCL.Settings.OnDiaperChange=e},label:"On Diaper Prompt"})]})]}),as("hr",{style:{margin:"20px 0"}}),as("div",{children:[as("h2",{children:"Visible Messages to Players"}),as("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr"},children:[as(os,{checked:Player.ABCL.Settings.VisibleMessages.wetDiaper,setChecked:e=>Player.ABCL.Settings.VisibleMessages.wetDiaper=e,label:"Wetting Diapers"}),as(os,{checked:Player.ABCL.Settings.VisibleMessages.wetClothing,setChecked:e=>Player.ABCL.Settings.VisibleMessages.wetClothing=e,label:"Wetting Clothes"}),as(os,{checked:Player.ABCL.Settings.VisibleMessages.soilDiaper,setChecked:e=>Player.ABCL.Settings.VisibleMessages.soilDiaper=e,label:"Soiling Diapers"}),as(os,{checked:Player.ABCL.Settings.VisibleMessages.soilClothing,setChecked:e=>Player.ABCL.Settings.VisibleMessages.soilClothing=e,label:"Soiling Clothes"}),as(os,{checked:Player.ABCL.Settings.VisibleMessages.changeDiaper,setChecked:e=>Player.ABCL.Settings.VisibleMessages.changeDiaper=e,label:"Changing Diapers"}),as(os,{checked:Player.ABCL.Settings.VisibleMessages.checkDiaper,setChecked:e=>Player.ABCL.Settings.VisibleMessages.checkDiaper=e,label:"Checking Diapers"}),as(os,{checked:Player.ABCL.Settings.VisibleMessages.lickPuddle,setChecked:e=>Player.ABCL.Settings.VisibleMessages.lickPuddle=e,label:"Licking Puddles"}),as(os,{checked:Player.ABCL.Settings.VisibleMessages.wipePuddle,setChecked:e=>Player.ABCL.Settings.VisibleMessages.wipePuddle=e,label:"Wiping Puddle"}),as(os,{checked:Player.ABCL.Settings.VisibleMessages.usePotty,setChecked:e=>Player.ABCL.Settings.VisibleMessages.usePotty=e,label:"Using Potty"}),as(os,{checked:Player.ABCL.Settings.VisibleMessages.useToilet,setChecked:e=>Player.ABCL.Settings.VisibleMessages.useToilet=e,label:"Using Toilet"}),as(os,{checked:Player.ABCL.Settings.VisibleMessages.statusMessages,setChecked:e=>Player.ABCL.Settings.VisibleMessages.statusMessages=e,label:"Show Status Messages"}),as("div",{})]})]}),as("div",{children:[as("h2",{children:"Visible Status Messages to Yourself"}),as("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr"},children:[as(os,{checked:Player.ABCL.Settings.StatusMessages.Wetness??!1,setChecked:e=>Player.ABCL.Settings.StatusMessages.Wetness=e,label:"Show wetness status message"}),as(os,{checked:Player.ABCL.Settings.StatusMessages.Soiliness??!1,setChecked:e=>Player.ABCL.Settings.StatusMessages.Soiliness=e,label:"Show soiliness status message"}),as(os,{checked:Player.ABCL.Settings.StatusMessages.Bladder??!1,setChecked:e=>Player.ABCL.Settings.StatusMessages.Bladder=e,label:"Show bladder status message"}),as(os,{checked:Player.ABCL.Settings.StatusMessages.Bowel??!1,setChecked:e=>Player.ABCL.Settings.StatusMessages.Bowel=e,label:"Show bowel status message"}),as(os,{checked:Player.ABCL.Settings.StatusMessages.Incontinence??!1,setChecked:e=>Player.ABCL.Settings.StatusMessages.Incontinence=e,label:"Show incontinence status message"}),as(os,{checked:Player.ABCL.Settings.StatusMessages.MentalRegression??!1,setChecked:e=>Player.ABCL.Settings.StatusMessages.MentalRegression=e,label:"Show mental regression status message"}),as(os,{checked:Player.ABCL.Settings.StatusMessages.PuddleSize??!1,setChecked:e=>Player.ABCL.Settings.StatusMessages.PuddleSize=e,label:"Show puddle size status message"}),as("div",{})]})]})]})}function Is({value:e,label:t,color:n="#FFFFFF",foreground:i="#000000",format:s=(e=>(100*e).toFixed(0))}){return as("div",{class:"value-bar no-resize",children:[as("div",{style:{background:i,width:"100%",height:"10px"},children:as("div",{style:{background:n,width:100*e+"%",height:"100%"}})}),as("p",{class:"value-bar-label",children:t}),as("p",{class:"value-bar-value",children:[s(e),"%"]})]})}function Es(){const[e,t]=Ps((()=>ChatRoomCharacter.filter((e=>Qt(e))))),[n,i]=Ps(0);Ss((()=>(Wt.setState=()=>{},Wt.setMemberNumber=i,()=>{Wt.setState=()=>{},Wt.setMemberNumber=()=>{}})),[]);const s=Zt(n),r=s&&Qt(s),a=r?s.ABCL.Stats.MentalRegression.value:0,o=r?s.ABCL.Stats.Incontinence.value:0,l=r?s.ABCL.Stats.Soiliness.value/An(s):0,c=r?s.ABCL.Stats.Wetness.value/An(s):0,u=r?s.ABCL.Stats.Bowel.value/s.ABCL.Stats.Bowel.size:0,d=r?s.ABCL.Stats.Bladder.value/s.ABCL.Stats.Bladder.size:0;return Ss((()=>{Kt()}),[n]),as("div",{className:"ABCLHidden",id:"ABCLStatsPanel",children:[as("div",{style:{width:"calc(2000px - 330px)",height:"1000px",top:0,left:0,position:"absolute"},onClick:()=>document.getElementById("ABCLStatsPanel")?.classList.add("ABCLHidden")}),as("div",{style:{padding:"15px",width:"300px",height:"1000px",position:"absolute",top:"0px",left:"calc(2000px - 330px)",backgroundColor:"var(--tmd-element,rgb(255, 255, 255))"},children:[as("select",{style:{padding:"10px",borderRadius:"5px",border:"1px solid #ccc",backgroundColor:"#f9f9f9",color:"#333",width:"100%"},onClick:()=>{t(ChatRoomCharacter.filter((e=>Qt(e))))},value:n,onChange:e=>{i(parseInt(e.target.value))},children:e.map((e=>as("option",{value:e.MemberNumber,children:en(e.MemberNumber)},e.MemberNumber)))}),as("div",{style:{padding:"15px 0"},children:[as(Is,{value:o,label:"Incontinence",color:"#eeacacff",foreground:"#cb5b5bff"}),as(Is,{value:a,label:"Mental Regression",color:"#e6bff1ff",foreground:"#ad74beff"}),as(Is,{value:l,label:"Soiliness",color:"#d1aa98ff",foreground:"#ab674aff"}),as(Is,{value:c,label:"Wetness",color:"#f3e1aeff",foreground:"#e7c463ff"}),as(Is,{value:u,label:"Bowel Fullness",color:"#b7795cff",foreground:"#7c4c36ff"}),as(Is,{value:d,label:"Bladder Fullness",color:"#eacd73ff",foreground:"#cba01eff"}),as("button",{onClick:()=>Kt(),children:"Refresh"})]})]})]})}function xs(){return as(Gi,{children:[as(Es,{}),as(ks,{})]})}const Fs=async()=>{ss(as(xs,{}),qt),PreferenceRegisterExtensionSetting({Identifier:"ABCL",ButtonText:`${a} Settings`,Image:"https://zoe-64.github.io/ABCL/versions/beta/assets/abcl.png",run:()=>{DrawButton(1815,75,90,90,"","White","Icons/Exit.png")},click:()=>{MouseIn(1815,75,90,90)&&PreferenceSubscreenExtensionsExit()},exit:()=>(Ht(document.body,"#ABCLSettingsPage").classList.add("ABCLHidden"),Ft(),!0),load:()=>{Ht(document.body,"#ABCLSettingsPage").classList.remove("ABCLHidden"),Kt()}})};Tt.hookFunction("TextLoad",5,((e,t)=>"WetMinigame"===CurrentScreen||"MessMinigame"===CurrentScreen?void 0:t(e)));function Ts(e){var t=e.name;console.log("Registering minigame: "+t),window[t+"Run"]=()=>e.Run(),window[t+"Click"]=()=>e.Click(),window[t+"Load"]=()=>e.Load(),window[t+"Unload"]=()=>e.Unload(),window[t+"Resize"]=()=>e.Resize(),window[t+"KeyDown"]=()=>e.KeyDown(),window[t+"Exit"]=()=>e.Exit(),window[t+"End"]=t=>e.End(t)}class Os{constructor(){this.name=""}Load(){}Unload(){}Resize(){}KeyDown(){}Exit(){}End(e){}}class zs extends Os{constructor(){super(...arguments),this.startText="",this.hintText="",this.failText="",this.successText="",this.tintColor=[{r:0,g:0,b:0,a:0}],this.GameStartTime=0,this.GameEndTime=0,this.StartDelay=4e3,this.AccidentVelocity=0,this.AccidentPosition=0,this.AccidentAcceleration=0,this.AccidentMaxPosition=100,this.AccidentGameDuration=5e3,this.AccidentNextTick=0,this.AccidentText="",this.AccidentChallenge=0,this.BaseGameLength=6e3}End(e){CommonSetScreen("Online","ChatRoom"),MiniGameVictory=e,MiniGameEnded=!0,MiniGameTimer=CommonTime(),this.GameEndTime=MiniGameTimer}get IsStartDelay(){return CommonTime()<this.GameStartTime}Load(){if(DrawFlashScreen("#000000",750,1e3),this.GameStartTime=CommonTime()+this.StartDelay,this.AccidentVelocity=0,this.AccidentAcceleration=0,"number"!=typeof MiniGameDifficulty)MiniGameTimer=CommonTime()+this.BaseGameLength,this.AccidentChallenge=5;else{var e=.25*(MiniGameDifficulty-8);this.AccidentGameDuration=this.BaseGameLength+1e3*e,MiniGameTimer=this.GameStartTime+this.AccidentGameDuration,this.AccidentChallenge=MiniGameDifficulty}this.AccidentMaxPosition=400,this.AccidentPosition=this.AccidentMaxPosition,console.info("Accident minigame started: difficulty - "+this.AccidentChallenge+" time - "+this.AccidentGameDuration),CharacterSetFacialExpression(Player,"Eyes","Daydream",10),this.AccidentChallenge>25?CharacterSetFacialExpression(Player,"Blush","ShortBreath",10):CharacterSetFacialExpression(Player,"Blush","Low",10)}get IsGameActive(){return CommonTime()<MiniGameTimer&&!MiniGameEnded&&!this.GameFailed}get IsGameTimeout(){return CommonTime()>=MiniGameTimer&&!MiniGameEnded}get IsEndGameReport(){return CommonTime()<this.GameEndTime+5e3}get GameFailed(){return this.AccidentPosition<=0}RunGame(e){var t=(this.AccidentGameDuration+CommonTime()-MiniGameTimer)/1e3;CommonTime()>this.AccidentNextTick&&(this.AccidentNextTick=CommonTime()+400,this.AccidentAcceleration=-1.25*this.AccidentChallenge-t*Math.random()),this.AccidentVelocity=Math.min(this.AccidentVelocity,this.AccidentVelocity+.25*this.AccidentAcceleration),this.AccidentPosition>=this.AccidentMaxPosition&&(this.AccidentVelocity=Math.min(0,this.AccidentVelocity)),this.AccidentPosition>0&&(this.AccidentPosition+=this.AccidentVelocity/1e3*e*3.5),this.AccidentPosition=Math.max(0,Math.min(this.AccidentPosition,this.AccidentMaxPosition)),DrawProgressBar(500-this.AccidentMaxPosition,800,2*this.AccidentMaxPosition,50,this.AccidentPosition/this.AccidentMaxPosition*100),DrawText(this.hintText,500,875,"white","black")}Run(){ChatRoomRun(CommonTime()),this.IsStartDelay?DrawText(this.startText,500,500,"white","black"):this.IsGameActive?this.RunGame(TimerRunInterval):!this.IsGameTimeout&&!this.GameFailed||MiniGameEnded||(this.End(this.AccidentPosition>0),MiniGameEnd())}Click(){var e;this.IsGameActive&&(this.AccidentVelocity=Math.max(this.AccidentVelocity+(e=11,Math.floor(Math.random()*e)+5),20))}}class $s extends zs{constructor(){super(...arguments),this.startText="A sudden pressure builds within you...",this.hintText="Click to maintain control. Keep it together!",this.failText="Oops! You've had an accident!",this.successText="Crisis averted! You stayed composed!",this.name="MessMinigame"}End(e){if(super.End(e),e)return cn.stats.Incontinence-=Bn(cn.stats.Incontinence)/2,void zt("You managed to keep it together!");cn.soil(),cn.onAccident()}}class Gs extends zs{constructor(){super(...arguments),this.startText="You feel a trickle starting...",this.hintText="Click to squeeze tight. Don't let it get away!",this.failText="Oh no! You lost control!",this.successText="You held it in! Phew!",this.name="WetMinigame"}End(e){if(super.End(e),e)return cn.stats.Incontinence-=Bn(cn.stats.Incontinence)/2,zt("You managed to hold it in!"),void CharacterSetFacialExpression(Player,"Mouth","Happy",20);CharacterSetFacialExpression(Player,"Blush","Low",10),CharacterSetFacialExpression(Player,"Eyes","Surprised",9),cn.wet(),cn.onAccident()}}window.clearData=()=>{Player.ExtensionSettings.ABCL="N4XyA===",ServerPlayerExtensionSettingsSync("ABCL"),n.warn("cleared data")},window.saveData=Ft,window.mutateData=e=>{Player.ABCL=kt(Player.ABCL||xt,e),Ft()},window.updateDiaperColor=vn,window.noOp=()=>{},window.sendChatLocal=zt,window.averageColor=gn;let Rs,Vs=class{constructor(e){this.hookMng=e,this.workList=[]}run(e,t){let n,i=!1;for(const s of this.workList)if("inject"===s.value)s.work(e,t);else if("next"===s.value)n=t(e),i=!0;else if("override"===s.value)n=s.work(e,t),i=!0;else if("flag"===s.value){if(!s.flag)break;s.once&&(s.flag=!1)}else if("check"===s.value&&!s.work(e,t))break;return i?n:t(e)}next(){return this.workList.push({value:"next"}),this}inject(e){return this.workList.push({value:"inject",work:e}),this}inside(e,{once:t=!1,priority:n=1}={}){const i={value:"flag",flag:!1,once:t};return this.hookMng.hookFunction(e,n,((e,t)=>{i.flag=!0;const n=t(e);return i.flag=!1,n})),this.workList.push(i),this}when(e){return this.workList.push({value:"check",work:e}),this}override(e){return this.workList.push({value:"override",work:e}),this}},js=class{static info(e){Rs?.info(e)}static warn(e){Rs?.warn(e)}static error(e){Rs?.error(e)}},Hs=class{constructor(e=!1){this.done=e,this.list=[]}run(){for(this.done=!0;this.list.length>0;)this.list.shift()()}push(e){this.done?e():this.list.push(e)}};const Ws=new Hs,Us=new Hs,Ys=new Hs,qs=new Hs;function Xs(){return null!=globalThis.Player&&"number"==typeof globalThis.Player.MemberNumber}let Ks;const Zs=new class{get mod(){return Ks}push(e,t){e.push(t)}init(e){Ks=t.registerMod(e),qs.run(),Us.run();const n=()=>Ys.run();Xs()?n():this.mod.hookFunction("LoginResponse",0,((e,t)=>{t(e),Xs()&&n()})),Ws.run()}initWithMod(e){Ks=e,qs.run(),Us.run();const t=()=>Ys.run();Xs()?t():this.mod.hookFunction("LoginResponse",0,((e,n)=>{n(e),Xs()&&t()}))}afterInit(e){this.push(Ws,e)}afterPlayerLogin(e){this.push(Ys,e)}patchFunction(e,t){this.push(qs,(()=>this.mod.patchFunction(e,t)))}invokeOriginal(e,...t){return this.mod?this.mod.callOriginal(e,t):globalThis[e]?.(...t)}hookFunction(e,t,n){this.push(Us,(()=>this.mod.hookFunction(e,t,n)))}progressiveHook(e,t=1){const n=new Vs(this);return this.hookFunction(e,t,((e,t)=>n.run(e,t))),n}hookPlayerFunction(e,t,n){var i;i=()=>this.mod.hookFunction(e,t,n),Xs()?Ys.push(i):i()}globalFunction(e,t){"function"!=typeof t&&js.warn("globalFunction: param is not a function"),null==globalThis[e]?globalThis[e]=t:globalThis[e]!=t&&js.warn(`globalFunction: ${e} is already defined`)}randomGlobalFunction(e,t){const n=e=>e+Math.random().toString(16).substring(2);let i=n(e);for(;null!=globalThis[i];)i=n(e);return globalThis[i]=t,i}setLogger(e){!function(e){Rs=e}(e)}},Js=new Set(["ItemTorso","ItemTorso2"]),Qs={ItemTorso:Js,ItemTorso2:Js},er={},tr={};function nr(e){return(Qs[e]&&Array.from(Qs[e])||[e]).map((e=>ir(e)))}function ir(e){return{name:e,group:AssetGroupGet("Female3DCG",e)}}function sr(e){return er[e]}class rr{static add(e){for(const[t,n]of Object.entries(e))for(const[e,i]of Object.entries(n))nr(t).forEach((({name:t})=>{AssetFemale3DCGExtended[t]||(AssetFemale3DCGExtended[t]={}),AssetFemale3DCGExtended[t][e]||(AssetFemale3DCGExtended[t][e]=i)}))}static get value(){return AssetFemale3DCGExtended}}const ar={};class or{static add(e,t){return 0===Object.keys(ar).length&&AssetFemale3DCG.forEach((e=>{ar[e.Group]||(ar[e.Group]={});for(const t of e.Asset){const n=lr(t);ar[e.Group][n.Name]=n}})),ar[e]||(ar[e]={}),ar[e][t.Name]=t,ar}static get value(){return ar}}function lr(e){return"string"==typeof e?{Name:e}:e}function cr(e){return globalThis[e]}let ur=class e{static _initStorage(){var e,t;cr(this._namespace)||(e=this._namespace,t={},globalThis[e]=t)}static get(e,t){this._initStorage();const n=cr(this._namespace);return e in n||(n[e]=t()),n[e]}static getMayOverride(e,t){this._initStorage();const n=cr(this._namespace);return n[e]=t(n[e]),n[e]}static set(e,t){this._initStorage(),cr(this._namespace)[e]=t}static has(e){return this._initStorage(),e in cr(this._namespace)}static delete(e){this._initStorage();const t=cr(this._namespace);return e in t&&delete t[e]}static setImplementation(t){const n=["get","set","has","delete"];for(const i of n){if("function"!=typeof t[i])throw new Error(`Implementation must provide a '${i}' function`);e[i]=t[i]}}static createNamespace(t){return{get:(n,i)=>e.get(`${t}.${n}`,i),getMayOverride:(n,i)=>e.getMayOverride(`${t}.${n}`,i),set:(n,i)=>e.set(`${t}.${n}`,i),has:n=>e.has(`${t}.${n}`),delete:n=>e.delete(`${t}.${n}`)}}};ur._namespace="__BC_LUZI_GLOBALS__",ur.createNamespace("OnceFlag");const dr=ur.createNamespace("AssetManagerPatchOnce");function pr(){return dr}const hr={},mr={},fr=(e,t)=>mr[e]?.[t];function gr(){return mr}function yr(e){return!!(e&&e.Asset&&fr(e.Asset.Group.Name,e.Asset.Name))}function _r(e,t){const n="TW"!==TranslationLanguage?TranslationLanguage:"CN";let i=e(n);return void 0!==i?i:(i="CN"===n?e("CN"):e("EN")||e("CN"),void 0!==i?i:t)}function br(e,t){return _r((t=>e[t]),t)}function vr(e,t,n){return _r((n=>e[n]?.[t]),n)}function Ar(e){return br(e,e.CN)}function Cr(e,t){return e?e.CN?e:{...e,CN:t}:{CN:t}}function Pr(e,t,n){const i={};for(const[s,r]of Object.entries(n))r[e]?.[t]&&(i[s]=r[e][t]);return i}const Sr={},wr={};class Mr{static setAsset(e,t,n){Object.entries(n).forEach((([n,i])=>{const s=n;Sr[s]||(Sr[s]={}),Sr[s][e]||(Sr[s][e]={}),Sr[s][e][t]=i}))}static setGroup(e,t){Object.entries(t).forEach((([t,n])=>{const i=t;wr[i]||(wr[i]={}),wr[i][e]=n}))}}function Br(e,t){e.Description=t}function Lr(){Object.values(hr).forEach((e=>Br(e,function(e){return vr(wr,e,e.replace(/_.*?Luzi$/,""))}(e.Name)))),Object.values(gr()).map((e=>Object.values(e))).flat().forEach((e=>Br(e,function(e,t){return n=Sr,i=e,s=t,_r((e=>n[e]?.[i]?.[s]),t.replace(/_.*?Luzi$/,""));var n,i,s}(e.Group.Name,e.Name)))),Object.entries(gr()).map((([e,t])=>({group:sr(e),asset:t}))).filter((({group:e})=>!!e)).map((({group:e,asset:t})=>Object.entries(t).map((([t,n])=>({asset:n,fromAsset:AssetGet("Female3DCG",e,t)}))))).flat().filter((({fromAsset:e})=>!!e)).forEach((({asset:e,fromAsset:t})=>Br(e,t.Description)));const e=TextAllScreenCache.get(AssetStringsPath),t=e=>{const t=tr,n=new Set,i=AssetGroup.map((e=>e.Name)).sort(((e,t)=>t.length-e.length));Object.entries(e.cache).forEach((([s,r])=>{if(n.has(s))return;const a=i.find((e=>s.startsWith(e)));if(!a)return;n.add(s);const o=t[a];if(!o)return;const l=s.slice(a.length);o.forEach((t=>{const n=t+l;e.cache[n]||(e.cache[n]=r)}))}))};e&&(e.loaded?t(e):e.rebuildListeners.push((e=>e&&t(e))))}let Dr=!1;const Nr=new Map;let kr;function Ir(e,t,n,i=!1){if(kr?.()?.cache){if(kr().cache[e]&&i)return;kr().cache[e]=br(t,n)}else{if(i&&Nr.has(e))return;Nr.set(e,{desc:t,fallback:n,noOverride:i})}}const Er=e=>t=>Object.entries(e||{CN:{[t]:t}}).map((([e,n])=>[e,n[t]||e])).reduce(((e,[t,n])=>(e[t]=n,e)),{});function xr(e,t,{entries:n,noOverride:i}={}){const s=Er(n);t.Layer?.forEach((({Name:n})=>{n?Ir(`${e}${t.Name}${n}`,s(n),n,!!i):Ir(`${e}${t.Name}`,{CN:t.Name.replace(/_.*?Luzi$/,"")},t.Name,!!i)}))}let Fr;class Tr{static info(e){Fr?.info(e)}static warn(e){Fr?.warn(e)}static error(e){Fr?.error(e)}}let Or=!1;const zr=[];function $r(e){Or?e():zr.push(e)}const Gr={},Rr={};function Vr(e,t){const n=AssetGroupGet("Female3DCG",e);Or&&n?t(n):(Rr[e]||(Rr[e]=[]),Rr[e].push(t))}let jr=!1;const Hr=[];function Wr(e){jr?e():Hr.push(e)}const Ur=new Set;function Yr(e,t,{extendedConfig:n,description:i,dynamicName:s,preimage:r,noMirror:a}={}){!function(e,t){const n=AssetGroupGet("Female3DCG",e);Or&&n?t(n):(Gr[e]||(Gr[e]=[]),Gr[e].push(t))}(e,(e=>{or.add(e.Name,t),n&&rr.add(n)}));const o=e;!function(e,t,n){const i=n=>{const s=t?[ir(e)]:nr(e),r=s.find((({group:e})=>!e));if(r)return Ur.has(r.name)?void console.error(`[AssetManager] Required group "${r.name}" not found`):(Ur.add(r.name),void Vr(r.name,(()=>i(n))));s.forEach((({group:e})=>n(e)))};Or?i(n):Vr(e,(()=>i(n)))}(e,!!a,(e=>{const n=e.Name,a=lr(t),l=AssetResolveCopyConfig.AssetDefinition(a,n,or.value);if(!l)return;const c=Cr(i,l.Name.replace(/_.*?Luzi$/,""));void 0!==gr()[n]?.[a.Name]&&console.warn(`[AssetManager] Asset {${n}:${a.Name}} already existed!`),function(...[e,t,n]){Zs.invokeOriginal("AssetAdd",e,t,n);const i=e.Name,s=t.Name;mr[i]||(mr[i]={});const r=AssetGet("Female3DCG",i,s);return r?(mr[i][s]=r,Promise.resolve(r)):Promise.reject(`Asset ${i}:${s} not found`)}(e,l,rr.value).then((e=>{if(e.DynamicGroupName===e.Group.Name&&(e.DynamicGroupName=s||o),r){const t=AssetGet("Female3DCG",r.Name,l.Name);t&&(e.Description=t.Description,e.DynamicGroupName=t.DynamicGroupName,["ScriptDraw","BeforeDraw","AfterDraw"].filter((e=>t[`Dynamic${e}`])).forEach((e=>function(e,t,n,i){const s=`Assets${t}${n.Name}${i}`,r=`Assets${e}${n.Name}${i}`;globalThis[s]&&(globalThis[r]=globalThis[s])}(n,r.Name,l,e))))}else e.Description=Ar(c),xr(e.DynamicGroupName,l,{noOverride:!0})})),Mr.setAsset(n,l.Name,c)}))}const qr={};function Xr(e,{description:t,dynamicName:n,preimage:i}={}){$r((()=>{const s=Cr(t,e.Group.replace(/_.*?Luzi$/,""));(function(...[e,t]){const n=Zs.invokeOriginal("AssetGroupAdd",e,t);return hr[n.Name]=n,Promise.resolve(n)})("Female3DCG",e).then((t=>{t.Description=Ar(s),n&&(t.DynamicGroupName=n),e.Asset.forEach((t=>{Yr(e.Group,lr(t),{dynamicName:n,preimage:i})}))})),Mr.setGroup(e.Group,s)}))}const Kr=new Set;function Zr(e,t,n){const i=()=>{const s=AssetFemale3DCG.find((e=>e.Group===t)),r=AssetGroupGet("Female3DCG",t),a=AssetFemale3DCGExtended[t];if(!s||!r)return Kr.has(t)?void console.error(`[AssetManager] Group ${t} not found`):(Kr.add(t),void $r(i));var o,l;l=e,Qs[o=t]||(Qs[o]=new Set([o])),Qs[o].add(l),tr[o]||(tr[o]=new Set),tr[o].add(l),er[l]=o;const c=Cr(n,e.replace(/_.*?Luzi$/,""));Xr({...s,Group:e,Default:!1,Random:!1},{description:c,dynamicName:s.DynamicGroupName||s.Group,preimage:r}),AssetFemale3DCGExtended[e]=a};$r(i)}const Jr={};let Qr,ea=!1,ta=!1;function na(e){return globalThis[e]}class ia{static _initStorage(){var e,t;na(this._namespace)||(e=this._namespace,t={},globalThis[e]=t)}static get(e,t){this._initStorage();const n=na(this._namespace);return e in n||(n[e]=t()),n[e]}static getMayOverride(e,t){this._initStorage();const n=na(this._namespace);return n[e]=t(n[e]),n[e]}static set(e,t){this._initStorage(),na(this._namespace)[e]=t}static has(e){return this._initStorage(),e in na(this._namespace)}static delete(e){this._initStorage();const t=na(this._namespace);return e in t&&delete t[e]}static setImplementation(e){const t=["get","set","has","delete"];for(const n of t){if("function"!=typeof e[n])throw new Error(`Implementation must provide a '${n}' function`);ia[n]=e[n]}}static createNamespace(e){return{get:(t,n)=>ia.get(`${e}.${t}`,n),getMayOverride:(t,n)=>ia.getMayOverride(`${e}.${t}`,n),set:(t,n)=>ia.set(`${e}.${t}`,n),has:t=>ia.has(`${e}.${t}`),delete:t=>ia.delete(`${e}.${t}`)}}}function sa(e){return new Promise((t=>setTimeout(t,e)))}ia._namespace="__BC_LUZI_GLOBALS__",ia.createNamespace("OnceFlag");class ra{static get emptyImage(){return"data:img/jpg;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACXBIWXMAAC4jAAAuIwF4pT92AAAA\nG3RFWHRTb2Z0d2FyZQBDZWxzeXMgU3R1ZGlvIFRvb2zBp+F8AAAADUlEQVQI12P4//8/AwAI/AL+\nXJ/P2gAAAABJRU5ErkJggg=="}static assetPreviewIconPath(e){const t="Asset"in e?e.Asset:e;return`${AssetGetPreviewPath(t)}/${t.Name}.png`}static activityPreviewIconPath(e){return`Assets/Female3DCG/Activity/${("Activity"in e?e.Activity:e).Name}.png`}}const aa=new class{constructor(){this.basic={},this.custom={}}addImgMapping(e){this.custom={...this.custom,...e}}setBasicImgMapping(e){this.basic={...e,...this.basic}}mapImgSrc(e){if("string"!=typeof e)return e;if(!e.endsWith(".png"))return e;if(e.startsWith("data:image"))return e;if(e.startsWith("http"))return e;const t=e.startsWith("./")?e.slice(2):e;let n=t;return this.custom[n]&&(n=this.custom[n]),this.basic[n]&&(n=this.basic[n]),n!==t?n:e}mapImg(e,t){let n=e;n.startsWith("data:image")||n.startsWith("http")||(this.custom[n]&&(n=this.custom[n]),this.basic[n]&&(n=this.basic[n]),n!==e&&t(n))}};class oa{constructor(){Zs.patchFunction("GLDrawLoadImage",{"Img.src = url;":'Img.crossOrigin = "Anonymous";\n\t\tImg.src = url;'}),["DrawImageEx","DrawImageResize","GLDrawImage","DrawGetImage"].forEach((e=>{Zs.hookFunction(e,0,((e,t)=>(e[0]=aa.mapImgSrc(e[0]),t(e))))})),(async()=>{await function(e,t=100){return(async()=>{for(;!e();)await sa(t)})()}((()=>void 0!==globalThis.ElementButton)),Zs.hookFunction("ElementButton.CreateForAsset",0,((e,t)=>(aa.mapImg(ra.assetPreviewIconPath(e[1]),(t=>{e[4]={...e[4],image:t}})),t(e)))),Zs.hookFunction("ElementButton.CreateForActivity",0,((e,t)=>{const n=e[1],i=n.Item?ra.assetPreviewIconPath(n.Item.Asset):`Assets/Female3DCG/Activity/${n.Activity.Name}.png`;return aa.mapImg(i,(t=>{e[4]={...e[4],image:t}})),t(e)}));const e=Zs.randomGlobalFunction("mapImage",(e=>aa.mapImgSrc(e)));Zs.patchFunction("ElementButton._ParseIcons",{"src = `./Assets/Female3DCG/ItemMisc/Preview/${icon}.png`":`src = ${e}(\`./Assets/Female3DCG/ItemMisc/Preview/\${icon}.png\`)`})})()}addImgMapping(e){aa.addImgMapping(e)}setBasicImgMapping(e){aa.setBasicImgMapping(e)}}const la=ia.get("ImageMapping",(()=>new oa)),ca=new class{addAsset(e,t,n,i,s=!1){Yr(e,t,{extendedConfig:n&&{[e]:{[t.Name]:n}},description:i,noMirror:s})}addGroupedAssets(e,t,n){for(const[i,s]of Object.entries(e))for(const e of s){const s=i,r=t&&Pr(s,e.Name,t);Yr(s,e,{extendedConfig:n&&n[s]?.[e.Name]&&{[s]:{[e.Name]:n[s][e.Name]}},description:r})}}addGroupedConfig(e){!function(e){e&&rr.add(e)}(e)}modifyAsset(e,t,n){!function(e,t,n){const i=s=>{const r=AssetGet("Female3DCG",s.Name,t);if(r)n(s,r);else{if(qr[e]||(qr[e]=new Set),qr[e].has(t))return void console.error(`[AssetManager] Asset ${e}:${t} not found`);qr[e].add(t),Vr(e,i)}};Vr(e,i)}(e,t,n)}modifyAssetLayers(e,t){!function(e,t){Wr((()=>{Asset.filter(e).forEach((e=>{e.Layer.forEach((n=>t(e,n)))}))}))}(e,t)}modifyGroup(e,t){!function(e,t){Vr(e,(e=>t(e)))}(e,t)}addCustomDialog(e){!function(e){for(const[t,n]of Object.entries(e)){Jr[t]||(Jr[t]={});for(const[e,i]of Object.entries(n))Jr[t][e]=i,e.includes("ItemTorso2")?Jr[t][e.replace("ItemTorso2","ItemTorso")]=i:e.includes("ItemTorso")&&(Jr[t][e.replace("ItemTorso","ItemTorso2")]=i)}}(e)}addImageMapping(e){la.addImgMapping(e)}get imageMapping(){return la}addGroup(e,t){Xr(e,{description:t})}addCopyGroup(e,t,n){Zr(e,t,n)}addLayerNames(e,t,n){xr(e,t,{entries:n})}addLayerNamesByEntry(e,t,n){!function(e,t,n,i=!0){const s=Er(n);new Set(Object.entries(n).map((([e,t])=>Object.keys(t))).flat()).forEach((n=>{Ir(`${e}${t}${n}`,s(n),n,!!i)}))}(e,t,n)}assetIsCustomed(e){return void 0!==gr()[e.Group.Name]?.[e.Name]}afterLoad(e){Wr(e)}init(e){!function(){if(ea)return;ea=!0;const e=e=>vr(Jr,e);Zs.progressiveHook("AssetTextGet").override(((t,n)=>e(t[0])||n(t))),Zs.progressiveHook("ChatRoomPublishCustomAction").inject((t=>{const[n,i,s]=t,r=e(n);r&&s.push({Tag:`MISSING TEXT IN "Interface.csv": ${n}`,Text:r})})).next()}(),function(){if(Dr)return;Dr=!0;const e=TextAllScreenCache.get(AssetStringsPath);e&&e.loaded&&("EN"===TranslationLanguage||"Bloated"!==e.get("Bloated"))?Lr():(Zs.progressiveHook("AssetBuildDescription").next().inject(Lr),Zs.progressiveHook("TranslationAssetProcess").next().inject(Lr)),pr().getMayOverride("ChatRoomPublishAction",(e=>{const t=(e,t,n)=>{for(const[i,s]of[["PrevAsset",t],["NextAsset",n]])yr(s)&&e.text(i,s.Asset.Description)};if(e)return e.decorators.push(t),e;{const e={decorators:[t]},n=Zs.randomGlobalFunction("CustomDialogInject",((t,n,i,s,r)=>{e.decorators.forEach((e=>e(t,s,r)))}));return Zs.patchFunction("ChatRoomPublishAction",{"ChatRoomCharacterItemUpdate(C);":`${n}(dictionary, C, Action, PrevItem, NextItem);\nChatRoomCharacterItemUpdate(C);`}),e}}))}(),pr().getMayOverride("ItemColorLoad",(e=>{if(e)return e.setters.push((e=>{kr=e})),e;{const e={setters:[e=>{kr=e}]},t=Zs.randomGlobalFunction("LayerNameInject",(t=>{e.setters.forEach((e=>e(t)))}));return Zs.patchFunction("ItemColorLoad",{"ItemColorLayerNames = new TextCache":`${t}(()=>ItemColorLayerNames);\nItemColorLayerNames = new TextCache`}),e}})),Zs.progressiveHook("ItemColorLoad",1).next().inject((()=>{const e=kr?.()?.cache;e&&Nr.forEach(((e,t)=>{Ir(t,e.desc,e.fallback,e.noOverride)}))})),function(){let e=!1;Zs.progressiveHook("DialogInventoryBuild").inject((t=>{t[2]||(e=!0)})),Zs.progressiveHook("DialogInventoryAdd").next().inject((t=>{if(!e)return;e=!1;const n=t[1].Asset.Group.Name,i=new Set(DialogInventory.map((e=>e.Asset.Name)));mr[n]&&Object.entries(mr[n]).filter((([e,t])=>!t.NotVisibleOnScreen?.includes("LuziScreen")&&!i.has(e))).forEach((([e,n])=>DialogInventoryAdd(t[0],{Asset:n},!1)))}));const t=(...[e,t])=>{const[n,i,s]=e;return!!fr(s,i)||t(e)};Zs.progressiveHook("InventoryAvailable").inside("CharacterAppearanceValidate").override(t),Zs.progressiveHook("InventoryAvailable").inside("CraftingItemListBuild").override(t),Zs.progressiveHook("InventoryAvailable").inside("WardrobeFastLoad").override(t),Zs.progressiveHook("CraftingValidate").inject((e=>{const t=e[0]?.Item;if(!t)return;const n=CraftingAssets[t]?.[0];n&&function(e,t){const n=fr(e,t);return!!n&&!n.NotVisibleOnScreen?.includes("LuziScreen")}(n.Group.Name,n.Name)&&(e[3]=!1)})),pr().getMayOverride("CraftingInventory",(e=>{const t=e=>Object.values(e).map((e=>Object.values(e))).flat().map((e=>({Asset:e})));if(e){const n=e;return n.providers.push((()=>t(mr))),n}{const e={providers:[]};e.providers.push((()=>t(mr)));const n=Zs.randomGlobalFunction("CraftingInventory",(()=>[...Player.Inventory,...e.providers.map((e=>e())).flat()]));return Zs.patchFunction("CraftingRun",{"for (let Item of Player.Inventory) {":`for (let Item of ${n}()) {`}),e}}))}(),e(),function(e={start:"Start loading",end:"Loading completed, time usage: "}){const t=()=>{Tr.info(e.start);const t=Date.now();for(function(){for(;zr.length>0;)zr.shift()()}(),Or=!0,AssetGroup.forEach((e=>function(e){if(Gr[e.Name])for(;Gr[e.Name].length>0;)Gr[e.Name].shift()(e)}(e))),AssetGroup.forEach((e=>function(e){if(Rr[e.Name])for(;Rr[e.Name].length>0;)Rr[e.Name].shift()(e)}(e))),CraftingAssets=CraftingAssetsPopulate(),jr=!0;Hr.length>0;)Hr.shift()();const n=Date.now();Tr.info(`${e.end} ${n-t}ms`)};AssetGroup.length>50?t():Zs.progressiveHook("AssetLoadAll",1).next().inject((()=>t()))}()}enableValidation(e){!function(e){Qr=e,ta||(ta=!0,Zs.hookFunction("ValidationResolveRemoveDiff",1,((e,t)=>{const[n,i]=e;return!i.fromModUser&&fr(n.Asset.Group.Name,n.Asset.Name)?{item:n,valid:!1}:t(e)})),Zs.hookFunction("ValidationResolveSwapDiff",1,((e,t)=>{const[n,i,s]=e;return!s.fromModUser&&fr(n.Asset.Group.Name,n.Asset.Name)?{item:n,valid:!1}:t(e)})),Zs.hookFunction("ValidationResolveAppearanceDiff",1,((e,t)=>(Qr&&(e[3].fromModUser=Qr(e[3])),t(e)))))}(e)}setLogger(e){!function(e){Fr=e}(e)}typeBodyGroupNames(){return this}},ua={Name:"Untrainers_Pamp",Random:!1,Left:174,Top:434,Priority:20,DefaultColor:["#FFFFFF"],ParentGroup:{},Layer:[{Name:"Base",AllowColorize:!0},{Name:"Patch",AllowColorize:!0},{Name:"Detail_2",AllowColorize:!0},{Name:"Detail_1",AllowColorize:!0},{Name:"Detail_3",AllowColorize:!0},{Name:"Tint",AllowColorize:!0,EditOpacity:!0},{Name:"Indicator",AllowColorize:!0,EditOpacity:!0},{Name:"Tabs",AllowColorize:!0}]},da={CN:"Pampers尿布",EN:"Untrainers Diaper",RU:"Памперсовые диаперы"};const pa={Name:"Temp_Pamp",Random:!1,EditOpacity:!0,Left:160,Top:411,Priority:20,DefaultColor:["#d6efff","#7B7B7B","#8197A7","#4880B9","#B5A95B","#AAA44E"],ParentGroup:{},Fetish:["ABDL"],HideItem:["ItemButtAnalBeads2","ItemVulvaVibratingDildo","ItemVulvaInflatableVibeDildo","ItemVulvaClitSuctionCup","ItemVulvaPiercingsVibeHeartClitPiercing","ItemVulvaPiercingsClitRing"],Layer:[{Name:"Back",AllowColorize:!0,Priority:-1},{Name:"Base",AllowColorize:!0},{Name:"Middle",AllowColorize:!0},{Name:"Tabs",AllowColorize:!0},{Opacity:1,MinOpacity:0,MaxOpacity:1,Name:"Wet",AllowColorize:!0},{Name:"Indicator",AllowColorize:!0}]},ha={EN:"Cutest Diaper",RU:"Самый лучший диапер",CN:"最好的尿布"};const ma={Name:"Highchair",Random:!1,Left:55,Top:320,RemoveTime:15,Priority:40,DefaultColor:["#676285","#848484","#4a468d","#939394"],AllowLock:!0,AllowTighten:!0,Difficulty:8,Fetish:["ABDL"],Effect:[E.Freeze,E.MapImmobile],AllowActivePose:[...PoseAllStanding],Property:{OverrideHeight:{Height:20,Priority:51},Effect:[E.Lifted]},ParentGroup:{},Layer:[{Priority:3,Name:"Chair"},{Priority:50,Name:"Tray"},{Priority:3,Name:"Seat"},{Priority:45,Name:"Split",CopyLayerColor:"Seat"},{Priority:1,Name:"Legs"}]},fa={EN:"Little's Highchair",RU:"Высокое кресло",CN:"小孩子的高椅"};const ga={Name:"Stroller",Random:!1,Left:0,Top:0,Priority:40,DefaultColor:["#676285"],Fetish:["ABDL"],Property:{OverrideHeight:{Height:200,Priority:51},Effect:[E.Lifted]},ParentGroup:{},Layer:[{Priority:3,Name:"Outline"}]},ya={EN:"Stroller (DO NOT USE PLZZZ)",RU:"Стрелка",CN:"婴儿推车"};Zs.initWithMod(Tt),ca.init((()=>{ca.addImageMapping({"Assets/Female3DCG/ItemPelvis/Untrainers_Pamp_Base.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Untrainer_Pamp/Untrainers_Pamp_Base.png","Assets/Female3DCG/ItemPelvis/Untrainers_Pamp_Patch.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Untrainer_Pamp/Untrainers_Pamp_Patch.png","Assets/Female3DCG/ItemPelvis/Untrainers_Pamp_Detail_1.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Untrainer_Pamp/Untrainers_Pamp_Detail_1.png","Assets/Female3DCG/ItemPelvis/Untrainers_Pamp_Detail_2.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Untrainer_Pamp/Untrainers_Pamp_Detail_2.png","Assets/Female3DCG/ItemPelvis/Untrainers_Pamp_Detail_3.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Untrainer_Pamp/Untrainers_Pamp_Detail_3.png","Assets/Female3DCG/ItemPelvis/Untrainers_Pamp_Indicator.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Untrainer_Pamp/Untrainers_Pamp_Indicator.png","Assets/Female3DCG/ItemPelvis/Untrainers_Pamp_Tabs.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Untrainer_Pamp/Untrainers_Pamp_Tabs.png","Assets/Female3DCG/ItemPelvis/Preview/Untrainers_Pamp.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Untrainer_Pamp/Untrainers_Pamp_Preview.png"}),ca.addAsset("ItemPelvis",ua,void 0,da),ca.addImageMapping({"Assets/Female3DCG/ItemPelvis/Temp_Pamp_Base.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Base.png","Assets/Female3DCG/ItemPelvis/Temp_Pamp_Middle.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Middle.png","Assets/Female3DCG/ItemPelvis/Temp_Pamp_Tabs.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Tabs.png","Assets/Female3DCG/ItemPelvis/Temp_Pamp_Indicator.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Indicator.png","Assets/Female3DCG/ItemPelvis/Temp_Pamp_Wet.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Wet.png","Assets/Female3DCG/ItemPelvis/Temp_Pamp_Back.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Back.png","Assets/Female3DCG/ItemPelvis/Preview/Temp_Pamp.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Preview.png"}),ca.addImageMapping({"Assets/Female3DCG/Panties/Temp_Pamp_Base.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Base.png","Assets/Female3DCG/Panties/Temp_Pamp_Middle.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Middle.png","Assets/Female3DCG/Panties/Temp_Pamp_Tabs.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Tabs.png","Assets/Female3DCG/Panties/Temp_Pamp_Indicator.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Indicator.png","Assets/Female3DCG/Panties/Temp_Pamp_Wet.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Wet.png","Assets/Female3DCG/Panties/Temp_Pamp_Back.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Back.png","Assets/Female3DCG/Panties/Preview/Temp_Pamp.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Preview.png"}),ca.addAsset("ItemPelvis",pa,void 0,ha),ca.addAsset("Panties",pa,void 0,ha),ca.addImageMapping({"Assets/Female3DCG/ItemDevices/Highchair_Chair.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/other/highchair/Chair.png","Assets/Female3DCG/ItemDevices/Highchair_Tray.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/other/highchair/Tray.png","Assets/Female3DCG/ItemDevices/Highchair_Seat.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/other/highchair/Seat.png","Assets/Female3DCG/ItemDevices/Highchair_Split.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/other/highchair/Split.png","Assets/Female3DCG/ItemDevices/Highchair_Legs.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/other/highchair/Legs.png","Assets/Female3DCG/ItemDevices/Preview/Highchair.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/other/highchair/Preview.png"}),ca.addAsset("ItemDevices",ma,void 0,fa),ca.addImageMapping({"Assets/Female3DCG/ItemDevices/Stroller_Outline.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/other/stroller/Stroller_Outline.png","Assets/Female3DCG/ItemDevices/Preview/Stroller.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/other/stroller/Stroller_Outline.png"}),ca.addAsset("ItemDevices",ga,void 0,ya)}));const _a=()=>{"ChatRoom"===CurrentScreen&&cn.update()};let ba=!1;const va=async()=>{var e;ba||(ba=!0,(async()=>{const e=LZString.decompressFromBase64(Player.ExtensionSettings.ABCL),t=e?JSON.parse(e):{Settings:{},Stats:{}};if("2.0.0"===t.ModVersion){const e=t.Settings.Metabolism,n=t.Settings.DisableWetting;t.Settings={...Object.fromEntries(Object.entries(t.Settings).filter((([e])=>!["DisableWetting","DisableSoiling","Metabolism","CaregiverIDs"].includes(e))).map((([e,{value:t}])=>[e,t]))),PeeMetabolism:n?"Disabled":e,PoopMetabolism:n?"Disabled":e},t.ModVersion=void 0,t.Version="2.0.1"}const i=kt({Settings:It,Stats:Et,Version:"2.1.0"},t);n.debug({message:"Merged settings object",modStorageObject:i}),Player.ABCL=i})(),Fs(),Tt.hookFunction("DialogMenuMapping.activities.GetClickStatus",1,((e,t)=>{const[n,i,s]=e;return i?t(e):null})),Tt.hookFunction("DialogChangeMode",1,(async(e,t)=>{const[n]=e;if(t(e),"activities"!==n)return;const i=CurrentCharacter?.FocusGroup?CurrentCharacter:Player,s=await $t("#dialog-activity-grid"),r=i.FocusGroup?.Name;if(r)for(const{activity:e}of fi){if(!e)continue;const t=new mi(e.ID,e.Name,e.Image,e.OnClick,e.Target,e.TargetSelf,e.Criteria);t.fitsCriteria(i,r)&&(mi.isInserted(e.ID)||s.appendChild(t.createButton()))}})),CommandCombine(gi),e=[],Tt.hookFunction("TextLoad",5,((t,n)=>{if(!e.some((e=>e.module===CurrentModule&&e.id===CurrentScreen)))return n(t)})),e.forEach((e=>{window[`${e.id}Background`]="Sheet";const{KeyUp:t,Click:n,...i}=e.functions,s={...i,KeyUp:n=>{"Escape"===n.key&&window[`${e.id}Exit`](),t?.(n)},Click:t=>{MouseIn(1815,75,90,90)&&window[`${e.id}Exit`](),n?.(t)}};window[`${e.id}ScreenFunctions`]=s,Object.entries(s).forEach((([t,n])=>{window[`${e.id}${t}`]=n}))})),vi(),Ts(new $s),Ts(new Gs),(()=>{const e=document.createElement("style");e.innerHTML=(()=>{const e=[{className:"SoilinessPercentage",primary:"#d1aa98ff",secondary:"#ab674aff"},{className:"WetnessPercentage",primary:"#f3e1aeff",secondary:"#e7c463ff"},{className:"BowelFullness",primary:"#b7795cff",secondary:"#7c4c36ff"},{className:"BladderFullness",primary:"#eacd73ff",secondary:"#cba01eff"},{className:"Incontinence",primary:"#eeacacff",secondary:"#cb5b5bff"},{className:"MentalRegression",primary:"#e6bff1ff",secondary:"#ad74beff"}];let t="";for(const n of e)t+=`\n  .ABCL${n.className} {\n    margin-bottom: 10px;\n    margin-top: 3px;\n  }\n\t.ABCL${n.className}::part(base) {\n\t\tbackground-color: ${n.primary};\n\t}\n  .ABCL${n.className}::part(indicator) {\n    background-color: ${n.secondary};\n  }`;return`\n#ABCLCurrentPlayerSelect {\n  margin-bottom: 5px;\n}\n\n.ABCLOverlay {\n\taspect-ratio: 2/1;\n\tmax-width: 100%;\n\tmax-height: 100%;\n\tmargin: auto;\n\tposition: relative;\n\ttransform: translateY(-50%);\n\ttop: 50%;\n\tpointer-events: none;\n  font-family: arial;\n  color: var(--tmd-text, --sl-color-neutral-700);\n  order: 100;\n  z-index: 10000;\n}\n.ABCLWindowHeaderTitle {\n  margin: 5px;\n  font-size: 32px;\n  font-weight: bold;\n}\n\n.ABCLOpenStatsButton {\n  position: fixed;\n  bottom: 10px;\n  right: 10px;\n  z-index: 1000;\n  aspect-ratio: 1/1;\n  width: 4%;\n  white-space: collapse;\n  text-align: center;\n  border-radius: 5px;\n  background: #ffffffa6;\n  border: #e3e3e3 1px solid;\n  backdrop-filter: blur(4px);\n  pointer-events: all;\n  font-size: clamp(9px, 1.3vw, 43px);\n  cursor: pointer;\n}\n.ABCLOpenStatsButton:hover {\n  background: #ffffffd1;\n}\n.ABCLWindowClose {\n  aspect-ratio: 1/1;\n  background: transparent;\n  height: 29px;\n  border-radius: 0px 4px 0 0;\n  position: absolute;\n  right: 0px;\n  top: 0px;\n  border: none;\n  border-left: 1px #0000003d solid;\n}\n.ABCLWindowMinimize {\n  aspect-ratio: 1/1;\n  background: transparent;\n  height: 29px;\n  border-radius: 0px 0px 0 0;\n  position: absolute;\n  right: 30px;\n  top: 0px;\n  border: none;\n  border-left: 1px #0000003d solid;\n}\n.ABCLWindowHeader {\n  width: 100%;\n  display: grid;\n  grid-template-columns: 1fr 29px 24px;\n  margin: -6px;\n  padding: 5px;\n  border: 1px #0000003d solid;\n  border-radius: 6px 6px 0 0;\n}\n.ABCLNotification {\n\tbackground-color: white;\n\twidth: fit-content;\n\ttext-align: center;\n\tmargin: auto;\n\tz-index: 10000;\n\tposition: absolute;\n\tbottom: 30px;\n\tleft: 25%;\n\ttransform: translateX(-50%);\n\tborder: 1px solid black;\n\tdisplay: grid;\n\tgrid-template-columns: 30px 1fr;\n\tpadding: 5px;\n\tpointer-events: all;\n}\n\n.ABCLPrompt {\n  background: white;\n  width: fit-content;\n  padding: 6px;\n  border: 1px solid black;\n  text-align: center;\n  position: absolute;\n  top: 50%;\n  left: 25%;\n  transform: translate(-50%, -50%);\n\tpointer-events: all;\n}\n.ABCLButton {\n  border: 1px #020202 solid;\n  padding: 3px;\n  margin: 4px;\n  aspect-ratio: 3/2;\n  width: 38px;\n  cursor: pointer;\n}\n.ABCLPromptYes {\n  background: #5ae85a;\n  color: black;\n}\n.ABCLPromptNo {\n  background: #ff4b4b;\n  color: white;\n}\n\n.ABCLClose:hover {\n  background: #ff4b4b;\n  color: white;\n  cursor: pointer;\n}\n\n.ABCLStatsWindow {\n  width: 200px;\n  height: fit-content;\n  padding: 5px;\n  background: #ffffffa6;\n  border: #e3e3e3 1px solid;\n  pointer-events: all;\n  position: fixed;\n  backdrop-filter: blur(4px);\n  border-radius: 6px;\n  box-shadow: 0 4px 5px 1px #00000014;\n}\n\n.ABCLSettingPage {\n  width: 81%;\n  margin: 6% auto;\n  pointer-events: all;\n}\n\n\n\n#ABCLSettingsPage *, #ABCLStatsPanel * {\n  pointer-events: all;\n}\n\n\n\n.ABCLMessageVisibility {\n  margin-top: 1em\n}\n\n${t}\n\n.ABCLHidden {\n  display: none !important;\n}\n\n\n/* sorry fusam */\n#fusam-addon-manager-container {\n  position: absolute;\n  top: 0;\n}\n`})(),document.head.appendChild(e),document.body.appendChild(qt),$t("#chat-room-div",{childCheck:!0,timeout:1e22}).then((()=>{$t(".ABCLOverlay",{timeout:1e22}).then((()=>{document.removeChild(qt),setTimeout((()=>{document.appendChild(qt)}),1e3)}))}))})(),window.ABCL={inModSubscreen:()=>Boolean(qt.querySelector(".ABCLSettingPage")?.classList.contains("ABCLHidden")),isABCLPlayer:Qt,sendDataToAction:yi,sendUpdateMyData:_i,sendRequestOtherDataPacket:bi},setInterval(_a,6e4),n.info("Ready."))};null==CurrentScreen||"Login"===CurrentScreen?Tt.hookFunction("LoginResponse",Ot.OBSERVE,((e,t)=>{t(e);const n=e[0];if("InvalidNamePassword"===n)return;const{Name:i,AccountName:s}=n;"string"==typeof i&&"string"==typeof s&&va()})):va()}();
//# sourceMappingURL=abcl.js.map
