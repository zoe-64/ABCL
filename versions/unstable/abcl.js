!function(){"use strict";var e={};!function(e){!function(){const t="1.2.0";function s(e){alert("Mod ERROR:\n"+e);const t=new Error(e);throw console.error(t),t}const n=new TextEncoder;function i(e){return!!e&&"object"==typeof e&&!Array.isArray(e)}function r(e){const t=new Set;return e.filter((e=>!t.has(e)&&t.add(e)))}const a=new Map,o=new Set;function l(e){o.has(e)||(o.add(e),console.warn(e))}function c(e){const t=[],s=new Map,n=new Set;for(const i of p.values()){const r=i.patching.get(e.name);if(r){t.push(...r.hooks);for(const[t,a]of r.patches.entries())s.has(t)&&s.get(t)!==a&&l(`ModSDK: Mod '${i.name}' is patching function ${e.name} with same pattern that is already applied by different mod, but with different pattern:\nPattern:\n${t}\nPatch1:\n${s.get(t)||""}\nPatch2:\n${a}`),s.set(t,a),n.add(i.name)}}t.sort(((e,t)=>t.priority-e.priority));const i=function(e,t){if(0===t.size)return e;let s=e.toString().replaceAll("\r\n","\n");for(const[n,i]of t.entries())s.includes(n)||l(`ModSDK: Patching ${e.name}: Patch ${n} not applied`),s=s.replaceAll(n,i);return(0,eval)(`(${s})`)}(e.original,s);let r=function(t){var s,r;const a=null===(r=(s=y.errorReporterHooks).hookChainExit)||void 0===r?void 0:r.call(s,e.name,n),o=i.apply(this,t);return null==a||a(),o};for(let s=t.length-1;s>=0;s--){const n=t[s],i=r;r=function(t){var s,r;const a=null===(r=(s=y.errorReporterHooks).hookEnter)||void 0===r?void 0:r.call(s,e.name,n.mod),o=n.hook.apply(this,[t,e=>{if(1!==arguments.length||!Array.isArray(t))throw new Error(`Mod ${n.mod} failed to call next hook: Expected args to be array, got ${typeof e}`);return i.call(this,e)}]);return null==a||a(),o}}return{hooks:t,patches:s,patchesSources:n,enter:r,final:i}}function u(e,t=!1){let s=a.get(e);if(s)t&&(s.precomputed=c(s));else{let t=window;const r=e.split(".");for(let s=0;s<r.length-1;s++)if(t=t[r[s]],!i(t))throw new Error(`ModSDK: Function ${e} to be patched not found; ${r.slice(0,s+1).join(".")} is not object`);const o=t[r[r.length-1]];if("function"!=typeof o)throw new Error(`ModSDK: Function ${e} to be patched not found`);const l=function(e){let t=-1;for(const s of n.encode(e)){let e=255&(t^s);for(let t=0;t<8;t++)e=1&e?-306674912^e>>>1:e>>>1;t=t>>>8^e}return(~t>>>0).toString(16).padStart(8,"0").toUpperCase()}(o.toString().replaceAll("\r\n","\n")),u={name:e,original:o,originalHash:l};s=Object.assign(Object.assign({},u),{precomputed:c(u),router:()=>{},context:t,contextProperty:r[r.length-1]}),s.router=function(e){return function(...t){return e.precomputed.enter.apply(this,[t])}}(s),a.set(e,s),t[s.contextProperty]=s.router}return s}function d(){for(const e of a.values())e.precomputed=c(e)}function h(){const e=new Map;for(const[t,s]of a)e.set(t,{name:t,original:s.original,originalHash:s.originalHash,sdkEntrypoint:s.router,currentEntrypoint:s.context[s.contextProperty],hookedByMods:r(s.precomputed.hooks.map((e=>e.mod))),patchedByMods:Array.from(s.precomputed.patchesSources)});return e}const p=new Map;function m(e){p.get(e.name)!==e&&s(`Failed to unload mod '${e.name}': Not registered`),p.delete(e.name),e.loaded=!1,d()}function g(e,t){e&&"object"==typeof e||s("Failed to register mod: Expected info object, got "+typeof e),"string"==typeof e.name&&e.name||s("Failed to register mod: Expected name to be non-empty string, got "+typeof e.name);let n=`'${e.name}'`;"string"==typeof e.fullName&&e.fullName||s(`Failed to register mod ${n}: Expected fullName to be non-empty string, got ${typeof e.fullName}`),n=`'${e.fullName} (${e.name})'`,"string"!=typeof e.version&&s(`Failed to register mod ${n}: Expected version to be string, got ${typeof e.version}`),e.repository||(e.repository=void 0),void 0!==e.repository&&"string"!=typeof e.repository&&s(`Failed to register mod ${n}: Expected repository to be undefined or string, got ${typeof e.version}`),null==t&&(t={}),t&&"object"==typeof t||s(`Failed to register mod ${n}: Expected options to be undefined or object, got ${typeof t}`);const r=!0===t.allowReplace,a=p.get(e.name);a&&(a.allowReplace&&r||s(`Refusing to load mod ${n}: it is already loaded and doesn't allow being replaced.\nWas the mod loaded multiple times?`),m(a));const o=e=>{let t=h.patching.get(e.name);return t||(t={hooks:[],patches:new Map},h.patching.set(e.name,t)),t},l=(e,t)=>(...i)=>{var r,a;const o=null===(a=(r=y.errorReporterHooks).apiEndpointEnter)||void 0===a?void 0:a.call(r,e,h.name);h.loaded||s(`Mod ${n} attempted to call SDK function after being unloaded`);const l=t(...i);return null==o||o(),l},c={unload:l("unload",(()=>m(h))),hookFunction:l("hookFunction",((e,t,i)=>{"string"==typeof e&&e||s(`Mod ${n} failed to patch a function: Expected function name string, got ${typeof e}`);const r=u(e),a=o(r);"number"!=typeof t&&s(`Mod ${n} failed to hook function '${e}': Expected priority number, got ${typeof t}`),"function"!=typeof i&&s(`Mod ${n} failed to hook function '${e}': Expected hook function, got ${typeof i}`);const l={mod:h.name,priority:t,hook:i};return a.hooks.push(l),d(),()=>{const e=a.hooks.indexOf(l);e>=0&&(a.hooks.splice(e,1),d())}})),patchFunction:l("patchFunction",((e,t)=>{"string"==typeof e&&e||s(`Mod ${n} failed to patch a function: Expected function name string, got ${typeof e}`);const r=u(e),a=o(r);i(t)||s(`Mod ${n} failed to patch function '${e}': Expected patches object, got ${typeof t}`);for(const[i,r]of Object.entries(t))"string"==typeof r?a.patches.set(i,r):null===r?a.patches.delete(i):s(`Mod ${n} failed to patch function '${e}': Invalid format of patch '${i}'`);d()})),removePatches:l("removePatches",(e=>{"string"==typeof e&&e||s(`Mod ${n} failed to patch a function: Expected function name string, got ${typeof e}`);const t=u(e);o(t).patches.clear(),d()})),callOriginal:l("callOriginal",((e,t,i)=>{"string"==typeof e&&e||s(`Mod ${n} failed to call a function: Expected function name string, got ${typeof e}`);const r=u(e);return Array.isArray(t)||s(`Mod ${n} failed to call a function: Expected args array, got ${typeof t}`),r.original.apply(null!=i?i:globalThis,t)})),getOriginalHash:l("getOriginalHash",(e=>("string"==typeof e&&e||s(`Mod ${n} failed to get hash: Expected function name string, got ${typeof e}`),u(e).originalHash)))},h={name:e.name,fullName:e.fullName,version:e.version,repository:e.repository,allowReplace:r,api:c,loaded:!0,patching:new Map};return p.set(e.name,h),Object.freeze(c)}function f(){const e=[];for(const t of p.values())e.push({name:t.name,fullName:t.fullName,version:t.version,repository:t.repository});return e}let y;const b=void 0===window.bcModSdk?window.bcModSdk=function(){const e={version:t,apiVersion:1,registerMod:g,getModsInfo:f,getPatchingInfo:h,errorReporterHooks:Object.seal({apiEndpointEnter:null,hookEnter:null,hookChainExit:null})};return y=e,Object.freeze(e)}():(i(window.bcModSdk)||s("Failed to init Mod SDK: Name already in use"),1!==window.bcModSdk.apiVersion&&s(`Failed to init Mod SDK: Different version already loaded ('1.2.0' vs '${window.bcModSdk.version}')`),window.bcModSdk.version!==t&&alert(`Mod SDK warning: Loading different but compatible versions ('1.2.0' vs '${window.bcModSdk.version}')\nOne of mods you are using is using an old version of SDK. It will work for now but please inform author to update`),window.bcModSdk);Object.defineProperty(e,"__esModule",{value:!0}),e.default=b}()}(e);var t=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(e);const s=new class{constructor(){this.logsArray=[],this.maxLogSize=100}log(e,t,s){const n={message:t,level:e,version:"2.1.0",timestamp:(new Date).toISOString()};s("%cABCL:","font-weight: bold; color: #f6cbde;",n),this.logsArray.push(n),this.logsArray.length>this.maxLogSize&&this.logsArray.shift()}info(e){this.log("INFO",e,console.log)}debug(e){this.log("DEBUG",e,console.debug)}warn(e){this.log("WARN",e,console.warn)}error(e){this.log("ERROR",e,console.error)}getLogs(){return this.logsArray}};const n={ItemDefinitions:{BabyItems:["Bows Dress","Babydoll Dress","Puffy Dress","Shiny dress","Summmer flower dress","Adult Baby Harness","Tutu","Frilled Bikni","Padded Mittens","Paw Mittens","Short Smooth Leather Mittens","Changing Table","Crib","Fox Plush","Bunny Plush","Shark Plush","Little's Highchair"],Pants:["Long Leggings","Short Leggings","Business Trousers","Latex Pants","Long Latex Pants","Ripped Jeans","Jeans","Pajama"]},DiaperColors:{clean:"#8F8F8F",middlewet:"#ffe58b",maximumwet:"#ffd33e",middlemess:"#423019",maximummess:"#3C302C",selfwet:"#242103",selfmess:"#1f170d",indicatorAccident:"#1e47a6"},DiaperSizeScale:{none:0,small:300,regular:500,overnight:800,light_adult:900,moderate_adult:1500,heavy_adult:2500,specialized:3500},Diapers:{"Patterned Diaper":{color:[0],size:"overnight"},"Bulky Diaper":{color:[0,1],size:"light_adult"},"Bulky Chastity Diaper":{color:[1,0],size:"moderate_adult"},"Poofy Diaper":{color:[1,0],size:"light_adult"},"Poofy Chastity Diaper 1":{color:[1,0],size:"heavy_adult"},"Poofy Chastity Diaper":{color:[1,0],size:"moderate_adult"},"Plastic Covered Diaper":{color:[0],size:"light_adult"},"Satin Covered Diaper":{color:[0],size:"light_adult"},Diaper:{size:"regular"},"Diaper Harness":{size:"none"},"Untrainers Diaper":{size:"overnight",gradients:[1],indicator:[6]},"Cutest Diaper":{size:"light_adult",gradients:[4],indicator:[5]}}},i={Tickle:{wetting:.05,messing:.01},TickleItem:{wetting:.08,messing:.01},Spank:{wetting:.12,messing:.15},ShockItem:{wetting:.15,messing:.2},Kick:{wetting:.05,messing:.05},Rub:{wetting:.01},SpankItem:{wetting:.15,messing:.2},Slap:{wetting:.03,messing:.04},Grope:{wetting:.06,messing:.05}},r="2.1.0",a="ABCL",o="ABCL",l="Normal",c="Deny",u="Ask",d="Allow",h={Disabled:0,Slow:.5,Normal:1,Fast:1.5,Faster:2,Fastest:3};var p;!function(e){e[e.Anyone=0]="Anyone",e[e.ItemPermission=1]="ItemPermission",e[e.Friends=2]="Friends",e[e.Lovers=3]="Lovers",e[e.Owner=5]="Owner",e[e.Self=6]="Self"}(p||(p={}));var m="object"==typeof global&&global&&global.Object===Object&&global,g="object"==typeof self&&self&&self.Object===Object&&self,f=m||g||Function("return this")(),y=f.Symbol,b=Object.prototype,_=b.hasOwnProperty,v=b.toString,A=y?y.toStringTag:void 0;var C=Object.prototype.toString;var P="[object Null]",S="[object Undefined]",M=y?y.toStringTag:void 0;function w(e){return null==e?void 0===e?S:P:M&&M in Object(e)?function(e){var t=_.call(e,A),s=e[A];try{e[A]=void 0;var n=!0}catch(e){}var i=v.call(e);return n&&(t?e[A]=s:delete e[A]),i}(e):function(e){return C.call(e)}(e)}function B(e){return null!=e&&"object"==typeof e}var L="[object Symbol]";var k=Array.isArray,N=/\s/;var D=/^\s+/;function I(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&N.test(e.charAt(t)););return t}(e)+1).replace(D,""):e}function F(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var T=NaN,O=/^[-+]0x[0-9a-f]+$/i,x=/^0b[01]+$/i,R=/^0o[0-7]+$/i,z=parseInt;function $(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||B(e)&&w(e)==L}(e))return T;if(F(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=F(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=I(e);var s=x.test(e);return s||R.test(e)?z(e.slice(2),s?2:8):O.test(e)?T:+e}function G(e){return e}var V="[object AsyncFunction]",j="[object Function]",H="[object GeneratorFunction]",U="[object Proxy]";function W(e){if(!F(e))return!1;var t=w(e);return t==j||t==H||t==V||t==U}var q,Y=f["__core-js_shared__"],X=(q=/[^.]+$/.exec(Y&&Y.keys&&Y.keys.IE_PROTO||""))?"Symbol(src)_1."+q:"";var K=Function.prototype.toString;var Z=/^\[object .+?Constructor\]$/,J=Function.prototype,Q=Object.prototype,ee=J.toString,te=Q.hasOwnProperty,se=RegExp("^"+ee.call(te).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ne(e){return!(!F(e)||(t=e,X&&X in t))&&(W(e)?se:Z).test(function(e){if(null!=e){try{return K.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}function ie(e,t){var s=function(e,t){return null==e?void 0:e[t]}(e,t);return ne(s)?s:void 0}var re=Object.create,ae=function(){function e(){}return function(t){if(!F(t))return{};if(re)return re(t);e.prototype=t;var s=new e;return e.prototype=void 0,s}}();var oe=Date.now;var le,ce,ue,de=function(){try{var e=ie(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),he=de?function(e,t){return de(e,"toString",{configurable:!0,enumerable:!1,value:(s=t,function(){return s}),writable:!0});var s}:G,pe=(le=he,ce=0,ue=0,function(){var e=oe(),t=16-(e-ue);if(ue=e,t>0){if(++ce>=800)return arguments[0]}else ce=0;return le.apply(void 0,arguments)}),me=9007199254740991,ge=/^(?:0|[1-9]\d*)$/;function fe(e,t){var s=typeof e;return!!(t=null==t?me:t)&&("number"==s||"symbol"!=s&&ge.test(e))&&e>-1&&e%1==0&&e<t}function ye(e,t,s){"__proto__"==t&&de?de(e,t,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[t]=s}function be(e,t){return e===t||e!=e&&t!=t}var _e=Object.prototype.hasOwnProperty;function ve(e,t,s){var n=e[t];_e.call(e,t)&&be(n,s)&&(void 0!==s||t in e)||ye(e,t,s)}var Ae=Math.max;function Ce(e,t){return pe(function(e,t,s){return t=Ae(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,r=Ae(n.length-t,0),a=Array(r);++i<r;)a[i]=n[t+i];i=-1;for(var o=Array(t+1);++i<t;)o[i]=n[i];return o[t]=s(a),function(e,t,s){switch(s.length){case 0:return e.call(t);case 1:return e.call(t,s[0]);case 2:return e.call(t,s[0],s[1]);case 3:return e.call(t,s[0],s[1],s[2])}return e.apply(t,s)}(e,this,o)}}(e,t,G),e+"")}var Pe=9007199254740991;function Se(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Pe}function Me(e){return null!=e&&Se(e.length)&&!W(e)}var we=Object.prototype;function Be(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||we)}function Le(e){return B(e)&&"[object Arguments]"==w(e)}var ke=Object.prototype,Ne=ke.hasOwnProperty,De=ke.propertyIsEnumerable,Ie=Le(function(){return arguments}())?Le:function(e){return B(e)&&Ne.call(e,"callee")&&!De.call(e,"callee")},Ee=Ie;var Fe="object"==typeof exports&&exports&&!exports.nodeType&&exports,Te=Fe&&"object"==typeof module&&module&&!module.nodeType&&module,Oe=Te&&Te.exports===Fe?f.Buffer:void 0,xe=(Oe?Oe.isBuffer:void 0)||function(){return!1},Re={};Re["[object Float32Array]"]=Re["[object Float64Array]"]=Re["[object Int8Array]"]=Re["[object Int16Array]"]=Re["[object Int32Array]"]=Re["[object Uint8Array]"]=Re["[object Uint8ClampedArray]"]=Re["[object Uint16Array]"]=Re["[object Uint32Array]"]=!0,Re["[object Arguments]"]=Re["[object Array]"]=Re["[object ArrayBuffer]"]=Re["[object Boolean]"]=Re["[object DataView]"]=Re["[object Date]"]=Re["[object Error]"]=Re["[object Function]"]=Re["[object Map]"]=Re["[object Number]"]=Re["[object Object]"]=Re["[object RegExp]"]=Re["[object Set]"]=Re["[object String]"]=Re["[object WeakMap]"]=!1;var ze="object"==typeof exports&&exports&&!exports.nodeType&&exports,$e=ze&&"object"==typeof module&&module&&!module.nodeType&&module,Ge=$e&&$e.exports===ze&&m.process,Ve=function(){try{var e=$e&&$e.require&&$e.require("util").types;return e||Ge&&Ge.binding&&Ge.binding("util")}catch(e){}}(),je=Ve&&Ve.isTypedArray,He=je?function(e){return function(t){return e(t)}}(je):function(e){return B(e)&&Se(e.length)&&!!Re[w(e)]},Ue=Object.prototype.hasOwnProperty;function We(e,t){var s=k(e),n=!s&&Ee(e),i=!s&&!n&&xe(e),r=!s&&!n&&!i&&He(e),a=s||n||i||r,o=a?function(e,t){for(var s=-1,n=Array(e);++s<e;)n[s]=t(s);return n}(e.length,String):[],l=o.length;for(var c in e)!t&&!Ue.call(e,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||r&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||fe(c,l))||o.push(c);return o}var qe=Object.prototype.hasOwnProperty;function Ye(e){if(!F(e))return function(e){var t=[];if(null!=e)for(var s in Object(e))t.push(s);return t}(e);var t=Be(e),s=[];for(var n in e)("constructor"!=n||!t&&qe.call(e,n))&&s.push(n);return s}function Xe(e){return Me(e)?We(e,!0):Ye(e)}var Ke=ie(Object,"create");var Ze=Object.prototype.hasOwnProperty;var Je=Object.prototype.hasOwnProperty;function Qe(e){var t=-1,s=null==e?0:e.length;for(this.clear();++t<s;){var n=e[t];this.set(n[0],n[1])}}function et(e,t){for(var s=e.length;s--;)if(be(e[s][0],t))return s;return-1}Qe.prototype.clear=function(){this.__data__=Ke?Ke(null):{},this.size=0},Qe.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Qe.prototype.get=function(e){var t=this.__data__;if(Ke){var s=t[e];return"__lodash_hash_undefined__"===s?void 0:s}return Ze.call(t,e)?t[e]:void 0},Qe.prototype.has=function(e){var t=this.__data__;return Ke?void 0!==t[e]:Je.call(t,e)},Qe.prototype.set=function(e,t){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=Ke&&void 0===t?"__lodash_hash_undefined__":t,this};var tt=Array.prototype.splice;function st(e){var t=-1,s=null==e?0:e.length;for(this.clear();++t<s;){var n=e[t];this.set(n[0],n[1])}}st.prototype.clear=function(){this.__data__=[],this.size=0},st.prototype.delete=function(e){var t=this.__data__,s=et(t,e);return!(s<0)&&(s==t.length-1?t.pop():tt.call(t,s,1),--this.size,!0)},st.prototype.get=function(e){var t=this.__data__,s=et(t,e);return s<0?void 0:t[s][1]},st.prototype.has=function(e){return et(this.__data__,e)>-1},st.prototype.set=function(e,t){var s=this.__data__,n=et(s,e);return n<0?(++this.size,s.push([e,t])):s[n][1]=t,this};var nt=ie(f,"Map");function it(e,t){var s,n,i=e.__data__;return("string"==(n=typeof(s=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==s:null===s)?i["string"==typeof t?"string":"hash"]:i.map}function rt(e){var t=-1,s=null==e?0:e.length;for(this.clear();++t<s;){var n=e[t];this.set(n[0],n[1])}}rt.prototype.clear=function(){this.size=0,this.__data__={hash:new Qe,map:new(nt||st),string:new Qe}},rt.prototype.delete=function(e){var t=it(this,e).delete(e);return this.size-=t?1:0,t},rt.prototype.get=function(e){return it(this,e).get(e)},rt.prototype.has=function(e){return it(this,e).has(e)},rt.prototype.set=function(e,t){var s=it(this,e),n=s.size;return s.set(e,t),this.size+=s.size==n?0:1,this};var at=function(e,t){return function(s){return e(t(s))}}(Object.getPrototypeOf,Object),ot="[object Object]",lt=Function.prototype,ct=Object.prototype,ut=lt.toString,dt=ct.hasOwnProperty,ht=ut.call(Object);function pt(e){var t=this.__data__=new st(e);this.size=t.size}pt.prototype.clear=function(){this.__data__=new st,this.size=0},pt.prototype.delete=function(e){var t=this.__data__,s=t.delete(e);return this.size=t.size,s},pt.prototype.get=function(e){return this.__data__.get(e)},pt.prototype.has=function(e){return this.__data__.has(e)},pt.prototype.set=function(e,t){var s=this.__data__;if(s instanceof st){var n=s.__data__;if(!nt||n.length<199)return n.push([e,t]),this.size=++s.size,this;s=this.__data__=new rt(n)}return s.set(e,t),this.size=s.size,this};var mt="object"==typeof exports&&exports&&!exports.nodeType&&exports,gt=mt&&"object"==typeof module&&module&&!module.nodeType&&module,ft=gt&&gt.exports===mt?f.Buffer:void 0,yt=ft?ft.allocUnsafe:void 0;var bt=f.Uint8Array;function _t(e,t){var s,n,i=t?(s=e.buffer,n=new s.constructor(s.byteLength),new bt(n).set(new bt(s)),n):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}var vt,At=function(e,t,s){for(var n=-1,i=Object(e),r=s(e),a=r.length;a--;){var o=r[vt?a:++n];if(!1===t(i[o],o,i))break}return e},Ct=function(){return f.Date.now()},Pt=Math.max,St=Math.min;function Mt(e,t,s){(void 0!==s&&!be(e[t],s)||void 0===s&&!(t in e))&&ye(e,t,s)}function wt(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function Bt(e){return function(e,t,s,n){var i=!s;s||(s={});for(var r=-1,a=t.length;++r<a;){var o=t[r],l=n?n(s[o],e[o],o,s,e):void 0;void 0===l&&(l=e[o]),i?ye(s,o,l):ve(s,o,l)}return s}(e,Xe(e))}function Lt(e,t,s,n,i,r,a){var o=wt(e,s),l=wt(t,s),c=a.get(l);if(c)Mt(e,s,c);else{var u,d=r?r(o,l,s+"",e,t,a):void 0,h=void 0===d;if(h){var p=k(l),m=!p&&xe(l),g=!p&&!m&&He(l);d=l,p||m||g?k(o)?d=o:B(u=o)&&Me(u)?d=function(e,t){var s=-1,n=e.length;for(t||(t=Array(n));++s<n;)t[s]=e[s];return t}(o):m?(h=!1,d=function(e,t){if(t)return e.slice();var s=e.length,n=yt?yt(s):new e.constructor(s);return e.copy(n),n}(l,!0)):g?(h=!1,d=_t(l,!0)):d=[]:function(e){if(!B(e)||w(e)!=ot)return!1;var t=at(e);if(null===t)return!0;var s=dt.call(t,"constructor")&&t.constructor;return"function"==typeof s&&s instanceof s&&ut.call(s)==ht}(l)||Ee(l)?(d=o,Ee(o)?d=Bt(o):F(o)&&!W(o)||(d=function(e){return"function"!=typeof e.constructor||Be(e)?{}:ae(at(e))}(l))):h=!1}h&&(a.set(l,d),i(d,l,n,r,a),a.delete(l)),Mt(e,s,d)}}function kt(e,t,s,n,i){e!==t&&At(t,(function(r,a){if(i||(i=new pt),F(r))Lt(e,t,a,s,kt,n,i);else{var o=n?n(wt(e,a),r,a+"",e,t,i):void 0;void 0===o&&(o=r),Mt(e,a,o)}}),Xe)}var Nt,Dt=(Nt=function(e,t,s){kt(e,t,s)},Ce((function(e,t){var s=-1,n=t.length,i=n>1?t[n-1]:void 0,r=n>2?t[2]:void 0;for(i=Nt.length>3&&"function"==typeof i?(n--,i):void 0,r&&function(e,t,s){if(!F(s))return!1;var n=typeof t;return!!("number"==n?Me(s)&&fe(t,s.length):"string"==n&&t in s)&&be(s[t],e)}(t[0],t[1],r)&&(i=n<3?void 0:i,n=1),e=Object(e);++s<n;){var a=t[s];a&&Nt(e,a,s,i)}return e})));const It={PauseStats:!1,PeeMetabolism:l,PoopMetabolism:l,MentalRegressionModifier:l,OpenRemoteSettings:!1,LockedOutOfSettings:!1,DisableWettingLeaks:!1,DisableSoilingLeaks:!0,OnDiaperChange:u,VisibleMessages:{changeDiaper:!0,checkDiaper:!0,lickPuddle:!0,wetDiaper:!0,wetClothing:!0,soilDiaper:!0,soilClothing:!0,usePotty:!0,useToilet:!0,wipePuddle:!0,statusMessages:!1,playerActivity:!0,pauseStats:!1},StatusMessages:{Bladder:!0,Bowel:!0,Soiliness:!0,Wetness:!0,MentalRegression:!0,Incontinence:!0,PuddleSize:!0},DisableClothingStains:!1,DisableDiaperStains:!1,AccidentsByActivities:!0},Et={PuddleSize:{value:0},Bladder:{value:0,size:300},Bowel:{value:0,size:200},Soiliness:{value:0},Wetness:{value:0},WaterIntake:{value:15},FoodIntake:{value:200/60},Incontinence:{value:0},MentalRegression:{value:0}},Ft={Settings:It,Stats:Et},Tt=function(e,t,s){var n,i,r,a,o,l,c=0,u=!1,d=!1,h=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function p(t){var s=n,r=i;return n=i=void 0,c=t,a=e.apply(r,s)}function m(e){var s=e-l;return void 0===l||s>=t||s<0||d&&e-c>=r}function g(){var e=Ct();if(m(e))return f(e);o=setTimeout(g,function(e){var s=t-(e-l);return d?St(s,r-(e-c)):s}(e))}function f(e){return o=void 0,h&&n?p(e):(n=i=void 0,a)}function y(){var e=Ct(),s=m(e);if(n=arguments,i=this,l=e,s){if(void 0===o)return function(e){return c=e,o=setTimeout(g,t),u?p(e):a}(l);if(d)return clearTimeout(o),o=setTimeout(g,t),p(l)}return void 0===o&&(o=setTimeout(g,t)),a}return t=$(t)||0,F(s)&&(u=!!s.leading,r=(d="maxWait"in s)?Pt($(s.maxWait)||0,t):r,h="trailing"in s?!!s.trailing:h),y.cancel=function(){void 0!==o&&clearTimeout(o),c=0,n=l=i=o=void 0},y.flush=function(){return void 0===o?a:f(Ct())},y}((()=>{const e=LZString.compressToBase64(JSON.stringify(Player.ABCL));Player.ExtensionSettings.ABCL=e,ServerPlayerExtensionSettingsSync("ABCL"),vn()}),1e3),Ot=t.registerMod({name:a,fullName:a,version:r,repository:"https://github.com/zoe-64/ABCL"});var xt;!function(e){e[e.OBSERVE=0]="OBSERVE",e[e.ADD_BEHAVIOR=1]="ADD_BEHAVIOR",e[e.MODIFY_BEHAVIOR=5]="MODIFY_BEHAVIOR",e[e.OVERRIDE_BEHAVIOR=10]="OVERRIDE_BEHAVIOR",e[e.TOP=100]="TOP"}(xt||(xt={}));const Rt=(e,t=[],s,n=!0)=>{if(!ServerPlayerIsInChatRoom())return;const i=document.createElement("div");i.innerHTML=(n?"(local) ":"")+e.split("\n").map((e=>e.trim())).join("<br/>"),i.classList.add("ABCLLocalMessage","ChatMessage",...t),s&&(i.style.cssText=s),document.querySelector("#TextAreaChatLog")?.appendChild(i),ElementScrollToEnd("TextAreaChatLog")};const zt=async(e,t={})=>new Promise(((s,n)=>{const i=document.querySelector(e);if(i)return void s(i);const r=new MutationObserver((()=>{const n=document.querySelector(e);n&&(!t.childCheck||n.childElementCount>0)&&(r.disconnect(),clearTimeout(a),s(n))}));r.observe(document.body,{childList:!0,subtree:!0});const a=setTimeout((()=>{r.disconnect(),console.warn(`Element with selector "${e}" not found within timeout`)}),t.timeout||1e4)})),$t=e=>`${e=e||"ABCL"}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;class Gt{constructor(e){this.lastCallTime=0,this.allowedCallInterval=e}check(){return Date.now()-this.lastCallTime>this.allowedCallInterval&&(this.lastCallTime=Date.now(),!0)}reset(){this.lastCallTime=0}isReady(){return Date.now()-this.lastCallTime>this.allowedCallInterval}}const Vt=e=>"Default"!==e&&"string"==typeof e,jt=(e,t)=>("string"==typeof e&&"Default"!==e&&s.warn(`Unknown color: ${e}`),e&&"Default"!==e?Array.isArray(e)?e.map((e=>"Default"===e?"#FFFFFF":e)):[e]:[...t.DefaultColor.map((e=>"Default"===e?"#FFFFFF":e))]),Ht=(e,t)=>{const s=e.querySelector(t);if(s)return s;throw new Error(`Element with selector "${t}" not found`)},Ut={state:0,memberNumber:0,setState:e=>{Ut.state=e(Ut.state)},setMemberNumber:e=>{Ut.setMemberNumber(e)},update:()=>{Ut.setState((e=>e+1))}};class Wt{constructor(e,t=!1){this.newX=0,this.newY=0,this.oldX=0,this.oldY=0,this.isDragging=!1,this.isResizing=!1,this.resizeDirection=null,this.edgeThreshold=10,this.resizable=!0,this.element=e,this.resizable=t,this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseEnter=this.onMouseEnter.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this),this.onMouseMoveForCursor=this.onMouseMoveForCursor.bind(this),this.element.addEventListener("mousedown",this.onMouseDown),this.element.addEventListener("mousemove",this.onMouseMoveForCursor),this.element.style.position="fixed",this.resizable&&(this.element.style.resize="none",this.element.addEventListener("mouseenter",this.onMouseEnter),this.element.addEventListener("mouseleave",this.onMouseLeave))}onMouseEnter(e){this.element.addEventListener("mousemove",this.onMouseMoveForCursor)}onMouseLeave(e){this.element.removeEventListener("mousemove",this.onMouseMoveForCursor),this.element.style.cursor="default"}onMouseMoveForCursor(e){const{offsetX:t,offsetY:s}=e,{offsetWidth:n,offsetHeight:i}=this.element;this.resizable&&(t<this.edgeThreshold||t>n-this.edgeThreshold?this.element.style.cursor="ew-resize":s<this.edgeThreshold||s>i-this.edgeThreshold?this.element.style.cursor="ns-resize":this.element.style.cursor="default")}onMouseDown(e){const{offsetX:t,offsetY:s}=e,{offsetWidth:n,offsetHeight:i}=this.element;this.resizable?t<this.edgeThreshold?(this.isResizing=!0,this.resizeDirection="left"):t>n-this.edgeThreshold?(this.isResizing=!0,this.resizeDirection="right"):s<this.edgeThreshold?(this.isResizing=!0,this.resizeDirection="top"):s>i-this.edgeThreshold?(this.isResizing=!0,this.resizeDirection="bottom"):this.isDragging=!0:this.isDragging=!0,(this.isDragging||this.isResizing)&&(e.preventDefault(),this.oldX=e.clientX,this.oldY=e.clientY,document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp))}onMouseMove(e){if(this.isDragging)this.newX=this.oldX-e.clientX,this.newY=this.oldY-e.clientY,this.oldX=e.clientX,this.oldY=e.clientY,this.element.style.top=this.element.offsetTop-this.newY+"px",this.element.style.left=this.element.offsetLeft-this.newX+"px";else if(this.isResizing){const t=e.clientX-this.oldX,s=e.clientY-this.oldY,n=getComputedStyle(this.element),i=parseInt(n.left,10),r=parseInt(n.top,10),a=parseInt(n.width,10),o=parseInt(n.height,10);switch(this.resizeDirection){case"left":this.element.style.width=a-t+"px",this.element.style.left=`${i+t/2}px`;break;case"right":this.element.style.width=`${a+t}px`,this.element.style.left=`${i+t/2}px`;break;case"top":this.element.style.height=o-s+"px",this.element.style.top=`${r+s/2}px`;break;case"bottom":this.element.style.height=`${o+s}px`,this.element.style.top=`${r+s/2}px`}this.oldX=e.clientX,this.oldY=e.clientY}}onMouseUp(e){e.preventDefault(),this.isDragging=!1,this.isResizing=!1,this.resizeDirection=null,document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp)}}class qt{constructor(e,t,s,n=-1){this.prompt=document.createElement("div"),new Wt(this.prompt),this.id=$t(),this.message=e,this.onAccept=t,this.onDeny=s,this.show(),-1!==n&&setTimeout((()=>{this.prompt.remove()}),n)}show(){this.prompt.classList.add("ABCLPrompt","no-resize"),this.prompt.id=this.id,this.prompt.innerHTML=`<p>${this.message}</p><button class="ABCLPromptNo ABCLButton">Deny</button><button class="ABCLPromptYes ABCLButton">Accept</button>`,Yt.appendChild(this.prompt),this.prompt.querySelector(`#${this.id} .ABCLPromptYes`)?.addEventListener("click",(()=>{this.onAccept(),this.prompt.remove()})),this.prompt.querySelector(`#${this.id} .ABCLPromptNo`)?.addEventListener("click",(()=>{this.onDeny(),this.prompt.remove()}))}}const Yt=document.createElement("div");Yt.id="ABCL-overlay";const Xt=()=>{ElementPositionFixed(Yt.id,0,0,2e3,1e3),ElementPositionFixed("ABCL-stats-panel",1700,0,300,1e3);const e=document.querySelectorAll(".ABCL-exit-button");for(let t=0;t<e.length;t++){const s=e[t];s.id=s.id||$t(),ElementPositionFixed(s.id,1815,75,90,90)}};window.addEventListener("resize",Xt),Yt.classList.add("ABCL-overlay");const Kt=e=>{if(!e)return;if("object"==typeof e)return e;return ChatRoomCharacter.filter((t=>{const s=t.Name.toLowerCase(),n=t.Nickname?.toLowerCase(),i=`${e}`.toLowerCase();return t.MemberNumber==e||s===i||n===i||s.startsWith(i)||n?.startsWith(i)}))[0]},Zt=e=>{const t=e.join(" "),s=Kt(t);if(s)return s},Jt=(e,t,s=Player.ABCL.Version)=>Boolean(e?.ABCL&&(!t||e.ABCL.Version===s));function Qt(e){if(!e)return"Unknown";const t=Kt(e);return t?t.Nickname?t.Nickname:t.Name:"Unknown"}function es(e,t=null,s=""){let n=e,i="He/Him"===CharacterPronounDescription(Player),r=i?"His":"Her",a=i?"Him":"Her",o=i?"He":"She",l="He/Him"===(t?CharacterPronounDescription(t):"They/Them"),c=t?.IsPlayer()?l?"himself":"herself":t?CharacterNickname(t):s,u=l?"His":"Her",d=t==Player?l?"Himself":"Herself":l?"Him":"Her",h=l?"He":"She";return n.replaceAll("%NAME%",CharacterNickname(Player)).replaceAll("%POSSESSIVE%",r.toLocaleLowerCase()).replaceAll("%PRONOUN%",o.toLocaleLowerCase()).replaceAll("%INTENSIVE%",a.toLocaleLowerCase()).replaceAll("%CAP_POSSESSIVE%",r).replaceAll("%CAP_PRONOUN%",o).replaceAll("%CAP_INTENSIVE%",a).replaceAll("%OPP_NAME%",c).replaceAll("%OPP_PRONOUN%",h.toLocaleLowerCase()).replaceAll("%OPP_POSSESSIVE%",u.toLocaleLowerCase()).replaceAll("%OPP_INTENSIVE%",d.toLocaleLowerCase()).replaceAll("%CAP_OPP_PRONOUN%",h).replaceAll("%CAP_OPP_POSSESSIVE%",u).replaceAll("%CAP_OPP_INTENSIVE%",d)}const ts=(e,t,s=!1)=>{if(0===t)return;if(s&&(t*=100),t=Number(t.toPrecision(2)),void 0===Player.ABCL.Settings.StatusMessages[e])return;if(!Player.ABCL.Settings.StatusMessages[e])return;const n=Player.ABCL.Settings.StatusMessages[e],i=`[${t>0?"+":"-"}${Math.abs(t)}${s?"%":""} ${{Bladder:"PEE",Bowel:"POO",Incontinence:"INCON",MentalRegression:"REG",Soiliness:"MESS",Wetness:"WET",PuddleSize:"PUDL"}[e]}]`;n?Rt(i,["ChatMessageAction","ChatMessageNonDialogue"],"--label-color:#ff4949"):_n("onABCLMessage",{message:`${Qt(Player.MemberNumber)}: ${i}`,local:n})};function ss(e,t=null,s,n){let i=es(e,t);const r=!Player.ABCL.Settings.VisibleMessages[s];Rt(i,["ChatMessageAction","ChatMessageNonDialogue"],"--label-color:#ff4949",r),r?n&&n.MemberNumber!==Player.MemberNumber&&_n("onABCLMessage",{message:i,local:r},n.MemberNumber):_n("onABCLMessage",{message:i,local:r})}const ns=()=>{CharacterRefresh(Player,!0),ChatRoomCharacterUpdate(Player)},is=new Gt(72e5),rs=new Gt(72e5),as=new Gt(3e5),os={onAccident:()=>{os.stats.MentalRegression+=ws()??0},update:()=>{Player.ABCL.Settings.PauseStats||(is.allowedCallInterval=12e4/Math.max(.1,h[Player.ABCL.Settings.PoopMetabolism]),rs.allowedCallInterval=12e4/Math.max(.1,h[Player.ABCL.Settings.PeeMetabolism]),as.check()&&(os.stats.MentalRegression+=5*(Ss()??0)),rs.check()&&(os.stats.BladderValue+=os.stats.WaterIntake*h[Player.ABCL.Settings.PeeMetabolism],"Disabled"!==Player.ABCL.Settings.PeeMetabolism&&os.attemptWetting()),is.check()&&(os.stats.BowelValue+=os.stats.FoodIntake*h[Player.ABCL.Settings.PoopMetabolism],"Disabled"!==Player.ABCL.Settings.PoopMetabolism&&os.attemptSoiling()),ls.save())},wetClothing:()=>{if(Player.ABCL.Settings.DisableWettingLeaks)return;if(Rt("You've had a wet accident in your clothes!"),os.stats.PuddleSize+=os.stats.BladderValue,os.stats.BladderValue=0,ps()?ss("%NAME%'s diaper leaks and wet %POSSESSIVE% clothes causing a puddle to form.",void 0,"wetClothing"):ss("%NAME%'s wets %POSSESSIVE% clothes and leaks onto the floor.",void 0,"wetClothing"),vn(),Player.ABCL.Settings.DisableClothingStains)return;const e="#96936C",t=InventoryGet(Player,"Panties");if(t&&!hs(t)){const s=jt(t.Color||t.Asset.DefaultColor,t.Asset);for(let t=0;t<s.length;t++)Vt(s[t])&&(s[t]=ms(s[t],e,.3));t.Color=s}for(const t of Player.Appearance)if(n.ItemDefinitions.Pants.some((e=>e===t.Asset.Description))){const s=jt(t.Color||t.Asset.DefaultColor,t.Asset);for(let t=0;t<s.length;t++)Vt(s[t])&&(s[t]=ms(s[t],e,.3));t.Color=s}ns()},soilClothing:()=>{if(Player.ABCL.Settings.DisableSoilingLeaks)return;if(os.stats.BowelValue=0,ps()?ss("%NAME%'s diaper leaks and soils %POSSESSIVE% clothes.",void 0,"soilClothing"):ss("%NAME% soils %POSSESSIVE% clothes.",void 0,"soilClothing"),vn(),Player.ABCL.Settings.DisableClothingStains)return;const e="#261a16",t=InventoryGet(Player,"Panties");if(t&&!hs(t)){const s=jt(t.Color||t.Asset.DefaultColor,t.Asset);for(let t=0;t<s.length;t++)Vt(s[t])&&(s[t]=ms(s[t],e,.3));t.Color=s}for(const t of Player.Appearance)if(n.ItemDefinitions.Pants.some((e=>e===t.Asset.Description))){const s=jt(t.Color||t.Asset.DefaultColor,t.Asset);for(let t=0;t<s.length;t++)Vt(s[t])&&(s[t]=ms(s[t],e,.3));t.Color=s}ns()},wetDiaper:()=>{const e=_s(),t=Math.min(os.stats.BladderValue,Math.max(0,e-os.stats.WetnessValue));ss("%NAME% wets %POSSESSIVE% diaper.",void 0,"wetDiaper"),os.stats.BladderValue-=t,os.stats.WetnessValue+=t,os.stats.WetnessValue>=e&&os.wetClothing()},soilDiaper:()=>{const e=_s(),t=Math.min(os.stats.BowelValue,Math.max(0,e-os.stats.SoilinessValue));ss("%NAME% soils %POSSESSIVE% diaper.",void 0,"soilDiaper"),os.stats.BowelValue-=t,os.stats.SoilinessValue+=t,os.stats.SoilinessValue>=e&&os.soilClothing()},attemptWetting:()=>{const e=As(os.stats.Incontinence),t=Cs(os.stats.Incontinence,os.stats.BladderFullness);(Math.random()<t||os.stats.BladderFullness>e)&&cs.check()&&MiniGameStart("WetMinigame",30*t,"noOp")},attemptSoiling:()=>{const e=As(os.stats.Incontinence),t=Cs(os.stats.Incontinence,os.stats.BowelFullness);(Math.random()<t||os.stats.BowelFullness>e)&&cs.check()&&MiniGameStart("MessMinigame",30*t,"noOp")},wet:(e=!1)=>{const t=.3*os.stats.Incontinence,s=os.stats.BladderFullness<.3-t,n=!s,i=os.stats.BladderFullness>.6-t;s&&e?Rt("You try to pee, but it doesn't seem to be working."):(n&&(ps()?os.wetDiaper():os.wetClothing()),i&&e?os.stats.Incontinence-=Ms(os.stats.Incontinence):os.stats.Incontinence+=Ms(os.stats.Incontinence))},soil:(e=!1)=>{const t=.3*os.stats.Incontinence,s=os.stats.BowelFullness<.3-t,n=!s,i=os.stats.BowelFullness>.6-t;s&&e?Rt("You try to let go, but nothing seems to happen."):(n&&(ps()?os.soilDiaper():os.soilClothing()),i&&e?os.stats.Incontinence-=.01:os.stats.Incontinence+=.02)},stats:{set PuddleSize(e){e<0&&(e=0),e>250&&(e=250);const t=e-Player.ABCL.Stats.PuddleSize.value;ts("PuddleSize",t),Player.ABCL.Stats.PuddleSize.value=e},get PuddleSize(){return Player.ABCL.Stats.PuddleSize.value},get MentalRegressionModifier(){return h[Player.ABCL.Settings.MentalRegressionModifier]},set MentalRegression(e){e<0&&(e=0),e>1&&(e=1);const t=e-Player.ABCL.Stats.MentalRegression.value;ts("MentalRegression",t,!0),Player.ABCL.Stats.MentalRegression.value=e,Ut.update()},get MentalRegression(){return Player.ABCL.Stats.MentalRegression.value},set Incontinence(e){e<0&&(e=0),e>1&&(e=1);const t=e-Player.ABCL.Stats.Incontinence.value;ts("Incontinence",t,!0),Player.ABCL.Stats.Incontinence.value=e,Ut.update()},get Incontinence(){return Player.ABCL.Stats.Incontinence.value},set WaterIntake(e){e<0&&(e=0),Player.ABCL.Stats.WaterIntake.value=e},get WaterIntake(){return Player.ABCL.Stats.WaterIntake.value},set FoodIntake(e){e<0&&(e=0),Player.ABCL.Stats.FoodIntake.value=e},get FoodIntake(){return Player.ABCL.Stats.FoodIntake.value},set BladderValue(e){e<0&&(e=0);const t=e/this.BladderSize-this.BladderFullness;ts("Bladder",t,!0),Player.ABCL.Stats.Bladder.value=e,Ut.update()},get BladderValue(){return Player.ABCL.Stats.Bladder.value},set BladderSize(e){e<0&&(e=0),Player.ABCL.Stats.Bladder.size=e,Ut.update()},get BladderSize(){return Player.ABCL.Stats.Bladder.size},set WetnessValue(e){e<0&&(e=0);const t=e/_s()-this.WetnessPercentage;ts("Wetness",t,!0),Player.ABCL.Stats.Wetness.value=e,bs(),Ut.update()},get WetnessValue(){return Player.ABCL.Stats.Wetness.value},set BladderFullness(e){e<0&&(e=0),this.BladderValue=e*this.BladderSize,Ut.update()},get BladderFullness(){return this.BladderValue/this.BladderSize},set BowelValue(e){e<0&&(e=0);const t=e/this.BowelSize-this.BowelFullness;ts("Bowel",t,!0),Player.ABCL.Stats.Bowel.value=e,Ut.update()},get BowelValue(){return Player.ABCL.Stats.Bowel.value},set BowelSize(e){e<0&&(e=0),Player.ABCL.Stats.Bowel.size=e,Ut.update()},get BowelSize(){return Player.ABCL.Stats.Bowel.size},set SoilinessValue(e){e<0&&(e=0);const t=e/_s()-this.SoilinessPercentage;ts("Soiliness",t,!0),Player.ABCL.Stats.Soiliness.value=e,bs(),Ut.update()},get SoilinessValue(){return Player.ABCL.Stats.Soiliness.value},set BowelFullness(e){e<0&&(e=0),this.BowelValue=e*this.BowelSize,Ut.update()},get BowelFullness(){return this.BowelValue/this.BowelSize},get SoilinessPercentage(){return 0==_s()?0:this.SoilinessValue/_s()},set SoilinessPercentage(e){e<0&&(e=0),this.SoilinessValue=e*_s()},get WetnessPercentage(){return 0==_s()?0:this.WetnessValue/_s()},set WetnessPercentage(e){e<0&&(e=0),this.WetnessValue=e*_s()}}},ls=new class{constructor(e){this.lastSaveTime=0,this.allowedSaveInterval=e}save(){Date.now()-this.lastSaveTime>this.allowedSaveInterval&&(Tt(),this.lastSaveTime=Date.now())}}(12e4),cs=new Gt(12e4);window.abclPlayer=os;const us=(e="any")=>{const t=_s();return"pee"===e?os.stats.PuddleSize>0:"poop"===e?os.stats.SoilinessValue>=t:os.stats.SoilinessValue>=t||os.stats.WetnessValue>=t},ds=()=>{const e=_s();return os.stats.SoilinessValue+os.stats.WetnessValue>=e/2},hs=e=>e.Asset.Description.toLowerCase().includes("diaper")&&e.Asset.Description in n.Diapers;function ps(e=Player){if(!e)return!1;const t=InventoryGet(e,"ItemPelvis"),s=InventoryGet(e,"Panties");return Boolean(t&&hs(t)||s&&hs(s))}function ms(e,t,s=.5){let n=DrawHexToRGB(e),i=DrawHexToRGB(t),r={r:Math.round(n.r*s+i.r*(1-s)),g:Math.round(n.g*s+i.g*(1-s)),b:Math.round(n.b*s+i.b*(1-s))};return DrawRGBToHex([r.r,r.g,r.b])}function gs(e,t,s,n){return e>.75?e>.9?t:ms(t,s,e-.75):ms(s,n,e)}const fs=(e=Player)=>{if(!ps())return!1;const t=InventoryGet(e,"ItemPelvis");return Boolean(t&&hs(t)&&(Player.MemberNumber===e.MemberNumber?t.Property?.LockedBy:!(t.Property?.LockMemberNumber===e.MemberNumber||"ExclusivePadlock"===t.Property?.LockedBy)))},ys=(e,t,s=Player)=>{if(Player.ABCL.Settings.DisableDiaperStains)return;const i=InventoryGet(s,e);if(i&&hs(i)){const e=i.Color&&"string"!=typeof i.Color?i.Color:i.Asset.DefaultColor,s=n.Diapers[i.Asset.Description],r=Math.min(os.stats.SoilinessValue+os.stats.WetnessValue/_s(),1);if("indicator"in s)for(const t of s.indicator)e[t]=ms(n.DiaperColors.indicatorAccident,i.Asset.DefaultColor[t],r);if("gradients"in s)for(const n of s.gradients)i.Property?.Opacity&&"object"==typeof i.Property.Opacity&&(i.Property.Opacity[n]=r,e[n]=t);if("color"in s)for(const n of s.color)e[n]=t;console.log(e),i.Color=e}},bs=()=>{const e=os.stats.SoilinessValue/_s(),t=os.stats.WetnessValue/_s(),s=gs(e,n.DiaperColors.maximummess,n.DiaperColors.middlemess,n.DiaperColors.clean),i=gs(t,n.DiaperColors.maximumwet,n.DiaperColors.middlewet,n.DiaperColors.clean),r=Math.max(Math.min((e+(1-t))/2,2),0),a=ms(s,i,r);console.log(r,a),ys("ItemPelvis",a,Player),ys("Panties",a,Player),ns()};function _s(e=Player){const t=InventoryGet(e,"ItemPelvis"),s=InventoryGet(e,"Panties");let n=50;return t&&hs(t)&&(n+=vs(t)),s&&hs(s)&&(n+=vs(s)),n}function vs(e){return"Poofy Chastity Diaper"===e.Asset.Description&&1===e.Property?.TypeRecord?.typed?n.DiaperSizeScale.heavy_adult:n.DiaperSizeScale[n.Diapers[e.Asset.Description].size]}const As=e=>.9-.5*e;function Cs(e,t){const s=.6*Math.pow(e,2)+.8*Math.pow(t,3);return Math.min(Math.max(s,0),1)}const Ps=()=>{const e=Player.Appearance.map((e=>e.Asset.Description)),t=n.ItemDefinitions.BabyItems.concat(["milk","pacifier","bib"]).filter((t=>e.some((e=>e.toLocaleLowerCase().includes(t)))));return Math.min(.25*t.length,1)},Ss=()=>{let e=Ps();Player.Appearance.some((e=>n.ItemDefinitions.BabyItems.includes(e.Asset.Description)))&&(e+=1),ds()&&(e+=1),us()&&(e+=1);const t=e/4,s=os.stats.MentalRegression,i=.005*os.stats.MentalRegressionModifier;return s<t?i:-i},Ms=e=>{const t=[{increase:.01,start:0,end:.25},{increase:.005,start:.25,end:.5},{increase:.0025,start:.5,end:.75},{increase:.001,start:.75,end:1}];for(const{increase:s,start:n,end:i}of t)if(e>=n&&e<i)return s;return 0},ws=()=>{const e=1+Ps()*os.stats.MentalRegressionModifier;return os.stats.MentalRegression<.25||.25>os.stats.MentalRegression&&os.stats.MentalRegression<.5&&ds()?e/500:.5>os.stats.MentalRegression&&os.stats.MentalRegression<.75&&us()?e/1e3:.75>os.stats.MentalRegression&&os.stats.MentalRegression<1&&us()?e/1500:0},Bs=e=>{if(!ps(e))return"";const t=_s(e),s=e.ABCL.Stats.Soiliness.value/t>.5,n=e.ABCL.Stats.Wetness.value/t>.5,i=e.ABCL.Stats.Wetness.value/t>.8,r=e.ABCL.Stats.Soiliness.value/t>.8;return i&&r?"soggy and stinky":r?"stinky":i?"soggy":n?"wet":s?"messy":"dry"},Ls=(e,t)=>{if(e.MemberNumber!==Player.MemberNumber)return _n("changeDiaper-pending",{force:t},e.MemberNumber);ks(e)},ks=e=>{ss(es(e.MemberNumber===Player.MemberNumber?"%NAME% changes %POSSESSIVE% diaper.":"%OPP_NAME% changes %NAME%'s diaper.",e),void 0,"changeDiaper",e),os.stats.WetnessValue=0,os.stats.SoilinessValue=0,bs()},Ns={activity:{ID:"change-diaper",Name:"Change Diaper",Image:"https://zoe-64.github.io/ABCL/versions/unstable/assets/activity/changeDiaper.svg",Target:["ItemPelvis"],OnClick:(e,t)=>Ls(e),Criteria:e=>ps(e)&&Jt(e)&&!Player.IsRestrained()&&!fs()},command:{Tag:"change-diaper",Action:(e,t,s)=>{const n=Zt(s)??Player;if(!Ns.activity.Criteria(n))return Rt("Is either not diapered or not an ABCL player or you are restrained or diaper is locked.");Ls(n)},Description:" [MemberNumber|Name|Nickname]: Changes someone's diaper."},listeners:{"changeDiaper-accepted":({Sender:e})=>Rt(`${Qt(e)} accepted your change diaper request.`),"changeDiaper-rejected":({Sender:e})=>Rt(`${Qt(e)} rejected your change diaper request.`),"changeDiaper-pending":({Sender:e},{force:t})=>{if(t)return ks(Kt(e)??Player);switch(Player.ABCL.Settings.OnDiaperChange){case u:new qt(`${Qt(e)} wants to change your diaper.`,(()=>{ks(Kt(e)??Player),_n("changeDiaper-accepted",void 0,e)}),(()=>_n("changeDiaper-rejected",void 0,e)),1e4);break;case d:ks(Kt(e)??Player),_n("changeDiaper-accepted",void 0,e);break;case c:_n("changeDiaper-rejected",void 0,e)}}}},Ds=e=>{const t=e.MemberNumber===Player.MemberNumber;if(Ut.setMemberNumber(e.MemberNumber),Ht(document.body,"#ABCL-stats").classList.remove("ABCL-hidden"),setTimeout((()=>{Xt()}),250),!(Math.random()<.75))return ps(e)?ss(es(t?"%NAME% checks %POSSESSIVE% diaper.":"%NAME% checks %OPP_NAME%'s diaper.",e),void 0,"checkDiaper",e):ss(es(t?"%NAME% checks %POSSESSIVE% clothes for any accidents.":"%NAME% checks %OPP_NAME%'s clothes for any accidents.",e),void 0,"checkDiaper",e)},Is={activity:{ID:"check-diaper",Name:"Check Diaper",Image:"https://zoe-64.github.io/ABCL/versions/unstable/assets/activity/diaperCheck.png",OnClick:(e,t)=>Ds(e),Target:["ItemPelvis"],Criteria:e=>Jt(e)&&!Player.IsRestrained()},command:{Tag:"check-diaper",Description:" [MemberNumber|Name|Nickname]: Checks someone's diaper.",Action:(e,t,s)=>{const n=Zt(s)??Player;if(!Is.activity.Criteria(n))return Rt("Is not an ABCL player or you are restrained.");Ds(n)}}},Es=e=>{ss(es("%OPP_NAME% rubs %OPP_POSSESSIVE% diaper against %NAME%'s face.",e),void 0,"playerActivity",e),ActivityEffectFlat(e,Player,8,"ItemVulva",1),CharacterSetFacialExpression(Player,"Blush","Medium",5),CharacterSetFacialExpression(Player,"Eyebrows","Soft",10),CharacterSetFacialExpression(Player,"Eyes","Dizzy",10),os.stats.MentalRegression+=.02*os.stats.MentalRegressionModifier},Fs={activity:{ID:"diaper-face-rub",Name:"Rub Diaper Against Face",Image:"https://zoe-64.github.io/ABCL/versions/unstable/assets/activity/diaperFaceRub.png",Target:["ItemNose"],OnClick:(e,t)=>(e=>{if(e.MemberNumber!==Player.MemberNumber)return ActivityEffectFlat(Player,Player,12,"ItemVulva",1),_n("diaper-face-rub",void 0,e.MemberNumber);Es(e)})(e),Criteria:e=>ps(e)&&Jt(e)&&!Player.IsRestrained()&&e.MemberNumber!==Player.MemberNumber},listeners:{"diaper-face-rub":({Sender:e})=>Es(Kt(e)??Player)}},Ts=e=>{ss(es("%OPP_NAME% sits with her diapered butt on %NAME%'s face.",e),void 0,"playerActivity",e),os.stats.MentalRegression+=.03*os.stats.MentalRegressionModifier,ActivityEffectFlat(Player,Player,8,"ItemNose",1),CharacterSetFacialExpression(Player,"Blush","ShortBreath",30),CharacterSetFacialExpression(Player,"Eyebrows","Soft",30),CharacterSetFacialExpression(Player,"Eyes","Dizzy",30)},Os={activity:{ID:"diaper-face-sit",Name:"Sits with Diaper on Face",Image:"https://zoe-64.github.io/ABCL/versions/unstable/assets/activity/diaperFaceSit.png",Target:["ItemNose"],OnClick:(e,t)=>(e=>{if(e.MemberNumber!==Player.MemberNumber)return ActivityEffectFlat(Player,Player,5,"ItemButt",1),_n("diaper-face-sit",void 0,e.MemberNumber);Ts(e)})(e),Criteria:e=>ps(Player)&&Jt(e)&&!Player.IsRestrained()&&e.MemberNumber!==Player.MemberNumber},listeners:{"diaper-face-sit":({Sender:e})=>Ts(Kt(e)??Player)}},xs=e=>{const t=Bs(Player),s="dry"===t?"crinkles":"sloshes",n="dry"===t?"crinkle":"slosh",i=e.MemberNumber===Player.MemberNumber,r=`%NAME% playfully pats %POSSESSIVE% ${t} diapered butt, enjoying the soft ${s} it makes.`,a=`%OPP_NAME% gives %NAME%'s diapered butt a playful pat, as the ${t} diaper ${n} softly.`;ActivityEffectFlat(Player,Player,1,"ItemButt",1),ss(es(i?r:a,e),void 0,"playerActivity",e)},Rs={activity:{ID:"diaper-pat-back",Name:"Diaper Pat Bottom",Image:"https://zoe-64.github.io/ABCL/versions/unstable/assets/activity/diaperPatBack.png",Target:["ItemButt"],OnClick:(e,t)=>(e=>{if(e.MemberNumber!==Player.MemberNumber)return _n("diaper-pat-back",void 0,e.MemberNumber);xs(e)})(e),Criteria:e=>Jt(e)&&ps(e)&&!Player.IsRestrained()},listeners:{"diaper-pat-back":({Sender:e})=>xs(Kt(e)??Player)}},zs=e=>{const t=Bs(Player),s="dry"===t?"crinkles":"sloshes";ss(es(e.MemberNumber===Player.MemberNumber?`%NAME% pats the front of %POSSESSIVE% ${t} diaper playfully, smiling at the soft ${s}.`:`%OPP_NAME% playfully pats the front of %NAME%'s ${t} diaper, as the padding ${s} softly.`,e),void 0,"playerActivity",e),ActivityEffectFlat(Player,Player,1,"ItemVulva",1)},$s={activity:{ID:"diaper-pat-front",Name:"Diaper Pat Crotch",Image:"https://zoe-64.github.io/ABCL/versions/unstable/assets/activity/diaperPatFront.png",Target:["ItemVulva"],OnClick:(e,t)=>(e=>{if(e.MemberNumber!==Player.MemberNumber)return _n("diaper-pat-front",void 0,e.MemberNumber);zs(e)})(e),Criteria:e=>Jt(e)&&ps(e)&&!Player.IsRestrained()},listeners:{"diaper-pat-front":({Sender:e})=>zs(Kt(e)??Player)}},Gs=(e,t)=>{ss(es("%OPP_NAME% tugs %NAME%'s diaper waistband and pees inside.",e),void 0,"playerActivity",e),CharacterSetFacialExpression(Player,"Blush","Low",8),CharacterSetFacialExpression(Player,"Eyebrows","Soft",8),CharacterSetFacialExpression(Player,"Eyes","Surprised",5),os.stats.WetnessValue+=t??0},Vs={activity:{ID:"pee-in-diaper",Name:"Pees in Diaper",Image:"https://zoe-64.github.io/ABCL/versions/unstable/assets/activity/diaperPeeOthersDiaper.png",Target:["ItemPelvis"],OnClick:(e,t)=>((e,t)=>{if(e.MemberNumber!==Player.MemberNumber)return _n("diaper-pee-others-diaper",{volume:t},e.MemberNumber);os.stats.BladderValue=0,Gs(e,t)})(e,os.stats.BladderValue),Criteria:e=>Jt(e)&&ps(e)&&os.stats.BladderValue>0&&e!==Player&&!Player.IsRestrained()},listeners:{"diaper-pee-others-diaper":({Sender:e},{volume:t})=>Gs(Kt(e)??Player,t)}},js=e=>{ss(es(e.MemberNumber===Player.MemberNumber?"%NAME% pours water in %POSSESSIVE% diaper.":"%OPP_NAME% pours water in %NAME%'s diaper.",e),void 0,"playerActivity",e),os.stats.WetnessValue+=500,CharacterSetFacialExpression(Player,"Blush","Low",8),CharacterSetFacialExpression(Player,"Eyebrows","Soft",8),CharacterSetFacialExpression(Player,"Eyes","Surprised",5),CharacterSetFacialExpression(Player,"Eyes","Daydream",2)},Hs={activity:{ID:"diaper-pour",Name:"Pour Water in Diaper",Image:"https://zoe-64.github.io/ABCL/versions/unstable/assets/activity/diaperPour.png",Target:["ItemPelvis"],OnClick:(e,t)=>(e=>{if(e.MemberNumber!==Player.MemberNumber)return _n("diaper-pour",void 0,e.MemberNumber);js(e)})(e),Criteria:e=>ps(e)&&Jt(e)&&!Player.IsRestrained()},listeners:{"diaper-pour":({Sender:e})=>js(Kt(e)??Player)}},Us=e=>{const t=Bs(Player),s="dry"===t?"crinkles":"sloshes";ss(es(e.MemberNumber===Player.MemberNumber?`%NAME% blushes as %PRONOUN% rubs %POSSESSIVE% ${t} diapered butt with both hands, breath hitching at the soft ${s} under %POSSESSIVE% hands.`:`%OPP_NAME% runs %OPP_POSSESSIVE% hand over %NAME%'s ${t} diapered butt, rubbing affectionate circles into the ${t} padding.`,e),void 0,"playerActivity",e),ActivityEffectFlat(Player,Player,5,"ItemButt",1),os.stats.Incontinence>Math.random()&&os.attemptSoiling()},Ws={activity:{ID:"diaper-rub-back",Name:"Diaper Rub Bottom",Image:"https://zoe-64.github.io/ABCL/versions/unstable/assets/activity/diaperRubBack.png",Target:["ItemButt"],OnClick:(e,t)=>(e=>{if(e.MemberNumber!==Player.MemberNumber)return _n("diaper-rub-back",void 0,e.MemberNumber);Us(e)})(e),Criteria:e=>Jt(e)&&ps(e)&&!Player.IsRestrained()},listeners:{"diaper-rub-back":({Sender:e})=>Us(Kt(e)??Player)}},qs=e=>{const t=Bs(Player);ss(es(e.MemberNumber===Player.MemberNumber?`%NAME% blushes as %PRONOUN% rubs circles over the front of %POSSESSIVE% ${t} diaper, biting %POSSESSIVE% lip as %PRONOUN% grinds down into %POSSESSIVE% own hand.`:`%OPP_NAME% rubs up and down %NAME%'s ${t} diaper, %OPP_POSSESSIVE% fingers pressing into the ${t} padding over the front and between %POSSESSIVE% legs.`,e),void 0,"playerActivity",e),ActivityEffectFlat(Player,Player,10,"ItemVulva",1),os.stats.Incontinence>Math.random()&&os.attemptWetting()},Ys={activity:{ID:"diaper-rub-front",Name:"Diaper Rub",Image:"https://zoe-64.github.io/ABCL/versions/unstable/assets/activity/diaperRubFront.png",Target:["ItemVulva"],OnClick:(e,t)=>(e=>{if(e.MemberNumber!==Player.MemberNumber)return _n("diaper-rub-front",void 0,e.MemberNumber);qs(e)})(e),Criteria:e=>Jt(e)&&ps(e)&&!Player.IsRestrained()},listeners:{"diaper-rub-front":({Sender:e})=>qs(Kt(e)??Player)}},Xs=e=>{const t=Bs(Player);ss(es(e.MemberNumber===Player.MemberNumber?`%NAME% gives %POSSESSIVE% ${t} diapered butt a squeeze, blushing a little as it squishes under %POSSESSIVE% hand.`:`%OPP_NAME% gives %NAME%'s ${t} diapered butt a teasing squeeze, smiling as %OPP_PRONOUN% squishes and kneads the ${t} padding.`,e),void 0,"playerActivity",e)},Ks={activity:{ID:"diaper-squish-back",Name:"Diaper Squish Bottom",Image:"https://zoe-64.github.io/ABCL/versions/unstable/assets/activity/diaperSquishBack.png",Target:["ItemButt"],OnClick:(e,t)=>(e=>{if(e.MemberNumber!==Player.MemberNumber)return _n("diaper-squish-back",void 0,e.MemberNumber);Xs(e)})(e),Criteria:e=>Jt(e)&&ps(e)&&!Player.IsRestrained()},listeners:{"diaper-squish-back":({Sender:e})=>Xs(Kt(e)??Player)}},Zs=e=>{const t=Bs(Player);ss(es(e.MemberNumber===Player.MemberNumber?`%NAME% presses into the front of %POSSESSIVE% ${t} diaper, blushing as %PRONOUN% squishes %POSSESSIVE% ${t} padding.`:`%OPP_NAME% presses her hand into %NAME%'s ${t} diaper, giggling as %OPP_PRONOUN% squishes the ${t} padding between %POSSESSIVE% legs.`,e),void 0,"playerActivity",e)},Js={activity:{ID:"diaper-squish-front",Name:"Diaper Squish Crotch",Image:"https://zoe-64.github.io/ABCL/versions/unstable/assets/activity/diaperSquishFront.png",Target:["ItemVulva"],OnClick:(e,t)=>(e=>{if(e.MemberNumber!==Player.MemberNumber)return _n("diaper-squish-front",void 0,e.MemberNumber);Zs(e)})(e),Criteria:e=>Jt(e)&&ps(e)&&!Player.IsRestrained()},listeners:{"diaper-squish-front":({Sender:e})=>Zs(Kt(e)??Player)}},Qs=e=>{if(!(e.MemberNumber===Player.MemberNumber))return _n("lick-puddle",void 0,e.MemberNumber);en(Player)},en=e=>{ss(es(e.MemberNumber===Player.MemberNumber?"%NAME% licks %POSSESSIVE% puddle of pee.":"%OPP_NAME% licks %NAME%'s puddle of pee.",e),void 0,"lickPuddle",e),CharacterSetFacialExpression(Player,"Fluids","DroolLow",20),vn(),ns(),os.stats.PuddleSize-=50},tn={activity:{ID:"lick-puddle",Name:"Lick Puddle",Image:"https://zoe-64.github.io/ABCL/versions/unstable/assets/activity/lickPuddle.png",Target:["ItemBoots"],OnClick:(e,t)=>Qs(e),Criteria:e=>Jt(e)&&e.ABCL.Stats.PuddleSize.value>0},command:{Tag:"lick-puddle",Action:(e,t,s)=>{const n=Zt(s)??Player;if(!tn.activity.Criteria(n))return Rt("Is either not an ABCL player or has no puddle.");Qs(n)},Description:" [MemberNumber|Name|Nickname]: Licks a puddle of pee."},listeners:{"lick-puddle":({Sender:e})=>en(Kt(e)??Player)}},sn={listeners:{onABCLMessage:({Sender:e},{message:t,local:s})=>{Rt(t,void 0,"background: #FFA9A93B",s)}}},nn=()=>{const e=Player.ABCL.Settings.PauseStats;ss(e?"%NAME% resumed their ABCL stats.":"%NAME% paused their ABCL stats.",Player,"pauseStats"),Player.ABCL.Settings.PauseStats=!e},rn={activity:{ID:"pauseStats",Name:"Pause Stats",Image:"https://zoe-64.github.io/ABCL/versions/unstable/assets/activity/pauseStats.png",TargetSelf:["ItemPelvis"],OnClick:(e,t)=>nn(),Criteria:e=>!0},command:{Tag:"pause-stats",Action:(e,t,s)=>nn(),Description:" Pauses the ABCL stats."}},an={listeners:{sync:({Sender:e},t)=>{if(!e)return;console.log("sync:ABCL"),s.debug({message:"Received updated data",data:t});const n=Kt(e);n&&(n.ABCL={Stats:t.stats,Version:t.version,Settings:t.settings})},init:({Sender:e})=>{console.log("init"),s.debug("Received request for data"),vn(e)}}},on={activity:{ID:"pee",Name:"Pee",Image:"https://zoe-64.github.io/ABCL/versions/unstable/assets/activity/wetDiaper.svg",OnClick:(e,t)=>os.wet(!0),TargetSelf:["ItemPelvis"]},command:{Tag:"pee",Action:(e,t,s)=>os.wet(!0),Description:" Lets go of your bladder."}},ln={activity:{ID:"poop",Name:"Poop",Image:"https://zoe-64.github.io/ABCL/versions/unstable/assets/activity/soilDiaper.svg",OnClick:(e,t)=>os.soil(!0),TargetSelf:["ItemPelvis"]},command:{Tag:"poop",Action:()=>os.soil(!0),Description:" Relaxes your bowels."}},cn=()=>{const e=.3*os.stats.Incontinence,t=os.stats.BladderFullness>.6||os.stats.BowelFullness>.6,s=os.stats.BladderFullness<.3-e&&os.stats.BowelFullness<.3-e,n=os.stats.MentalRegression>.9,i=os.stats.MentalRegression<.3;if(s)return void ss("%NAME% tries to use the potty but can't seem to get anything out.",void 0,"usePotty");os.stats.BowelFullness=0,os.stats.BladderFullness=0;let r="";i&&(r="and feels embarrased",CharacterSetFacialExpression(Player,"Blush","Low",10),os.stats.MentalRegression+=.04*os.stats.MentalRegressionModifier),t&&!n&&(r+=i?" but is releaved":"and feels releaved",os.stats.Incontinence+=-.01,os.stats.MentalRegression-=.02*os.stats.MentalRegressionModifier,CharacterSetFacialExpression(Player,"Mouth","Happy",8)),ss("%NAME% sits down uses the potty "+r+".",void 0,"usePotty")},un={activity:{ID:"potty",Name:"Sit and Use Potty",Image:"https://zoe-64.github.io/ABCL/versions/unstable/assets/activity/potty-temp.png",OnClick:(e,t)=>cn(),TargetSelf:["ItemButt"],Criteria:e=>!(ps(e)&&fs()||Player.IsRestrained())},command:{Tag:"use-potty",Action:(e,t,s)=>{if(!un.activity?.Criteria(Player))return Rt("You are restrained or diaper is locked.");cn()},Description:" Sit down and use the potty."}},dn=()=>{const e=.3*os.stats.Incontinence,t=os.stats.BladderFullness<.3&&os.stats.BowelFullness<.3,s=os.stats.BladderFullness>.6-e||os.stats.BowelFullness>.6-e;if(t)return Rt("You try to use the toilet but you can't seem to get anything out.");let n="";s&&(n="and feels releaved",os.stats.MentalRegression-=.02*os.stats.MentalRegressionModifier,os.stats.Incontinence+=-.01),os.stats.BladderFullness=0,os.stats.BowelFullness=0,ss("%NAME% goes to the bathroom uses the toilet "+n+".",void 0,"useToilet")},hn={activity:{ID:"toilet",Name:"Sit and Use Toilet",Image:"https://zoe-64.github.io/ABCL/versions/unstable/assets/activity/toilet-temp.png",OnClick:(e,t)=>dn(),Criteria:e=>os.stats.MentalRegression<.3&&!(ps(e)&&fs())&&!Player.IsRestrained(),TargetSelf:["ItemButt"]},command:{Tag:"use-toilet",Action:()=>os.stats.MentalRegression<.3?(CharacterSetFacialExpression(Player,"Eyes","Dizzy",8),Rt("You feel uncomfortable, the toilet is cold and hard almost like ice. You can't use it.")):ps()&&(Player.IsRestrained()||fs())?Rt("You can't use the toilet while your diaper is locked."):void dn(),Description:" Sit down and use the toilet."}},pn=e=>{if(e.MemberNumber!==Player.MemberNumber)return _n("wipe-puddle",void 0,e.MemberNumber);mn(Player)},mn=e=>{if(os.stats.PuddleSize=0,vn(),ns(),e.MemberNumber!==Player.MemberNumber)return ss(es("%OPP_NAME% wipes %NAME%'s puddle of pee.",e),void 0,"wipePuddle",e);ss(es("%NAME% wipes %POSSESSIVE% puddle of pee.",e),void 0,"wipePuddle",e)},gn={activity:{ID:"wipe-puddle",Name:"Wipe Puddle",Image:"./Assets/Female3DCG/ItemHandheld/Preview/Towel.png",Target:["ItemBoots"],OnClick:(e,t)=>pn(e),Criteria:e=>Jt(e)&&e.ABCL.Stats.PuddleSize.value>0&&!Player.IsRestrained()},command:{Tag:"wipe-puddle",Action:(e,t,s)=>{const n=Kt(s[0])??Player;if(!gn.activity.Criteria(n))return Rt("Is either not an ABCL player or has no puddle. Or you are restrained.");pn(n)},Description:" [MemberNumber|Name|Nickname]: Wipes a puddle of pee."},listeners:{"wipe-puddle":({Sender:e})=>{mn(Kt(e)??Player)}}};class fn{constructor(e,t,s,n,i,r,a){this.id=e,this.name=t,this.image=s,this.onClick=n,this.target=i,this.targetSelf=r,this.criteria=a}fitsCriteria(e,t){return Boolean((!this.criteria||this.criteria(e))&&(this.target?.includes(t)||this.targetSelf?.includes(t)&&Player.MemberNumber===e?.MemberNumber))}createButton(){const e=document.createElement("button");return e.id=this.id,e.name=`ABCL_${this.name}`,e.dataset.group="ItemArms",e.className="blank-button button button-styling HideOnPopup dialog-grid-button",e.innerHTML=`<img decoding="async" loading="lazy" src="${this.image}" class="button-image"><span class="button-label button-label-bottom">${this.name}</span>`,e.addEventListener("click",(e=>{const t=CurrentCharacter?.FocusGroup?CurrentCharacter:Player,s=t?.FocusGroup?.Name;this.onClick&&s&&(this.onClick(t,s),DialogLeave())})),e}static isInserted(e){return Boolean(document.getElementById(e))}}const yn=[Ns,Is,on,ln,un,hn,an,tn,gn,sn,Fs,Os,Rs,$s,Vs,Hs,Ys,Ws,Ks,Js,rn],bn=yn.reduce(((e,{command:t})=>t?[...e,t]:e),[]);yn.reduce(((e,{activity:t})=>t?[...e,t]:e),[]);const _n=(e,t,s)=>{const n={Type:"Hidden",Content:`${o}Msg`,Sender:Player.MemberNumber,Target:s,Dictionary:[{type:e,data:t}]};ServerSend("ChatRoomChat",n),console.log("sendDataToAction",e,t,s)},vn=e=>{console.log("sendUpdateMyData target",e),_n("sync",{settings:Player[o].Settings,stats:Player[o].Stats,version:r},e),s.debug({message:`Sending updated data to ${e??"everyone"}`})},An=async()=>{await async function(e,t=(()=>!1)){for(;!e();){if(t())return!1;await new Promise((e=>setTimeout(e,10)))}return!0}((()=>ServerSocket&&ServerIsConnected)),Ot.hookFunction("DrawCharacter",1,((e,t)=>{const[s,n,i,r]=e;if(Jt(s)&&s.ABCL.Stats.PuddleSize.value>0){const e=s.ABCL.Stats.PuddleSize.value/300,t=512*e,a=235*e;DrawImageResize("https://zoe-64.github.io/ABCL/versions/unstable/assets/puddle.png",n+(250*r-t/2),i+(940*r-a/2),t,a)}return t(e)})),Ot.hookFunction("ChatRoomSync",1,((e,t)=>(vn(),t(e)))),Ot.hookFunction("ChatRoomMessage",1,((e,t)=>"ServerEnter"===e[0].Content&&e[0].Sender===Player.MemberNumber?(_n("init",1),void s.debug("Requesting data from others.")):((e=>{if("ABCLMsg"!==e?.Content)return;if(!e.Sender||!e.Dictionary)return;if(e.Sender===Player.MemberNumber)return;if("Hidden"!==e.Type)return;if(!e.Dictionary[0]?.type)return;const t=e.Dictionary[0]?.type,s=e.Dictionary[0]?.data;for(const n of yn){const i=n.listeners?.[t];i&&i(e,s)}console.log("receivePacket",t,s,e.Sender)})(e[0]),t(e)))),Ot.hookFunction("CharacterAppearanceSetItem",1,((e,t)=>{let[s,n,i]=e;const r=t(e);return"ItemPelvis"===n&&i&&hs({Asset:i})&&bs(),r})),Ot.hookFunction("ActivityRun",1,((e,t)=>{const s=t(e),[n,r,a,o,...l]=e,c=o?.Activity;if(Player.ABCL.Settings.AccidentsByActivities&&r.MemberNumber===Player.MemberNumber&&c.Name in i){const e=i[c.Name];"Disabled"!==Player.ABCL.Settings.PeeMetabolism&&e.wetting&&Math.random()<e.wetting*(1+2*os.stats.Incontinence)&&os.attemptWetting(),"Disabled"!==Player.ABCL.Settings.PoopMetabolism&&e.messing&&Math.random()<e.messing*(1+2*os.stats.Incontinence)&&os.attemptSoiling()}return s})),Ot.hookFunction("PreferenceSubscreenChatClick",1,((e,t)=>{if(MouseIn(1815,75,90,90)){const e=Player.ChatSettings?.ColorTheme??"Light";e.startsWith("Light")&&Yt&&!Yt.classList.contains("sl-theme-light")&&(Yt.classList.remove("sl-theme-dark"),Yt.classList.add("sl-theme-light"),Yt.style.color="black",s.info("SL theme switching: Light")),e.startsWith("Dark")&&Yt&&!Yt.classList.contains("sl-theme-dark")&&(Yt.classList.remove("sl-theme-light"),Yt.classList.add("sl-theme-dark"),Yt.style.color="white",s.info("SL theme switching: Dark"))}return t(e)}))},Cn=[];window.addEventListener("error",(async e=>{if(console.error(e.filename),!e.filename.toLowerCase().includes("abcl"))return;const s=`${e.message} at ${e.filename} ${e.lineno}`;if(Cn.includes(s))return;Cn.push(s);const n={username:`${Player.Name} ${""===Player.Nickname?"":`aka ${Player.Nickname}`} (${Player.MemberNumber})`,thread_name:`${o} ${r} Error ${e.message}`.slice(0,100),content:`\n    error: ${s}\n\`\`\`\n${e.error.stack}\n\`\`\`\nmods: ${t.getModsInfo().map((e=>e.name)).join(", ")}`};await fetch("https://discord.com/api/webhooks/1340000414506029162/aqt7qruFnzDMM5BN_kLtv9gCcallIF-JeRVYl9k23uSIlxrHRvcFMy5mtPUPGDpWZhHX",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})}));var Pn,Sn,Mn,wn,Bn,Ln,kn,Nn,Dn,In,En,Fn={},Tn=[],On=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,xn=Array.isArray;function Rn(e,t){for(var s in t)e[s]=t[s];return e}function zn(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function $n(e,t,s,n,i){var r={type:e,props:t,key:s,ref:n,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:null==i?++Mn:i,__i:-1,__u:0};return null==i&&null!=Sn.vnode&&Sn.vnode(r),r}function Gn(e){return e.children}function Vn(e,t){this.props=e,this.context=t}function jn(e,t){if(null==t)return e.__?jn(e.__,e.__i+1):null;for(var s;t<e.__k.length;t++)if(null!=(s=e.__k[t])&&null!=s.__e)return s.__e;return"function"==typeof e.type?jn(e):null}function Hn(e){var t,s;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(s=e.__k[t])&&null!=s.__e){e.__e=e.__c.base=s.__e;break}return Hn(e)}}function Un(e){(!e.__d&&(e.__d=!0)&&wn.push(e)&&!Wn.__r++||Bn!==Sn.debounceRendering)&&((Bn=Sn.debounceRendering)||Ln)(Wn)}function Wn(){for(var e,t,s,n,i,r,a,o=1;wn.length;)wn.length>o&&wn.sort(kn),e=wn.shift(),o=wn.length,e.__d&&(s=void 0,i=(n=(t=e).__v).__e,r=[],a=[],t.__P&&((s=Rn({},n)).__v=n.__v+1,Sn.vnode&&Sn.vnode(s),Qn(t.__P,s,n,t.__n,t.__P.namespaceURI,32&n.__u?[i]:null,r,null==i?jn(n):i,!!(32&n.__u),a),s.__v=n.__v,s.__.__k[s.__i]=s,ei(r,s,a),s.__e!=i&&Hn(s)));Wn.__r=0}function qn(e,t,s,n,i,r,a,o,l,c,u){var d,h,p,m,g,f,y=n&&n.__k||Tn,b=t.length;for(l=function(e,t,s,n,i){var r,a,o,l,c,u=s.length,d=u,h=0;for(e.__k=new Array(i),r=0;r<i;r++)null!=(a=t[r])&&"boolean"!=typeof a&&"function"!=typeof a?(l=r+h,(a=e.__k[r]="string"==typeof a||"number"==typeof a||"bigint"==typeof a||a.constructor==String?$n(null,a,null,null,null):xn(a)?$n(Gn,{children:a},null,null,null):void 0===a.constructor&&a.__b>0?$n(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):a).__=e,a.__b=e.__b+1,o=null,-1!==(c=a.__i=Xn(a,s,l,d))&&(d--,(o=s[c])&&(o.__u|=2)),null==o||null===o.__v?(-1==c&&(i>u?h--:i<u&&h++),"function"!=typeof a.type&&(a.__u|=4)):c!=l&&(c==l-1?h--:c==l+1?h++:(c>l?h--:h++,a.__u|=4))):e.__k[r]=null;if(d)for(r=0;r<u;r++)null!=(o=s[r])&&!(2&o.__u)&&(o.__e==n&&(n=jn(o)),ni(o,o));return n}(s,t,y,l,b),d=0;d<b;d++)null!=(p=s.__k[d])&&(h=-1===p.__i?Fn:y[p.__i]||Fn,p.__i=d,f=Qn(e,p,h,i,r,a,o,l,c,u),m=p.__e,p.ref&&h.ref!=p.ref&&(h.ref&&si(h.ref,null,p),u.push(p.ref,p.__c||m,p)),null==g&&null!=m&&(g=m),4&p.__u||h.__k===p.__k?l=Yn(p,l,e):"function"==typeof p.type&&void 0!==f?l=f:m&&(l=m.nextSibling),p.__u&=-7);return s.__e=g,l}function Yn(e,t,s){var n,i;if("function"==typeof e.type){for(n=e.__k,i=0;n&&i<n.length;i++)n[i]&&(n[i].__=e,t=Yn(n[i],t,s));return t}e.__e!=t&&(t&&e.type&&!s.contains(t)&&(t=jn(e)),s.insertBefore(e.__e,t||null),t=e.__e);do{t=t&&t.nextSibling}while(null!=t&&8==t.nodeType);return t}function Xn(e,t,s,n){var i,r,a=e.key,o=e.type,l=t[s];if(null===l&&null==e.key||l&&a==l.key&&o===l.type&&!(2&l.__u))return s;if(n>(null==l||2&l.__u?0:1))for(i=s-1,r=s+1;i>=0||r<t.length;){if(i>=0){if((l=t[i])&&!(2&l.__u)&&a==l.key&&o===l.type)return i;i--}if(r<t.length){if((l=t[r])&&!(2&l.__u)&&a==l.key&&o===l.type)return r;r++}}return-1}function Kn(e,t,s){"-"==t[0]?e.setProperty(t,null==s?"":s):e[t]=null==s?"":"number"!=typeof s||On.test(t)?s:s+"px"}function Zn(e,t,s,n,i){var r;e:if("style"==t)if("string"==typeof s)e.style.cssText=s;else{if("string"==typeof n&&(e.style.cssText=n=""),n)for(t in n)s&&t in s||Kn(e.style,t,"");if(s)for(t in s)n&&s[t]===n[t]||Kn(e.style,t,s[t])}else if("o"==t[0]&&"n"==t[1])r=t!=(t=t.replace(Nn,"$1")),t=t.toLowerCase()in e||"onFocusOut"==t||"onFocusIn"==t?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+r]=s,s?n?s.t=n.t:(s.t=Dn,e.addEventListener(t,r?En:In,r)):e.removeEventListener(t,r?En:In,r);else{if("http://www.w3.org/2000/svg"==i)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!=t&&"height"!=t&&"href"!=t&&"list"!=t&&"form"!=t&&"tabIndex"!=t&&"download"!=t&&"rowSpan"!=t&&"colSpan"!=t&&"role"!=t&&"popover"!=t&&t in e)try{e[t]=null==s?"":s;break e}catch(e){}"function"==typeof s||(null==s||!1===s&&"-"!=t[4]?e.removeAttribute(t):e.setAttribute(t,"popover"==t&&1==s?"":s))}}function Jn(e){return function(t){if(this.l){var s=this.l[t.type+e];if(null==t.u)t.u=Dn++;else if(t.u<s.t)return;return s(Sn.event?Sn.event(t):t)}}}function Qn(e,t,s,n,i,r,a,o,l,c){var u,d,h,p,m,g,f,y,b,_,v,A,C,P,S,M,w,B=t.type;if(void 0!==t.constructor)return null;128&s.__u&&(l=!!(32&s.__u),r=[o=t.__e=s.__e]),(u=Sn.__b)&&u(t);e:if("function"==typeof B)try{if(y=t.props,b="prototype"in B&&B.prototype.render,_=(u=B.contextType)&&n[u.__c],v=u?_?_.props.value:u.__:n,s.__c?f=(d=t.__c=s.__c).__=d.__E:(b?t.__c=d=new B(y,v):(t.__c=d=new Vn(y,v),d.constructor=B,d.render=ii),_&&_.sub(d),d.props=y,d.state||(d.state={}),d.context=v,d.__n=n,h=d.__d=!0,d.__h=[],d._sb=[]),b&&null==d.__s&&(d.__s=d.state),b&&null!=B.getDerivedStateFromProps&&(d.__s==d.state&&(d.__s=Rn({},d.__s)),Rn(d.__s,B.getDerivedStateFromProps(y,d.__s))),p=d.props,m=d.state,d.__v=t,h)b&&null==B.getDerivedStateFromProps&&null!=d.componentWillMount&&d.componentWillMount(),b&&null!=d.componentDidMount&&d.__h.push(d.componentDidMount);else{if(b&&null==B.getDerivedStateFromProps&&y!==p&&null!=d.componentWillReceiveProps&&d.componentWillReceiveProps(y,v),!d.__e&&(null!=d.shouldComponentUpdate&&!1===d.shouldComponentUpdate(y,d.__s,v)||t.__v==s.__v)){for(t.__v!=s.__v&&(d.props=y,d.state=d.__s,d.__d=!1),t.__e=s.__e,t.__k=s.__k,t.__k.some((function(e){e&&(e.__=t)})),A=0;A<d._sb.length;A++)d.__h.push(d._sb[A]);d._sb=[],d.__h.length&&a.push(d);break e}null!=d.componentWillUpdate&&d.componentWillUpdate(y,d.__s,v),b&&null!=d.componentDidUpdate&&d.__h.push((function(){d.componentDidUpdate(p,m,g)}))}if(d.context=v,d.props=y,d.__P=e,d.__e=!1,C=Sn.__r,P=0,b){for(d.state=d.__s,d.__d=!1,C&&C(t),u=d.render(d.props,d.state,d.context),S=0;S<d._sb.length;S++)d.__h.push(d._sb[S]);d._sb=[]}else do{d.__d=!1,C&&C(t),u=d.render(d.props,d.state,d.context),d.state=d.__s}while(d.__d&&++P<25);d.state=d.__s,null!=d.getChildContext&&(n=Rn(Rn({},n),d.getChildContext())),b&&!h&&null!=d.getSnapshotBeforeUpdate&&(g=d.getSnapshotBeforeUpdate(p,m)),M=u,null!=u&&u.type===Gn&&null==u.key&&(M=ti(u.props.children)),o=qn(e,xn(M)?M:[M],t,s,n,i,r,a,o,l,c),d.base=t.__e,t.__u&=-161,d.__h.length&&a.push(d),f&&(d.__E=d.__=null)}catch(e){if(t.__v=null,l||null!=r)if(e.then){for(t.__u|=l?160:128;o&&8==o.nodeType&&o.nextSibling;)o=o.nextSibling;r[r.indexOf(o)]=null,t.__e=o}else for(w=r.length;w--;)zn(r[w]);else t.__e=s.__e,t.__k=s.__k;Sn.__e(e,t,s)}else null==r&&t.__v==s.__v?(t.__k=s.__k,t.__e=s.__e):o=t.__e=function(e,t,s,n,i,r,a,o,l){var c,u,d,h,p,m,g,f=s.props,y=t.props,b=t.type;if("svg"==b?i="http://www.w3.org/2000/svg":"math"==b?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),null!=r)for(c=0;c<r.length;c++)if((p=r[c])&&"setAttribute"in p==!!b&&(b?p.localName==b:3==p.nodeType)){e=p,r[c]=null;break}if(null==e){if(null==b)return document.createTextNode(y);e=document.createElementNS(i,b,y.is&&y),o&&(Sn.__m&&Sn.__m(t,r),o=!1),r=null}if(null===b)f===y||o&&e.data===y||(e.data=y);else{if(r=r&&Pn.call(e.childNodes),f=s.props||Fn,!o&&null!=r)for(f={},c=0;c<e.attributes.length;c++)f[(p=e.attributes[c]).name]=p.value;for(c in f)if(p=f[c],"children"==c);else if("dangerouslySetInnerHTML"==c)d=p;else if(!(c in y)){if("value"==c&&"defaultValue"in y||"checked"==c&&"defaultChecked"in y)continue;Zn(e,c,null,p,i)}for(c in y)p=y[c],"children"==c?h=p:"dangerouslySetInnerHTML"==c?u=p:"value"==c?m=p:"checked"==c?g=p:o&&"function"!=typeof p||f[c]===p||Zn(e,c,p,f[c],i);if(u)o||d&&(u.__html===d.__html||u.__html===e.innerHTML)||(e.innerHTML=u.__html),t.__k=[];else if(d&&(e.innerHTML=""),qn("template"===t.type?e.content:e,xn(h)?h:[h],t,s,n,"foreignObject"==b?"http://www.w3.org/1999/xhtml":i,r,a,r?r[0]:s.__k&&jn(s,0),o,l),null!=r)for(c=r.length;c--;)zn(r[c]);o||(c="value","progress"==b&&null==m?e.removeAttribute("value"):void 0!==m&&(m!==e[c]||"progress"==b&&!m||"option"==b&&m!==f[c])&&Zn(e,c,m,f[c],i),c="checked",void 0!==g&&g!==e[c]&&Zn(e,c,g,f[c],i))}return e}(s.__e,t,s,n,i,r,a,l,c);return(u=Sn.diffed)&&u(t),128&t.__u?void 0:o}function ei(e,t,s){for(var n=0;n<s.length;n++)si(s[n],s[++n],s[++n]);Sn.__c&&Sn.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){Sn.__e(e,t.__v)}}))}function ti(e){return"object"!=typeof e||null==e?e:xn(e)?e.map(ti):Rn({},e)}function si(e,t,s){try{if("function"==typeof e){var n="function"==typeof e.__u;n&&e.__u(),n&&null==t||(e.__u=e(t))}else e.current=t}catch(e){Sn.__e(e,s)}}function ni(e,t,s){var n,i;if(Sn.unmount&&Sn.unmount(e),(n=e.ref)&&(n.current&&n.current!==e.__e||si(n,null,t)),null!=(n=e.__c)){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(e){Sn.__e(e,t)}n.base=n.__P=null}if(n=e.__k)for(i=0;i<n.length;i++)n[i]&&ni(n[i],t,s||"function"!=typeof e.type);s||zn(e.__e),e.__c=e.__=e.__e=void 0}function ii(e,t,s){return this.constructor(e,s)}function ri(e,t,s){var n,i,r,a;t==document&&(t=document.documentElement),Sn.__&&Sn.__(e,t),i=(n="function"==typeof s)?null:s&&s.__k||t.__k,r=[],a=[],Qn(t,e=(!n&&s||t).__k=function(e,t,s){var n,i,r,a={};for(r in t)"key"==r?n=t[r]:"ref"==r?i=t[r]:a[r]=t[r];if(arguments.length>2&&(a.children=arguments.length>3?Pn.call(arguments,2):s),"function"==typeof e&&null!=e.defaultProps)for(r in e.defaultProps)void 0===a[r]&&(a[r]=e.defaultProps[r]);return $n(e,a,n,i,null)}(Gn,null,[e]),i||Fn,Fn,t.namespaceURI,!n&&s?[s]:i?null:t.firstChild?Pn.call(t.childNodes):null,r,!n&&s?s:i?i.__e:t.firstChild,n,a),ei(r,e,a)}Pn=Tn.slice,Sn={__e:function(e,t,s,n){for(var i,r,a;t=t.__;)if((i=t.__c)&&!i.__)try{if((r=i.constructor)&&null!=r.getDerivedStateFromError&&(i.setState(r.getDerivedStateFromError(e)),a=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(e,n||{}),a=i.__d),a)return i.__E=i}catch(t){e=t}throw e}},Mn=0,Vn.prototype.setState=function(e,t){var s;s=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=Rn({},this.state),"function"==typeof e&&(e=e(Rn({},s),this.props)),e&&Rn(s,e),null!=e&&this.__v&&(t&&this._sb.push(t),Un(this))},Vn.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),Un(this))},Vn.prototype.render=Gn,wn=[],Ln="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,kn=function(e,t){return e.__v.__b-t.__v.__b},Wn.__r=0,Nn=/(PointerCapture)$|Capture$/i,Dn=0,In=Jn(!1),En=Jn(!0);var ai=0;function oi(e,t,s,n,i,r){t||(t={});var a,o,l=t;if("ref"in l)for(o in l={},t)"ref"==o?a=t[o]:l[o]=t[o];var c={type:e,props:l,key:s,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--ai,__i:-1,__u:0,__source:i,__self:r};if("function"==typeof e&&(a=e.defaultProps))for(o in a)void 0===l[o]&&(l[o]=a[o]);return Sn.vnode&&Sn.vnode(c),c}function li(e,t){void 0===t&&(t={});var s=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===s&&n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}li(".ABCL-settings-page{height:79%;margin:5% 10dvw 0dvh 5dvw;overflow-y:auto}.ABCL-settings-title{margin-top:0;text-align:center;width:fit-content}.ABCL-divider{margin:1% 0}.ABCL-checkbox-group{display:flex;flex-wrap:wrap;font-size:.8em;gap:1.5vw}.ABCL-settings-section{margin-bottom:.7%;margin-top:2.1%}.ABCL-page-list{display:flex;flex-direction:column;gap:.5em;margin:1%;>*{border:1px solid #000;flex:1 1 auto;padding:10px;text-align:left}}.ABCL-contact-info{display:flex;flex-direction:column;gap:.5em;padding:1%;width:fit-content}.ABCL-settings-menu{display:flex;flex-direction:row;justify-content:space-between;width:56%;>section{display:flex;flex-direction:column;gap:.2em;padding:1%;>div>*{width:100%}}}.ABCL-button{background-color:#fff;border:1px solid #000;cursor:pointer;padding:.3em;white-space:nowrap;width:fit-content;&:hover{background-color:cyan}}");var ci,ui,di,hi,pi=0,mi=[],gi=Sn,fi=gi.__b,yi=gi.__r,bi=gi.diffed,_i=gi.__c,vi=gi.unmount,Ai=gi.__;function Ci(e,t){gi.__h&&gi.__h(ui,e,pi||t),pi=0;var s=ui.__H||(ui.__H={__:[],__h:[]});return e>=s.__.length&&s.__.push({}),s.__[e]}function Pi(e){return pi=1,function(e,t,s){var n=Ci(ci++,2);if(n.t=e,!n.__c&&(n.__=[s?s(t):Ni(void 0,t),function(e){var t=n.__N?n.__N[0]:n.__[0],s=n.t(t,e);t!==s&&(n.__N=[s,n.__[1]],n.__c.setState({}))}],n.__c=ui,!ui.__f)){var i=function(e,t,s){if(!n.__c.__H)return!0;var i=n.__c.__H.__.filter((function(e){return!!e.__c}));if(i.every((function(e){return!e.__N})))return!r||r.call(this,e,t,s);var a=n.__c.props!==e;return i.forEach((function(e){if(e.__N){var t=e.__[0];e.__=e.__N,e.__N=void 0,t!==e.__[0]&&(a=!0)}})),r&&r.call(this,e,t,s)||a};ui.__f=!0;var r=ui.shouldComponentUpdate,a=ui.componentWillUpdate;ui.componentWillUpdate=function(e,t,s){if(this.__e){var n=r;r=void 0,i(e,t,s),r=n}a&&a.call(this,e,t,s)},ui.shouldComponentUpdate=i}return n.__N||n.__}(Ni,e)}function Si(e,t){var s=Ci(ci++,3);!gi.__s&&function(e,t){return!e||e.length!==t.length||t.some((function(t,s){return t!==e[s]}))}(s.__H,t)&&(s.__=e,s.u=t,ui.__H.__h.push(s))}function Mi(){for(var e;e=mi.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Li),e.__H.__h.forEach(ki),e.__H.__h=[]}catch(t){e.__H.__h=[],gi.__e(t,e.__v)}}gi.__b=function(e){ui=null,fi&&fi(e)},gi.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),Ai&&Ai(e,t)},gi.__r=function(e){yi&&yi(e),ci=0;var t=(ui=e.__c).__H;t&&(di===ui?(t.__h=[],ui.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.u=e.__N=void 0}))):(t.__h.forEach(Li),t.__h.forEach(ki),t.__h=[],ci=0)),di=ui},gi.diffed=function(e){bi&&bi(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==mi.push(t)&&hi===gi.requestAnimationFrame||((hi=gi.requestAnimationFrame)||Bi)(Mi)),t.__H.__.forEach((function(e){e.u&&(e.__H=e.u),e.u=void 0}))),di=ui=null},gi.__c=function(e,t){t.some((function(e){try{e.__h.forEach(Li),e.__h=e.__h.filter((function(e){return!e.__||ki(e)}))}catch(s){t.some((function(e){e.__h&&(e.__h=[])})),t=[],gi.__e(s,e.__v)}})),_i&&_i(e,t)},gi.unmount=function(e){vi&&vi(e);var t,s=e.__c;s&&s.__H&&(s.__H.__.forEach((function(e){try{Li(e)}catch(e){t=e}})),s.__H=void 0,t&&gi.__e(t,s.__v))};var wi="function"==typeof requestAnimationFrame;function Bi(e){var t,s=function(){clearTimeout(n),wi&&cancelAnimationFrame(t),setTimeout(e)},n=setTimeout(s,100);wi&&(t=requestAnimationFrame(s))}function Li(e){var t=ui,s=e.__c;"function"==typeof s&&(e.__c=void 0,s()),ui=t}function ki(e){var t=ui;e.__c=e.__(),ui=t}function Ni(e,t){return"function"==typeof t?t(e):t}function Di({options:e,value:t,setValue:s,label:n}){return oi("div",{className:"ABCL-group",children:[oi("p",{children:n}),e.map(((e,n)=>oi("button",{className:`ABCL-group-button ${t===e&&"ABCL-group-button-selected"}`,onClick:()=>s(e),children:e},n)))]})}li(".ABCL-group-button{background-color:var(--tmd-element,#919191);border:1px solid var(--tmd-element,#262626);color:var(--tmd-text,#fff);cursor:pointer;padding:5px}.ABCL-group-button-selected{background-color:var(--tmd-accent,#000)}.ABCL-group{align-items:center;display:flex;padding:5px 0;width:fit-content}.ABCL-group p{margin-right:10px}");function Ii({checked:e,setChecked:t,label:s}){return oi("div",{className:"ABCL-checkbox",children:[oi("input",{type:"checkbox",checked:e,onChange:e=>t(e.target.checked)}),oi("p",{style:{marginLeft:"5px"},children:s})]})}function Ei({setPage:e}){const[t,s]=Pi(Player.ABCL.Settings.PeeMetabolism),[n,i]=Pi(Player.ABCL.Settings.PoopMetabolism),[r,a]=Pi(Player.ABCL.Settings.MentalRegressionModifier),[o,l]=Pi(Player.ABCL.Settings.OnDiaperChange);return oi("div",{className:"ABCL-settings-section",children:[oi("h2",{children:"Wet and Soiling"}),oi("button",{onClick:()=>e("menu"),className:"ABCL-exit-button"}),oi("div",{children:oi("div",{className:"ABCL-checkbox-group",children:[oi(Ii,{checked:Player.ABCL.Settings.PauseStats,setChecked:e=>Player.ABCL.Settings.PauseStats=e,label:"Pause Stats"}),oi(Ii,{checked:Player.ABCL.Settings.DisableWettingLeaks,setChecked:e=>Player.ABCL.Settings.DisableWettingLeaks=e,label:"Disable Wetting Leaks / Puddles"}),oi(Ii,{checked:Player.ABCL.Settings.DisableSoilingLeaks,setChecked:e=>Player.ABCL.Settings.DisableSoilingLeaks=e,label:"Disable Messy Leaks"}),oi(Ii,{checked:Player.ABCL.Settings.DisableClothingStains,setChecked:e=>Player.ABCL.Settings.DisableClothingStains=e,label:"Disable Clothing Stains"}),oi(Ii,{checked:Player.ABCL.Settings.DisableDiaperStains,setChecked:e=>Player.ABCL.Settings.DisableDiaperStains=e,label:"Disable Diaper Stains"}),oi(Ii,{checked:Player.ABCL.Settings.AccidentsByActivities,setChecked:e=>Player.ABCL.Settings.AccidentsByActivities=e,label:"Accidents by Activities (Experimental)"})]})}),oi(Di,{options:["Disabled","Slow","Normal","Fast","Faster","Fastest"],value:t,setValue:e=>{s(e),Player.ABCL.Settings.PeeMetabolism=e},label:"Pee Metabolism"}),oi(Di,{options:["Disabled","Slow","Normal","Fast","Faster","Fastest"],value:n,setValue:e=>{i(e),Player.ABCL.Settings.PoopMetabolism=e},label:"Poop Metabolism"}),oi(Di,{options:["Disabled","Slow","Normal","Fast","Faster","Fastest"],value:r,setValue:e=>{a(e),Player.ABCL.Settings.MentalRegressionModifier=e},label:"Regression Speed"}),oi(Di,{options:["Deny","Ask","Allow"],value:o,setValue:e=>{l(e),Player.ABCL.Settings.OnDiaperChange=e},label:"On Diaper Prompt"})]})}function Fi({setPage:e}){return oi("div",{children:[oi("button",{onClick:()=>e("menu"),className:"ABCL-exit-button"}),oi("div",{children:[oi("h2",{children:"Visible Messages to Players"}),oi("div",{className:"ABCL-checkbox-group",children:[oi(Ii,{checked:Player.ABCL.Settings.VisibleMessages.wetDiaper,setChecked:e=>Player.ABCL.Settings.VisibleMessages.wetDiaper=e,label:"Wetting Diapers"}),oi(Ii,{checked:Player.ABCL.Settings.VisibleMessages.wetClothing,setChecked:e=>Player.ABCL.Settings.VisibleMessages.wetClothing=e,label:"Wetting Clothes"}),oi(Ii,{checked:Player.ABCL.Settings.VisibleMessages.soilDiaper,setChecked:e=>Player.ABCL.Settings.VisibleMessages.soilDiaper=e,label:"Soiling Diapers"}),oi(Ii,{checked:Player.ABCL.Settings.VisibleMessages.soilClothing,setChecked:e=>Player.ABCL.Settings.VisibleMessages.soilClothing=e,label:"Soiling Clothes"}),oi(Ii,{checked:Player.ABCL.Settings.VisibleMessages.changeDiaper,setChecked:e=>Player.ABCL.Settings.VisibleMessages.changeDiaper=e,label:"Changing Diapers"}),oi(Ii,{checked:Player.ABCL.Settings.VisibleMessages.checkDiaper,setChecked:e=>Player.ABCL.Settings.VisibleMessages.checkDiaper=e,label:"Checking Diapers"}),oi(Ii,{checked:Player.ABCL.Settings.VisibleMessages.lickPuddle,setChecked:e=>Player.ABCL.Settings.VisibleMessages.lickPuddle=e,label:"Licking Puddles"}),oi(Ii,{checked:Player.ABCL.Settings.VisibleMessages.wipePuddle,setChecked:e=>Player.ABCL.Settings.VisibleMessages.wipePuddle=e,label:"Wiping Puddle"}),oi(Ii,{checked:Player.ABCL.Settings.VisibleMessages.usePotty,setChecked:e=>Player.ABCL.Settings.VisibleMessages.usePotty=e,label:"Using Potty"}),oi(Ii,{checked:Player.ABCL.Settings.VisibleMessages.useToilet,setChecked:e=>Player.ABCL.Settings.VisibleMessages.useToilet=e,label:"Using Toilet"}),oi(Ii,{checked:Player.ABCL.Settings.VisibleMessages.statusMessages,setChecked:e=>Player.ABCL.Settings.VisibleMessages.statusMessages=e,label:"Show Status Messages"})]})]}),oi("div",{children:[oi("h2",{children:"Visible Status Messages to Yourself"}),oi("div",{className:"ABCL-checkbox-group",children:[oi(Ii,{checked:Player.ABCL.Settings.StatusMessages.Wetness??!1,setChecked:e=>Player.ABCL.Settings.StatusMessages.Wetness=e,label:"Show wetness status message"}),oi(Ii,{checked:Player.ABCL.Settings.StatusMessages.Soiliness??!1,setChecked:e=>Player.ABCL.Settings.StatusMessages.Soiliness=e,label:"Show soiliness status message"}),oi(Ii,{checked:Player.ABCL.Settings.StatusMessages.Bladder??!1,setChecked:e=>Player.ABCL.Settings.StatusMessages.Bladder=e,label:"Show bladder status message"}),oi(Ii,{checked:Player.ABCL.Settings.StatusMessages.Bowel??!1,setChecked:e=>Player.ABCL.Settings.StatusMessages.Bowel=e,label:"Show bowel status message"}),oi(Ii,{checked:Player.ABCL.Settings.StatusMessages.Incontinence??!1,setChecked:e=>Player.ABCL.Settings.StatusMessages.Incontinence=e,label:"Show incontinence status message"}),oi(Ii,{checked:Player.ABCL.Settings.StatusMessages.MentalRegression??!1,setChecked:e=>Player.ABCL.Settings.StatusMessages.MentalRegression=e,label:"Show mental regression status message"}),oi(Ii,{checked:Player.ABCL.Settings.StatusMessages.PuddleSize??!1,setChecked:e=>Player.ABCL.Settings.StatusMessages.PuddleSize=e,label:"Show puddle size status message"})]})]})]})}li(".ABCL-checkbox{align-items:center;display:flex;padding:.7%;white-space:nowrap;width:fit-content}.ABCL-checkbox input{aspect-ratio:1/1;height:100%;width:auto}.ABCL-checkbox p{margin:.35%}");function Ti({setPage:e}){return oi("div",{children:[oi("button",{onClick:()=>e("menu"),className:"ABCL-exit-button"}),oi("div",{children:[oi("h1",{children:["ABCL ","2.1.0"]}),oi("p",{children:["An addon for ",oi("a",{href:"https://www.bondageprojects.com/club_game/",children:"Bondage Club"})," that adds ABDL features to the game."]}),oi("p",{children:["Made by ",oi("a",{href:"https://github.com/zoe-64",children:"Zoe"})," and ",oi("a",{href:"https://github.com/kjbro",children:"En (mama)"}),"."]}),oi("p",{children:["Thanks to",oi("div",{className:"ABCL-thanks-list",children:[oi("p",{children:[oi("a",{children:oi("span",{children:"Firefly"})})," ","- ",oi("span",{"data-reason":!0,children:"for the original idea"})]}),oi("p",{children:[oi("a",{href:"https://github.com/mochamaple",children:[oi("span",{"data-name":!0}),"Maple"]})," ","- ",oi("span",{"data-reason":!0,children:"for the mod plugin template"})]}),oi("p",{children:[oi("a",{href:"https://github.com/FurryZoi",children:[oi("span",{"data-name":!0}),"Zoi"]})," ","- ",oi("span",{"data-reason":!0,children:"for helping get themed to work"})]}),oi("p",{children:[oi("a",{href:"https://github.com/minimar",children:[oi("span",{"data-name":!0}),"minimar"]})," ","- ",oi("span",{"data-reason":!0,children:"for helping with typos"})]}),oi("p",{children:[oi("a",{href:"https://github.com/dDeepLb",children:[oi("span",{"data-name":!0}),"Deep (papa)"]})," ","- ",oi("span",{"data-reason":!0,children:"for helping with code review and testing"})]}),oi("p",{children:[oi("a",{href:"https://github.com/dynilath",children:[oi("span",{"data-name":!0}),"Da'Inihlus"]})," ","- ",oi("span",{"data-reason":!0,children:"for mod items architecture"})]}),oi("p",{children:[oi("a",{href:"https://github.com/tetris245",children:[oi("span",{"data-name":!0}),"Nemesea"]})," ","- ",oi("span",{"data-reason":!0,children:"for getting me started with modding in bc"})]}),oi("p",{children:[oi("a",{href:"https://github.com/littlesera",children:[oi("span",{"data-name":!0}),"Sera"]})," ","- ",oi("span",{"data-reason":!0,children:"for helping during the development process"})]})]})]}),oi("p",{children:["Source code available on ",oi("a",{href:"https://github.com/zoe-64/ABCL",children:"GitHub"}),"."]})]})]})}function Oi(){const[e,t]=Pi("menu");return Si((()=>{Xt()}),[e]),oi("div",{id:"ABCL-settings-page",className:"ABCL-hidden ABCL-settings-page",children:[oi("button",{onClick:()=>PreferenceSubscreenExtensionsExit(),className:"ABCL-exit-button"}),oi("div",{children:oi("h1",{className:"ABCL-settings-title",children:" ABCL Settings "})}),{menu:oi("div",{className:"ABCL-settings-menu",children:[oi("section",{children:[oi("h2",{children:"Menu"}),oi("div",{className:"ABCL-page-list ABCL-settings-section",children:[oi("button",{onClick:()=>t("messages"),className:"ABCL-button",children:"Messages"}),oi("button",{onClick:()=>t("stats"),className:"ABCL-button",children:"Stats"}),oi("button",{onClick:()=>t("about"),className:"ABCL-button",children:["About ABCL ","2.1.0"]})]})]}),oi("section",{children:[oi("h2",{children:"Support"}),oi("div",{className:"ABCL-contact-info ABCL-settings-section",id:"ABCL-contact-info",children:[oi("button",{onClick:()=>window.open("https://discord.gg/ENYGwmgDmQ","_blank"),className:"ABCL-button",children:"Join our Discord"}),oi("button",{onClick:()=>window.open("https://docs.google.com/forms/d/e/1FAIpQLSdOMGAEmOlFTpbcdkdn8b380p50WAE8qPux-45WvFM3qhf9_w/viewform","_blank"),className:"ABCL-button",children:"Give Feedback"})]})]})]}),messages:oi(Fi,{setPage:t}),stats:oi(Ei,{setPage:t}),about:oi(Ti,{setPage:t})}[e]]})}li(".ABCL-thanks-list{display:flex;flex-direction:column}");function xi({value:e,label:t,color:s="#FFFFFF",foreground:n="#000000",format:i=(e=>(100*e).toFixed(0))}){return oi("div",{class:"value-bar no-resize",children:[oi("div",{style:{background:n,width:"100%",height:"10px"},children:oi("div",{style:{background:s,width:100*e+"%",height:"100%"}})}),oi("p",{class:"value-bar-label",children:t}),oi("p",{class:"value-bar-value",children:[i(e),"%"]})]})}li("");function Ri(){const[e,t]=Pi((()=>ChatRoomCharacter.filter((e=>Jt(e))))),[s,n]=Pi(0);Si((()=>(Ut.setState=()=>{},Ut.setMemberNumber=n,()=>{Ut.setState=()=>{},Ut.setMemberNumber=()=>{}})),[]);const i=Kt(s),r=i&&Jt(i),a=r?i.ABCL.Stats.MentalRegression.value:0,o=r?i.ABCL.Stats.Incontinence.value:0,l=r?i.ABCL.Stats.Soiliness.value/_s(i):0,c=r?i.ABCL.Stats.Wetness.value/_s(i):0,u=r?i.ABCL.Stats.Bowel.value/i.ABCL.Stats.Bowel.size:0,d=r?i.ABCL.Stats.Bladder.value/i.ABCL.Stats.Bladder.size:0,h=!!r&&i.ABCL.Settings.PauseStats;return Si((()=>{Xt()}),[s]),oi("div",{className:"ABCL-hidden",id:"ABCL-stats",children:[oi("div",{className:"ABCL-stats-overlay",onClick:()=>document.getElementById("ABCL-stats")?.classList.add("ABCL-hidden")}),oi("div",{className:"ABCL-stats-panel",id:"ABCL-stats-panel",children:[oi("select",{class:"ABCL-stats-select",onClick:()=>{t(ChatRoomCharacter.filter((e=>Jt(e))))},value:s,onChange:e=>{n(parseInt(e.target.value))},children:e.map((e=>oi("option",{value:e.MemberNumber,children:Qt(e.MemberNumber)},e.MemberNumber)))}),oi("div",{className:"ABCL-stats-container",children:[oi(xi,{value:o,label:"Incontinence",color:"#cb5b5bff",foreground:"#eeacacff"}),oi(xi,{value:a,label:"Mental Regression",color:"#ad74beff",foreground:"#e6bff1ff"}),oi(xi,{value:l,label:"Soiliness",color:"#ab674aff",foreground:"#d1aa98ff"}),oi(xi,{value:c,label:"Wetness",color:"#e7c463ff",foreground:"#f3e1aeff"}),oi(xi,{value:u,label:"Bowel Fullness",color:"#7c4c36ff",foreground:"#b7795cff"}),oi(xi,{value:d,label:"Bladder Fullness",color:"#cba01eff",foreground:"#eacd73ff"}),oi("p",{children:[oi("span",{children:"Stats: "}),oi("span",{children:h?"Paused":"Active"})]}),oi("button",{onClick:()=>Xt(),children:"Refresh"})]})]})]})}li(".ABCL-stats-overlay{height:100%;left:0;position:absolute;top:0;width:100%}.ABCL-stats-panel{background-color:var(--tmd-element,#fff)}.ABCL-stats-select{background-color:#f9f9f9;border:1px solid #ccc;border-radius:.35%;color:#333;margin:8%;padding:.7%;width:84%}.ABCL-stats-container{display:flex;flex-direction:column;font-size:.5em;gap:1em;padding:8%}");function zi(){return oi(Gn,{children:[oi(Ri,{}),oi(Oi,{})]})}li(".ABCL-hidden{display:none!important}.ABCL-overlay{pointer-events:none;z-index:1}.ABCL-overlay *{pointer-events:fill}.ABCL-exit-button{background-color:#fff;background-image:url(Icons/Exit.png);background-position:50%;background-repeat:no-repeat;background-size:contain;border:1px solid #000;cursor:pointer;:hover{background-color:cyan}}#fusam-addon-manager-container{position:absolute;top:0}");const $i=async()=>{ri(oi(zi,{}),Yt),PreferenceRegisterExtensionSetting({Identifier:"ABCL",ButtonText:`${a} Settings`,Image:"https://zoe-64.github.io/ABCL/versions/unstable/assets/abcl.png",run:()=>{},click:()=>{},exit:()=>(Ht(document.body,"#ABCL-settings-page").classList.add("ABCL-hidden"),Tt(),!0),load:()=>{Ht(document.body,"#ABCL-settings-page").classList.remove("ABCL-hidden"),Xt()}})};Ot.hookFunction("TextLoad",5,((e,t)=>"WetMinigame"===CurrentScreen||"MessMinigame"===CurrentScreen?void 0:t(e)));function Gi(e){var t=e.name;console.log("Registering minigame: "+t),window[t+"Run"]=()=>e.Run(),window[t+"Click"]=()=>e.Click(),window[t+"Load"]=()=>e.Load(),window[t+"Unload"]=()=>e.Unload(),window[t+"Resize"]=()=>e.Resize(),window[t+"KeyDown"]=()=>e.KeyDown(),window[t+"Exit"]=()=>e.Exit(),window[t+"End"]=t=>e.End(t)}class Vi{constructor(){this.name=""}Load(){}Unload(){}Resize(){}KeyDown(){}Exit(){}End(e){}}class ji extends Vi{constructor(){super(...arguments),this.startText="",this.hintText="",this.failText="",this.successText="",this.tintColor=[{r:0,g:0,b:0,a:0}],this.GameStartTime=0,this.GameEndTime=0,this.StartDelay=4e3,this.AccidentVelocity=0,this.AccidentPosition=0,this.AccidentAcceleration=0,this.AccidentMaxPosition=100,this.AccidentGameDuration=5e3,this.AccidentNextTick=0,this.AccidentText="",this.AccidentChallenge=0,this.BaseGameLength=6e3}End(e){CommonSetScreen("Online","ChatRoom"),MiniGameVictory=e,MiniGameEnded=!0,MiniGameTimer=CommonTime(),this.GameEndTime=MiniGameTimer}get IsStartDelay(){return CommonTime()<this.GameStartTime}Load(){if(DrawFlashScreen("#000000",750,1e3),this.GameStartTime=CommonTime()+this.StartDelay,this.AccidentVelocity=0,this.AccidentAcceleration=0,"number"!=typeof MiniGameDifficulty)MiniGameTimer=CommonTime()+this.BaseGameLength,this.AccidentChallenge=5;else{var e=.25*(MiniGameDifficulty-8);this.AccidentGameDuration=this.BaseGameLength+1e3*e,MiniGameTimer=this.GameStartTime+this.AccidentGameDuration,this.AccidentChallenge=MiniGameDifficulty}this.AccidentMaxPosition=400,this.AccidentPosition=this.AccidentMaxPosition,console.info("Accident minigame started: difficulty - "+this.AccidentChallenge+" time - "+this.AccidentGameDuration),CharacterSetFacialExpression(Player,"Eyes","Daydream",10),this.AccidentChallenge>25?CharacterSetFacialExpression(Player,"Blush","ShortBreath",10):CharacterSetFacialExpression(Player,"Blush","Low",10)}get IsGameActive(){return CommonTime()<MiniGameTimer&&!MiniGameEnded&&!this.GameFailed}get IsGameTimeout(){return CommonTime()>=MiniGameTimer&&!MiniGameEnded}get IsEndGameReport(){return CommonTime()<this.GameEndTime+5e3}get GameFailed(){return this.AccidentPosition<=0}RunGame(e){var t=(this.AccidentGameDuration+CommonTime()-MiniGameTimer)/1e3;CommonTime()>this.AccidentNextTick&&(this.AccidentNextTick=CommonTime()+400,this.AccidentAcceleration=-1.25*this.AccidentChallenge-t*Math.random()),this.AccidentVelocity=Math.min(this.AccidentVelocity,this.AccidentVelocity+.25*this.AccidentAcceleration),this.AccidentPosition>=this.AccidentMaxPosition&&(this.AccidentVelocity=Math.min(0,this.AccidentVelocity)),this.AccidentPosition>0&&(this.AccidentPosition+=this.AccidentVelocity/1e3*e*3.5),this.AccidentPosition=Math.max(0,Math.min(this.AccidentPosition,this.AccidentMaxPosition)),DrawProgressBar(500-this.AccidentMaxPosition,800,2*this.AccidentMaxPosition,50,this.AccidentPosition/this.AccidentMaxPosition*100),DrawText(this.hintText,500,875,"white","black")}Run(){ChatRoomRun(CommonTime()),this.IsStartDelay?DrawText(this.startText,500,500,"white","black"):this.IsGameActive?this.RunGame(TimerRunInterval):!this.IsGameTimeout&&!this.GameFailed||MiniGameEnded||(this.End(this.AccidentPosition>0),MiniGameEnd())}Click(){var e;this.IsGameActive&&(this.AccidentVelocity=Math.max(this.AccidentVelocity+(e=11,Math.floor(Math.random()*e)+5),20))}}class Hi extends ji{constructor(){super(...arguments),this.startText="A sudden pressure builds within you...",this.hintText="Click to maintain control. Keep it together!",this.failText="Oops! You've had an accident!",this.successText="Crisis averted! You stayed composed!",this.name="MessMinigame"}End(e){if(super.End(e),e)return os.stats.Incontinence-=Ms(os.stats.Incontinence)/2,void Rt("You managed to keep it together!");os.soil(),os.onAccident()}}class Ui extends ji{constructor(){super(...arguments),this.startText="You feel a trickle starting...",this.hintText="Click to squeeze tight. Don't let it get away!",this.failText="Oh no! You lost control!",this.successText="You held it in! Phew!",this.name="WetMinigame"}End(e){if(super.End(e),e)return os.stats.Incontinence-=Ms(os.stats.Incontinence)/2,Rt("You managed to hold it in!"),void CharacterSetFacialExpression(Player,"Mouth","Happy",20);CharacterSetFacialExpression(Player,"Blush","Low",10),CharacterSetFacialExpression(Player,"Eyes","Surprised",9),os.wet(),os.onAccident()}}window.clearData=()=>{Player.ExtensionSettings.ABCL="N4XyA===",ServerPlayerExtensionSettingsSync("ABCL"),s.warn("cleared data")},window.saveData=Tt,window.mutateData=e=>{Player.ABCL=Dt(Player.ABCL||Ft,e),Tt()},window.updateDiaperColor=bs,window.noOp=()=>{},window.sendChatLocal=Rt,window.averageColor=ms;let Wi,qi=class{constructor(e){this.hookMng=e,this.workList=[]}run(e,t){let s,n=!1;for(const i of this.workList)if("inject"===i.value)i.work(e,t);else if("next"===i.value)s=t(e),n=!0;else if("override"===i.value)s=i.work(e,t),n=!0;else if("flag"===i.value){if(!i.flag)break;i.once&&(i.flag=!1)}else if("check"===i.value&&!i.work(e,t))break;return n?s:t(e)}next(){return this.workList.push({value:"next"}),this}inject(e){return this.workList.push({value:"inject",work:e}),this}inside(e,{once:t=!1,priority:s=1}={}){const n={value:"flag",flag:!1,once:t};return this.hookMng.hookFunction(e,s,((e,t)=>{n.flag=!0;const s=t(e);return n.flag=!1,s})),this.workList.push(n),this}when(e){return this.workList.push({value:"check",work:e}),this}override(e){return this.workList.push({value:"override",work:e}),this}},Yi=class{static info(e){Wi?.info(e)}static warn(e){Wi?.warn(e)}static error(e){Wi?.error(e)}},Xi=class{constructor(e=!1){this.done=e,this.list=[]}run(){for(this.done=!0;this.list.length>0;)this.list.shift()()}push(e){this.done?e():this.list.push(e)}};const Ki=new Xi,Zi=new Xi,Ji=new Xi,Qi=new Xi;function er(){return null!=globalThis.Player&&"number"==typeof globalThis.Player.MemberNumber}let tr;const sr=new class{get mod(){return tr}push(e,t){e.push(t)}init(e){tr=t.registerMod(e),Qi.run(),Zi.run();const s=()=>Ji.run();er()?s():this.mod.hookFunction("LoginResponse",0,((e,t)=>{t(e),er()&&s()})),Ki.run()}initWithMod(e){tr=e,Qi.run(),Zi.run();const t=()=>Ji.run();er()?t():this.mod.hookFunction("LoginResponse",0,((e,s)=>{s(e),er()&&t()}))}afterInit(e){this.push(Ki,e)}afterPlayerLogin(e){this.push(Ji,e)}patchFunction(e,t){this.push(Qi,(()=>this.mod.patchFunction(e,t)))}invokeOriginal(e,...t){return this.mod?this.mod.callOriginal(e,t):globalThis[e]?.(...t)}hookFunction(e,t,s){this.push(Zi,(()=>this.mod.hookFunction(e,t,s)))}progressiveHook(e,t=1){const s=new qi(this);return this.hookFunction(e,t,((e,t)=>s.run(e,t))),s}hookPlayerFunction(e,t,s){var n;n=()=>this.mod.hookFunction(e,t,s),er()?Ji.push(n):n()}globalFunction(e,t){"function"!=typeof t&&Yi.warn("globalFunction: param is not a function"),null==globalThis[e]?globalThis[e]=t:globalThis[e]!=t&&Yi.warn(`globalFunction: ${e} is already defined`)}randomGlobalFunction(e,t){const s=e=>e+Math.random().toString(16).substring(2);let n=s(e);for(;null!=globalThis[n];)n=s(e);return globalThis[n]=t,n}setLogger(e){!function(e){Wi=e}(e)}},nr=new Set(["ItemTorso","ItemTorso2"]),ir={ItemTorso:nr,ItemTorso2:nr},rr={},ar={};function or(e){return(ir[e]&&Array.from(ir[e])||[e]).map((e=>lr(e)))}function lr(e){return{name:e,group:AssetGroupGet("Female3DCG",e)}}function cr(e){return rr[e]}class ur{static add(e){for(const[t,s]of Object.entries(e))for(const[e,n]of Object.entries(s))or(t).forEach((({name:t})=>{AssetFemale3DCGExtended[t]||(AssetFemale3DCGExtended[t]={}),AssetFemale3DCGExtended[t][e]||(AssetFemale3DCGExtended[t][e]=n)}))}static get value(){return AssetFemale3DCGExtended}}const dr={};class hr{static add(e,t){return 0===Object.keys(dr).length&&AssetFemale3DCG.forEach((e=>{dr[e.Group]||(dr[e.Group]={});for(const t of e.Asset){const s=pr(t);dr[e.Group][s.Name]=s}})),dr[e]||(dr[e]={}),dr[e][t.Name]=t,dr}static get value(){return dr}}function pr(e){return"string"==typeof e?{Name:e}:e}function mr(e){return globalThis[e]}let gr=class e{static _initStorage(){var e,t;mr(this._namespace)||(e=this._namespace,t={},globalThis[e]=t)}static get(e,t){this._initStorage();const s=mr(this._namespace);return e in s||(s[e]=t()),s[e]}static getMayOverride(e,t){this._initStorage();const s=mr(this._namespace);return s[e]=t(s[e]),s[e]}static set(e,t){this._initStorage(),mr(this._namespace)[e]=t}static has(e){return this._initStorage(),e in mr(this._namespace)}static delete(e){this._initStorage();const t=mr(this._namespace);return e in t&&delete t[e]}static setImplementation(t){const s=["get","set","has","delete"];for(const n of s){if("function"!=typeof t[n])throw new Error(`Implementation must provide a '${n}' function`);e[n]=t[n]}}static createNamespace(t){return{get:(s,n)=>e.get(`${t}.${s}`,n),getMayOverride:(s,n)=>e.getMayOverride(`${t}.${s}`,n),set:(s,n)=>e.set(`${t}.${s}`,n),has:s=>e.has(`${t}.${s}`),delete:s=>e.delete(`${t}.${s}`)}}};gr._namespace="__BC_LUZI_GLOBALS__",gr.createNamespace("OnceFlag");const fr=gr.createNamespace("AssetManagerPatchOnce");function yr(){return fr}const br={},_r={},vr=(e,t)=>_r[e]?.[t];function Ar(){return _r}function Cr(e){return!!(e&&e.Asset&&vr(e.Asset.Group.Name,e.Asset.Name))}function Pr(e,t){const s="TW"!==TranslationLanguage?TranslationLanguage:"CN";let n=e(s);return void 0!==n?n:(n="CN"===s?e("CN"):e("EN")||e("CN"),void 0!==n?n:t)}function Sr(e,t){return Pr((t=>e[t]),t)}function Mr(e,t,s){return Pr((s=>e[s]?.[t]),s)}function wr(e){return Sr(e,e.CN)}function Br(e,t){return e?e.CN?e:{...e,CN:t}:{CN:t}}function Lr(e,t,s){const n={};for(const[i,r]of Object.entries(s))r[e]?.[t]&&(n[i]=r[e][t]);return n}const kr={},Nr={};class Dr{static setAsset(e,t,s){Object.entries(s).forEach((([s,n])=>{const i=s;kr[i]||(kr[i]={}),kr[i][e]||(kr[i][e]={}),kr[i][e][t]=n}))}static setGroup(e,t){Object.entries(t).forEach((([t,s])=>{const n=t;Nr[n]||(Nr[n]={}),Nr[n][e]=s}))}}function Ir(e,t){e.Description=t}function Er(){Object.values(br).forEach((e=>Ir(e,function(e){return Mr(Nr,e,e.replace(/_.*?Luzi$/,""))}(e.Name)))),Object.values(Ar()).map((e=>Object.values(e))).flat().forEach((e=>Ir(e,function(e,t){return s=kr,n=e,i=t,Pr((e=>s[e]?.[n]?.[i]),t.replace(/_.*?Luzi$/,""));var s,n,i}(e.Group.Name,e.Name)))),Object.entries(Ar()).map((([e,t])=>({group:cr(e),asset:t}))).filter((({group:e})=>!!e)).map((({group:e,asset:t})=>Object.entries(t).map((([t,s])=>({asset:s,fromAsset:AssetGet("Female3DCG",e,t)}))))).flat().filter((({fromAsset:e})=>!!e)).forEach((({asset:e,fromAsset:t})=>Ir(e,t.Description)));const e=TextAllScreenCache.get(AssetStringsPath),t=e=>{const t=ar,s=new Set,n=AssetGroup.map((e=>e.Name)).sort(((e,t)=>t.length-e.length));Object.entries(e.cache).forEach((([i,r])=>{if(s.has(i))return;const a=n.find((e=>i.startsWith(e)));if(!a)return;s.add(i);const o=t[a];if(!o)return;const l=i.slice(a.length);o.forEach((t=>{const s=t+l;e.cache[s]||(e.cache[s]=r)}))}))};e&&(e.loaded?t(e):e.rebuildListeners.push((e=>e&&t(e))))}let Fr=!1;const Tr=new Map;let Or;function xr(e,t,s,n=!1){if(Or?.()?.cache){if(Or().cache[e]&&n)return;Or().cache[e]=Sr(t,s)}else{if(n&&Tr.has(e))return;Tr.set(e,{desc:t,fallback:s,noOverride:n})}}const Rr=e=>t=>Object.entries(e||{CN:{[t]:t}}).map((([e,s])=>[e,s[t]||e])).reduce(((e,[t,s])=>(e[t]=s,e)),{});function zr(e,t,{entries:s,noOverride:n}={}){const i=Rr(s);t.Layer?.forEach((({Name:s})=>{s?xr(`${e}${t.Name}${s}`,i(s),s,!!n):xr(`${e}${t.Name}`,{CN:t.Name.replace(/_.*?Luzi$/,"")},t.Name,!!n)}))}let $r;class Gr{static info(e){$r?.info(e)}static warn(e){$r?.warn(e)}static error(e){$r?.error(e)}}let Vr=!1;const jr=[];function Hr(e){Vr?e():jr.push(e)}const Ur={},Wr={};function qr(e,t){const s=AssetGroupGet("Female3DCG",e);Vr&&s?t(s):(Wr[e]||(Wr[e]=[]),Wr[e].push(t))}let Yr=!1;const Xr=[];function Kr(e){Yr?e():Xr.push(e)}const Zr=new Set;function Jr(e,t,{extendedConfig:s,description:n,dynamicName:i,preimage:r,noMirror:a}={}){!function(e,t){const s=AssetGroupGet("Female3DCG",e);Vr&&s?t(s):(Ur[e]||(Ur[e]=[]),Ur[e].push(t))}(e,(e=>{hr.add(e.Name,t),s&&ur.add(s)}));const o=e;!function(e,t,s){const n=s=>{const i=t?[lr(e)]:or(e),r=i.find((({group:e})=>!e));if(r)return Zr.has(r.name)?void console.error(`[AssetManager] Required group "${r.name}" not found`):(Zr.add(r.name),void qr(r.name,(()=>n(s))));i.forEach((({group:e})=>s(e)))};Vr?n(s):qr(e,(()=>n(s)))}(e,!!a,(e=>{const s=e.Name,a=pr(t),l=AssetResolveCopyConfig.AssetDefinition(a,s,hr.value);if(!l)return;const c=Br(n,l.Name.replace(/_.*?Luzi$/,""));void 0!==Ar()[s]?.[a.Name]&&console.warn(`[AssetManager] Asset {${s}:${a.Name}} already existed!`),function(...[e,t,s]){sr.invokeOriginal("AssetAdd",e,t,s);const n=e.Name,i=t.Name;_r[n]||(_r[n]={});const r=AssetGet("Female3DCG",n,i);return r?(_r[n][i]=r,Promise.resolve(r)):Promise.reject(`Asset ${n}:${i} not found`)}(e,l,ur.value).then((e=>{if(e.DynamicGroupName===e.Group.Name&&(e.DynamicGroupName=i||o),r){const t=AssetGet("Female3DCG",r.Name,l.Name);t&&(e.Description=t.Description,e.DynamicGroupName=t.DynamicGroupName,["ScriptDraw","BeforeDraw","AfterDraw"].filter((e=>t[`Dynamic${e}`])).forEach((e=>function(e,t,s,n){const i=`Assets${t}${s.Name}${n}`,r=`Assets${e}${s.Name}${n}`;globalThis[i]&&(globalThis[r]=globalThis[i])}(s,r.Name,l,e))))}else e.Description=wr(c),zr(e.DynamicGroupName,l,{noOverride:!0})})),Dr.setAsset(s,l.Name,c)}))}const Qr={};function ea(e,{description:t,dynamicName:s,preimage:n}={}){Hr((()=>{const i=Br(t,e.Group.replace(/_.*?Luzi$/,""));(function(...[e,t]){const s=sr.invokeOriginal("AssetGroupAdd",e,t);return br[s.Name]=s,Promise.resolve(s)})("Female3DCG",e).then((t=>{t.Description=wr(i),s&&(t.DynamicGroupName=s),e.Asset.forEach((t=>{Jr(e.Group,pr(t),{dynamicName:s,preimage:n})}))})),Dr.setGroup(e.Group,i)}))}const ta=new Set;function sa(e,t,s){const n=()=>{const i=AssetFemale3DCG.find((e=>e.Group===t)),r=AssetGroupGet("Female3DCG",t),a=AssetFemale3DCGExtended[t];if(!i||!r)return ta.has(t)?void console.error(`[AssetManager] Group ${t} not found`):(ta.add(t),void Hr(n));var o,l;l=e,ir[o=t]||(ir[o]=new Set([o])),ir[o].add(l),ar[o]||(ar[o]=new Set),ar[o].add(l),rr[l]=o;const c=Br(s,e.replace(/_.*?Luzi$/,""));ea({...i,Group:e,Default:!1,Random:!1},{description:c,dynamicName:i.DynamicGroupName||i.Group,preimage:r}),AssetFemale3DCGExtended[e]=a};Hr(n)}const na={};let ia,ra=!1,aa=!1;function oa(e){return globalThis[e]}class la{static _initStorage(){var e,t;oa(this._namespace)||(e=this._namespace,t={},globalThis[e]=t)}static get(e,t){this._initStorage();const s=oa(this._namespace);return e in s||(s[e]=t()),s[e]}static getMayOverride(e,t){this._initStorage();const s=oa(this._namespace);return s[e]=t(s[e]),s[e]}static set(e,t){this._initStorage(),oa(this._namespace)[e]=t}static has(e){return this._initStorage(),e in oa(this._namespace)}static delete(e){this._initStorage();const t=oa(this._namespace);return e in t&&delete t[e]}static setImplementation(e){const t=["get","set","has","delete"];for(const s of t){if("function"!=typeof e[s])throw new Error(`Implementation must provide a '${s}' function`);la[s]=e[s]}}static createNamespace(e){return{get:(t,s)=>la.get(`${e}.${t}`,s),getMayOverride:(t,s)=>la.getMayOverride(`${e}.${t}`,s),set:(t,s)=>la.set(`${e}.${t}`,s),has:t=>la.has(`${e}.${t}`),delete:t=>la.delete(`${e}.${t}`)}}}function ca(e){return new Promise((t=>setTimeout(t,e)))}la._namespace="__BC_LUZI_GLOBALS__",la.createNamespace("OnceFlag");class ua{static get emptyImage(){return"data:img/jpg;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACXBIWXMAAC4jAAAuIwF4pT92AAAA\nG3RFWHRTb2Z0d2FyZQBDZWxzeXMgU3R1ZGlvIFRvb2zBp+F8AAAADUlEQVQI12P4//8/AwAI/AL+\nXJ/P2gAAAABJRU5ErkJggg=="}static assetPreviewIconPath(e){const t="Asset"in e?e.Asset:e;return`${AssetGetPreviewPath(t)}/${t.Name}.png`}static activityPreviewIconPath(e){return`Assets/Female3DCG/Activity/${("Activity"in e?e.Activity:e).Name}.png`}}const da=new class{constructor(){this.basic={},this.custom={}}addImgMapping(e){this.custom={...this.custom,...e}}setBasicImgMapping(e){this.basic={...e,...this.basic}}mapImgSrc(e){if("string"!=typeof e)return e;if(!e.endsWith(".png"))return e;if(e.startsWith("data:image"))return e;if(e.startsWith("http"))return e;const t=e.startsWith("./")?e.slice(2):e;let s=t;return this.custom[s]&&(s=this.custom[s]),this.basic[s]&&(s=this.basic[s]),s!==t?s:e}mapImg(e,t){let s=e;s.startsWith("data:image")||s.startsWith("http")||(this.custom[s]&&(s=this.custom[s]),this.basic[s]&&(s=this.basic[s]),s!==e&&t(s))}};class ha{constructor(){sr.patchFunction("GLDrawLoadImage",{"Img.src = url;":'Img.crossOrigin = "Anonymous";\n\t\tImg.src = url;'}),["DrawImageEx","DrawImageResize","GLDrawImage","DrawGetImage"].forEach((e=>{sr.hookFunction(e,0,((e,t)=>(e[0]=da.mapImgSrc(e[0]),t(e))))})),(async()=>{await function(e,t=100){return(async()=>{for(;!e();)await ca(t)})()}((()=>void 0!==globalThis.ElementButton)),sr.hookFunction("ElementButton.CreateForAsset",0,((e,t)=>(da.mapImg(ua.assetPreviewIconPath(e[1]),(t=>{e[4]={...e[4],image:t}})),t(e)))),sr.hookFunction("ElementButton.CreateForActivity",0,((e,t)=>{const s=e[1],n=s.Item?ua.assetPreviewIconPath(s.Item.Asset):`Assets/Female3DCG/Activity/${s.Activity.Name}.png`;return da.mapImg(n,(t=>{e[4]={...e[4],image:t}})),t(e)}));const e=sr.randomGlobalFunction("mapImage",(e=>da.mapImgSrc(e)));sr.patchFunction("ElementButton._ParseIcons",{"src = `./Assets/Female3DCG/ItemMisc/Preview/${icon}.png`":`src = ${e}(\`./Assets/Female3DCG/ItemMisc/Preview/\${icon}.png\`)`})})()}addImgMapping(e){da.addImgMapping(e)}setBasicImgMapping(e){da.setBasicImgMapping(e)}}const pa=la.get("ImageMapping",(()=>new ha)),ma=new class{addAsset(e,t,s,n,i=!1){Jr(e,t,{extendedConfig:s&&{[e]:{[t.Name]:s}},description:n,noMirror:i})}addGroupedAssets(e,t,s){for(const[n,i]of Object.entries(e))for(const e of i){const i=n,r=t&&Lr(i,e.Name,t);Jr(i,e,{extendedConfig:s&&s[i]?.[e.Name]&&{[i]:{[e.Name]:s[i][e.Name]}},description:r})}}addGroupedConfig(e){!function(e){e&&ur.add(e)}(e)}modifyAsset(e,t,s){!function(e,t,s){const n=i=>{const r=AssetGet("Female3DCG",i.Name,t);if(r)s(i,r);else{if(Qr[e]||(Qr[e]=new Set),Qr[e].has(t))return void console.error(`[AssetManager] Asset ${e}:${t} not found`);Qr[e].add(t),qr(e,n)}};qr(e,n)}(e,t,s)}modifyAssetLayers(e,t){!function(e,t){Kr((()=>{Asset.filter(e).forEach((e=>{e.Layer.forEach((s=>t(e,s)))}))}))}(e,t)}modifyGroup(e,t){!function(e,t){qr(e,(e=>t(e)))}(e,t)}addCustomDialog(e){!function(e){for(const[t,s]of Object.entries(e)){na[t]||(na[t]={});for(const[e,n]of Object.entries(s))na[t][e]=n,e.includes("ItemTorso2")?na[t][e.replace("ItemTorso2","ItemTorso")]=n:e.includes("ItemTorso")&&(na[t][e.replace("ItemTorso","ItemTorso2")]=n)}}(e)}addImageMapping(e){pa.addImgMapping(e)}get imageMapping(){return pa}addGroup(e,t){ea(e,{description:t})}addCopyGroup(e,t,s){sa(e,t,s)}addLayerNames(e,t,s){zr(e,t,{entries:s})}addLayerNamesByEntry(e,t,s){!function(e,t,s,n=!0){const i=Rr(s);new Set(Object.entries(s).map((([e,t])=>Object.keys(t))).flat()).forEach((s=>{xr(`${e}${t}${s}`,i(s),s,!!n)}))}(e,t,s)}assetIsCustomed(e){return void 0!==Ar()[e.Group.Name]?.[e.Name]}afterLoad(e){Kr(e)}init(e){!function(){if(ra)return;ra=!0;const e=e=>Mr(na,e);sr.progressiveHook("AssetTextGet").override(((t,s)=>e(t[0])||s(t))),sr.progressiveHook("ChatRoomPublishCustomAction").inject((t=>{const[s,n,i]=t,r=e(s);r&&i.push({Tag:`MISSING TEXT IN "Interface.csv": ${s}`,Text:r})})).next()}(),function(){if(Fr)return;Fr=!0;const e=TextAllScreenCache.get(AssetStringsPath);e&&e.loaded&&("EN"===TranslationLanguage||"Bloated"!==e.get("Bloated"))?Er():(sr.progressiveHook("AssetBuildDescription").next().inject(Er),sr.progressiveHook("TranslationAssetProcess").next().inject(Er)),yr().getMayOverride("ChatRoomPublishAction",(e=>{const t=(e,t,s)=>{for(const[n,i]of[["PrevAsset",t],["NextAsset",s]])Cr(i)&&e.text(n,i.Asset.Description)};if(e)return e.decorators.push(t),e;{const e={decorators:[t]},s=sr.randomGlobalFunction("CustomDialogInject",((t,s,n,i,r)=>{e.decorators.forEach((e=>e(t,i,r)))}));return sr.patchFunction("ChatRoomPublishAction",{"ChatRoomCharacterItemUpdate(C);":`${s}(dictionary, C, Action, PrevItem, NextItem);\nChatRoomCharacterItemUpdate(C);`}),e}}))}(),yr().getMayOverride("ItemColorLoad",(e=>{if(e)return e.setters.push((e=>{Or=e})),e;{const e={setters:[e=>{Or=e}]},t=sr.randomGlobalFunction("LayerNameInject",(t=>{e.setters.forEach((e=>e(t)))}));return sr.patchFunction("ItemColorLoad",{"ItemColorLayerNames = new TextCache":`${t}(()=>ItemColorLayerNames);\nItemColorLayerNames = new TextCache`}),e}})),sr.progressiveHook("ItemColorLoad",1).next().inject((()=>{const e=Or?.()?.cache;e&&Tr.forEach(((e,t)=>{xr(t,e.desc,e.fallback,e.noOverride)}))})),function(){let e=!1;sr.progressiveHook("DialogInventoryBuild").inject((t=>{t[2]||(e=!0)})),sr.progressiveHook("DialogInventoryAdd").next().inject((t=>{if(!e)return;e=!1;const s=t[1].Asset.Group.Name,n=new Set(DialogInventory.map((e=>e.Asset.Name)));_r[s]&&Object.entries(_r[s]).filter((([e,t])=>!t.NotVisibleOnScreen?.includes("LuziScreen")&&!n.has(e))).forEach((([e,s])=>DialogInventoryAdd(t[0],{Asset:s},!1)))}));const t=(...[e,t])=>{const[s,n,i]=e;return!!vr(i,n)||t(e)};sr.progressiveHook("InventoryAvailable").inside("CharacterAppearanceValidate").override(t),sr.progressiveHook("InventoryAvailable").inside("CraftingItemListBuild").override(t),sr.progressiveHook("InventoryAvailable").inside("WardrobeFastLoad").override(t),sr.progressiveHook("CraftingValidate").inject((e=>{const t=e[0]?.Item;if(!t)return;const s=CraftingAssets[t]?.[0];s&&function(e,t){const s=vr(e,t);return!!s&&!s.NotVisibleOnScreen?.includes("LuziScreen")}(s.Group.Name,s.Name)&&(e[3]=!1)})),yr().getMayOverride("CraftingInventory",(e=>{const t=e=>Object.values(e).map((e=>Object.values(e))).flat().map((e=>({Asset:e})));if(e){const s=e;return s.providers.push((()=>t(_r))),s}{const e={providers:[]};e.providers.push((()=>t(_r)));const s=sr.randomGlobalFunction("CraftingInventory",(()=>[...Player.Inventory,...e.providers.map((e=>e())).flat()]));return sr.patchFunction("CraftingRun",{"for (let Item of Player.Inventory) {":`for (let Item of ${s}()) {`}),e}}))}(),e(),function(e={start:"Start loading",end:"Loading completed, time usage: "}){const t=()=>{Gr.info(e.start);const t=Date.now();for(function(){for(;jr.length>0;)jr.shift()()}(),Vr=!0,AssetGroup.forEach((e=>function(e){if(Ur[e.Name])for(;Ur[e.Name].length>0;)Ur[e.Name].shift()(e)}(e))),AssetGroup.forEach((e=>function(e){if(Wr[e.Name])for(;Wr[e.Name].length>0;)Wr[e.Name].shift()(e)}(e))),CraftingAssets=CraftingAssetsPopulate(),Yr=!0;Xr.length>0;)Xr.shift()();const s=Date.now();Gr.info(`${e.end} ${s-t}ms`)};AssetGroup.length>50?t():sr.progressiveHook("AssetLoadAll",1).next().inject((()=>t()))}()}enableValidation(e){!function(e){ia=e,aa||(aa=!0,sr.hookFunction("ValidationResolveRemoveDiff",1,((e,t)=>{const[s,n]=e;return!n.fromModUser&&vr(s.Asset.Group.Name,s.Asset.Name)?{item:s,valid:!1}:t(e)})),sr.hookFunction("ValidationResolveSwapDiff",1,((e,t)=>{const[s,n,i]=e;return!i.fromModUser&&vr(s.Asset.Group.Name,s.Asset.Name)?{item:s,valid:!1}:t(e)})),sr.hookFunction("ValidationResolveAppearanceDiff",1,((e,t)=>(ia&&(e[3].fromModUser=ia(e[3])),t(e)))))}(e)}setLogger(e){!function(e){$r=e}(e)}typeBodyGroupNames(){return this}},ga={Name:"Untrainers_Pamp",Random:!1,Left:174,Top:434,Priority:20,DefaultColor:["#FFFFFF"],ParentGroup:{},Layer:[{Name:"Base",AllowColorize:!0},{Name:"Patch",AllowColorize:!0},{Name:"Detail_2",AllowColorize:!0},{Name:"Detail_1",AllowColorize:!0},{Name:"Detail_3",AllowColorize:!0},{Name:"Tint",AllowColorize:!0,EditOpacity:!0},{Name:"Indicator",AllowColorize:!0,EditOpacity:!0},{Name:"Tabs",AllowColorize:!0}]},fa={CN:"Pampers",EN:"Untrainers Diaper",RU:" "};const ya={Name:"Temp_Pamp",Random:!1,EditOpacity:!0,Left:160,Top:411,Priority:20,DefaultColor:["#d6efff","#7B7B7B","#8197A7","#4880B9","#B5A95B","#AAA44E"],ParentGroup:{},Category:["ABDL"],Fetish:["ABDL"],Attribute:["GenitaliaCover"],Value:30,Difficulty:50,Time:5,RemoveTime:5,AllowLock:!0,DrawLocks:!1,Block:["ItemVulva","ItemButt","ItemVulvaPiercings"],HideItem:["ItemButtAnalBeads2","ItemVulvaVibratingDildo","ItemVulvaInflatableVibeDildo","ItemVulvaClitSuctionCup","ItemVulvaPiercingsVibeHeartClitPiercing","ItemVulvaPiercingsClitRing"],HideItemExclude:["ClothLowerHaremPants","ClothLowerPleatedSkirt","ClothLowerSkirt2","ClothLowerSkirt3","ClothLowerTennisSkirt1","ClothLowerLeggings1","ClothLowerLeggings2"],Layer:[{Name:"Back",AllowColorize:!0,Priority:-1},{Name:"Base",AllowColorize:!0},{Name:"Middle",AllowColorize:!0},{Name:"Tabs",AllowColorize:!0},{Opacity:1,MinOpacity:0,MaxOpacity:1,Name:"Wet",AllowColorize:!0},{Name:"Indicator",AllowColorize:!0}]},ba={EN:"Cutest Diaper",RU:"  ",CN:""};const _a={Name:"Highchair",Random:!1,Left:55,Top:320,RemoveTime:15,Priority:40,DefaultColor:["#676285","#848484","#4a468d","#939394"],AllowLock:!0,AllowTighten:!0,Difficulty:8,Fetish:["ABDL"],Effect:[E.Freeze,E.MapImmobile],AllowActivePose:[...PoseAllStanding],Height:50,ParentGroup:{},Layer:[{Priority:3,Name:"Chair"},{Priority:50,Name:"Tray"},{Priority:3,Name:"Seat"},{Priority:45,Name:"Split",CopyLayerColor:"Seat"},{Priority:1,Name:"Legs"}]},va={EN:"Little's Highchair",RU:" ",CN:""};const Aa={Name:"Stroller",Random:!1,Left:0,Top:0,Priority:40,Fetish:["ABDL"],Category:["ABDL"],DefaultColor:["#676285"],SetPose:[...PoseAllKneeling],AllowActivePose:[...PoseAllKneeling],Difficulty:8,RemoveTime:15,AllowLock:!0,AllowTighten:!0,Effect:[E.Freeze,E.Leash],AllowEffect:[E.Leash,E.IsLeashed],OverrideHeight:{Height:-100,Priority:51,HeightRatioProportion:0},ParentGroup:{},Layer:[{Priority:3,Name:"Outline"}]},Ca={EN:"Stroller (DO NOT USE PLZZZ)",RU:"",CN:""};sr.initWithMod(Ot),ma.init((()=>{ma.addImageMapping({"Assets/Female3DCG/ItemPelvis/Untrainers_Pamp_Base.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/diapers/Untrainer_Pamp/Untrainers_Pamp_Base.png","Assets/Female3DCG/ItemPelvis/Untrainers_Pamp_Patch.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/diapers/Untrainer_Pamp/Untrainers_Pamp_Patch.png","Assets/Female3DCG/ItemPelvis/Untrainers_Pamp_Detail_1.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/diapers/Untrainer_Pamp/Untrainers_Pamp_Detail_1.png","Assets/Female3DCG/ItemPelvis/Untrainers_Pamp_Detail_2.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/diapers/Untrainer_Pamp/Untrainers_Pamp_Detail_2.png","Assets/Female3DCG/ItemPelvis/Untrainers_Pamp_Detail_3.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/diapers/Untrainer_Pamp/Untrainers_Pamp_Detail_3.png","Assets/Female3DCG/ItemPelvis/Untrainers_Pamp_Indicator.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/diapers/Untrainer_Pamp/Untrainers_Pamp_Indicator.png","Assets/Female3DCG/ItemPelvis/Untrainers_Pamp_Tabs.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/diapers/Untrainer_Pamp/Untrainers_Pamp_Tabs.png","Assets/Female3DCG/ItemPelvis/Preview/Untrainers_Pamp.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/diapers/Untrainer_Pamp/Untrainers_Pamp_Preview.png"}),ma.addAsset("ItemPelvis",ga,void 0,fa),ma.addImageMapping({"Assets/Female3DCG/ItemPelvis/Temp_Pamp_Base.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/diapers/Temp/Base.png","Assets/Female3DCG/ItemPelvis/Temp_Pamp_Middle.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/diapers/Temp/Middle.png","Assets/Female3DCG/ItemPelvis/Temp_Pamp_Tabs.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/diapers/Temp/Tabs.png","Assets/Female3DCG/ItemPelvis/Temp_Pamp_Indicator.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/diapers/Temp/Indicator.png","Assets/Female3DCG/ItemPelvis/Temp_Pamp_Wet.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/diapers/Temp/Wet.png","Assets/Female3DCG/ItemPelvis/Temp_Pamp_Back.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/diapers/Temp/Back.png","Assets/Female3DCG/ItemPelvis/Preview/Temp_Pamp.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/diapers/Temp/Preview.png"}),ma.addImageMapping({"Assets/Female3DCG/Panties/Temp_Pamp_Base.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/diapers/Temp/Base.png","Assets/Female3DCG/Panties/Temp_Pamp_Middle.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/diapers/Temp/Middle.png","Assets/Female3DCG/Panties/Temp_Pamp_Tabs.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/diapers/Temp/Tabs.png","Assets/Female3DCG/Panties/Temp_Pamp_Indicator.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/diapers/Temp/Indicator.png","Assets/Female3DCG/Panties/Temp_Pamp_Wet.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/diapers/Temp/Wet.png","Assets/Female3DCG/Panties/Temp_Pamp_Back.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/diapers/Temp/Back.png","Assets/Female3DCG/Panties/Preview/Temp_Pamp.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/diapers/Temp/Preview.png"}),ma.addAsset("ItemPelvis",ya,void 0,ba),ma.addAsset("Panties",ya,void 0,ba),ma.addImageMapping({"Assets/Female3DCG/ItemDevices/Highchair_Chair.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/other/highchair/Chair.png","Assets/Female3DCG/ItemDevices/Highchair_Tray.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/other/highchair/Tray.png","Assets/Female3DCG/ItemDevices/Highchair_Seat.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/other/highchair/Seat.png","Assets/Female3DCG/ItemDevices/Highchair_Split.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/other/highchair/Split.png","Assets/Female3DCG/ItemDevices/Highchair_Legs.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/other/highchair/Legs.png","Assets/Female3DCG/ItemDevices/Preview/Highchair.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/other/highchair/Preview.png"}),ma.addAsset("ItemDevices",_a,void 0,va),ma.addImageMapping({"Assets/Female3DCG/ItemDevices/Stroller_Outline.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/other/stroller/Stroller_Outline.png","Assets/Female3DCG/ItemDevices/Preview/Stroller.png":"https://zoe-64.github.io/ABCL/versions/unstable/assets/items/other/stroller/Stroller_Outline.png"}),ma.addAsset("ItemDevices",Aa,void 0,Ca)}));const Pa=()=>{"ChatRoom"===CurrentScreen&&os.update()};let Sa=!1;const Ma=async()=>{var e;Sa||(Sa=!0,(async()=>{const e=LZString.decompressFromBase64(Player.ExtensionSettings.ABCL),t=e?JSON.parse(e):{Settings:{},Stats:{}};if("2.0.0"===t.ModVersion){const e=t.Settings.Metabolism,s=t.Settings.DisableWetting;t.Settings={...Object.fromEntries(Object.entries(t.Settings).filter((([e])=>!["DisableWetting","DisableSoiling","Metabolism","CaregiverIDs"].includes(e))).map((([e,{value:t}])=>[e,t]))),PeeMetabolism:s?"Disabled":e,PoopMetabolism:s?"Disabled":e},t.ModVersion=void 0,t.Version="2.0.1"}const n=Dt({Settings:It,Stats:Et,Version:"2.1.0"},t);s.debug({message:"Merged settings object",modStorageObject:n}),Player.ABCL=n})(),$i(),Ot.hookFunction("DialogMenuMapping.activities.GetClickStatus",1,((e,t)=>{const[s,n,i]=e;return n?t(e):null})),Ot.hookFunction("DialogChangeMode",1,(async(e,t)=>{const[s]=e;if(t(e),"activities"!==s)return;const n=CurrentCharacter?.FocusGroup?CurrentCharacter:Player,i=await zt("#dialog-activity-grid"),r=n.FocusGroup?.Name;if(r)for(const{activity:e}of yn){if(!e)continue;const t=new fn(e.ID,e.Name,e.Image,e.OnClick,e.Target,e.TargetSelf,e.Criteria);t.fitsCriteria(n,r)&&(fn.isInserted(e.ID)||i.appendChild(t.createButton()))}})),CommandCombine(bn),e=[],Ot.hookFunction("TextLoad",5,((t,s)=>{if(!e.some((e=>e.module===CurrentModule&&e.id===CurrentScreen)))return s(t)})),e.forEach((e=>{window[`${e.id}Background`]="Sheet";const{KeyUp:t,Click:s,...n}=e.functions,i={...n,KeyUp:s=>{"Escape"===s.key&&window[`${e.id}Exit`](),t?.(s)},Click:e=>{s?.(e)}};window[`${e.id}ScreenFunctions`]=i,Object.entries(i).forEach((([t,s])=>{window[`${e.id}${t}`]=s}))})),An(),Gi(new Hi),Gi(new Ui),document.body.appendChild(Yt),zt("#chat-room-div",{childCheck:!0,timeout:1e22}).then((()=>{zt(".ABCL-overlay",{timeout:1e22}).then((()=>{document.removeChild(Yt),setTimeout((()=>{document.appendChild(Yt)}),1e3)}))})),window.ABCL={version:"2.1.0",inModSubscreen:()=>Boolean(Yt.querySelector(".ABCLSettingPage")?.classList.contains("ABCL-hidden")),isABCLPlayer:Jt,wet:os.wet,attemptWetting:os.attemptWetting,soil:os.soil,attemptSoiling:os.attemptSoiling,settings:Player.ABCL.Settings,stats:os.stats,actions:{changeDiaper:Ls,checkDiaper:Ds,diaperFaceRub:()=>_n("diaperFaceRub",void 0,Player.MemberNumber),diaperFaceSit:()=>_n("diaperFaceSit",void 0,Player.MemberNumber),diaperPatBack:()=>_n("diaperPatBack",void 0,Player.MemberNumber),diaperPatFront:()=>_n("diaperPatFront",void 0,Player.MemberNumber),diaperPeeOthersDiaper:()=>_n("diaperPeeOthersDiaper",void 0,Player.MemberNumber),diaperPour:()=>_n("diaperPour",void 0,Player.MemberNumber),diaperRubBack:()=>_n("diaperRubBack",void 0,Player.MemberNumber),diaperRubFront:()=>_n("diaperRubFront",void 0,Player.MemberNumber),diaperSquishBack:()=>_n("diaperSquishBack",void 0,Player.MemberNumber),diaperSquishFront:()=>_n("diaperSquishFront",void 0,Player.MemberNumber),wipePuddle:()=>_n("wipePuddle",void 0,Player.MemberNumber),lickPuddle:()=>_n("lickPuddle",void 0,Player.MemberNumber),sendABCLmessage:(e,t)=>_n("onABCLMessage",{message:e,local:t},Player.MemberNumber),useToilet:()=>dn(),usePotty:()=>cn(),get canUseToilet(){return hn.activity?.Criteria?.(Player)},get canUsePotty(){return un.activity?.Criteria?.(Player)},get canChangeDiaper(){return Ns.activity?.Criteria?.(Player)},get canCheckDiaper(){return Is.activity?.Criteria?.(Player)}},raw:{sendUpdateMyData:vn,sendDataToAction:_n}},setInterval(Pa,6e4),s.info("Ready."))};null==CurrentScreen||"Login"===CurrentScreen?Ot.hookFunction("LoginResponse",xt.OBSERVE,((e,t)=>{t(e);const s=e[0];if("InvalidNamePassword"===s)return;const{Name:n,AccountName:i}=s;"string"==typeof n&&"string"==typeof i&&Ma()})):Ma()}();
//# sourceMappingURL=abcl.js.map
