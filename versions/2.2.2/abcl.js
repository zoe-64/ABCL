!function(){"use strict";const e=new class{constructor(){this.logsArray=[],this.maxLogSize=100}log(e,t,n){const r={message:t,level:e,version:"2.2.2",timestamp:(new Date).toISOString()};n("%cABCL:","font-weight: bold; color: #f6cbde;",r),this.logsArray.push(r),this.logsArray.length>this.maxLogSize&&this.logsArray.shift()}info(e){this.log("INFO",e,console.log)}debug(e){this.log("DEBUG",e,console.debug)}warn(e){this.log("WARN",e,console.warn)}error(e){this.log("ERROR",e,console.error)}getLogs(){return this.logsArray}};const t={ItemDefinitions:{BabyItems:["Bows Dress","Babydoll Dress","Puffy Dress","Shiny dress","Summmer flower dress","Adult Baby Harness","Tutu","Frilled Bikni","Padded Mittens","Paw Mittens","Short Smooth Leather Mittens","Changing Table","Crib","Fox Plush","Bunny Plush","Shark Plush","Little's Highchair"],Pants:["Long Leggings","Short Leggings","Business Trousers","Latex Pants","Long Latex Pants","Ripped Jeans","Jeans","Pajama"]},DiaperColors:{clean:"#8F8F8F",middlewet:"#ffe58b",maximumwet:"#ffd33e",middlemess:"#423019",maximummess:"#3C302C",selfwet:"#242103",selfmess:"#1f170d",indicatorAccident:"#1e47a6"},DiaperSizeScale:{none:0,small:300,regular:500,overnight:800,light_adult:900,moderate_adult:1500,heavy_adult:2500,specialized:3500},Diapers:{"Patterned Diaper":{color:[0],size:"overnight"},"Bulky Diaper":{color:[0,1],size:"light_adult"},"Bulky Chastity Diaper":{color:[1,0],size:"moderate_adult"},"Poofy Diaper":{color:[1,0],size:"light_adult"},"Poofy Chastity Diaper 1":{color:[1,0],size:"heavy_adult"},"Poofy Chastity Diaper":{color:[1,0],size:"moderate_adult"},"Plastic Covered Diaper":{color:[0],size:"light_adult"},"Satin Covered Diaper":{color:[0],size:"light_adult"},Diaper:{size:"regular"},"Diaper Harness":{size:"none"},"Untrainers Diaper":{size:"overnight",gradients:[1],indicator:[6]},"Crinkly Diaper":{size:"light_adult",gradients:[4],indicator:[5]},"Latex Chastity Diaper":{color:[0],size:"moderate_adult"},"Latex Diaper":{color:[0],size:"moderate_adult"}}},n={Tickle:{wetting:.05,messing:.01},TickleItem:{wetting:.08,messing:.01},Spank:{wetting:.12,messing:.15},ShockItem:{wetting:.15,messing:.2},Kick:{wetting:.05,messing:.05},Rub:{wetting:.01},SpankItem:{wetting:.15,messing:.2},Slap:{wetting:.03,messing:.04},Grope:{wetting:.06,messing:.05}},r="Normal",i="Deny",s="Ask",o="Allow",a={Disabled:0,Slow:.5,Normal:1,Fast:1.5,Faster:2,Fastest:3};var l;!function(e){e[e.Anyone=0]="Anyone",e[e.ItemPermission=1]="ItemPermission",e[e.Friends=2]="Friends",e[e.Lovers=3]="Lovers",e[e.Owner=5]="Owner",e[e.Self=6]="Self"}(l||(l={}));var c="object"==typeof global&&global&&global.Object===Object&&global,u="object"==typeof self&&self&&self.Object===Object&&self,d=c||u||Function("return this")(),h=d.Symbol,p=Object.prototype,m=p.hasOwnProperty,f=p.toString,g=h?h.toStringTag:void 0;var y=Object.prototype.toString;var v="[object Null]",_="[object Undefined]",b=h?h.toStringTag:void 0;function A(e){return null==e?void 0===e?_:v:b&&b in Object(e)?function(e){var t=m.call(e,g),n=e[g];try{e[g]=void 0;var r=!0}catch(e){}var i=f.call(e);return r&&(t?e[g]=n:delete e[g]),i}(e):function(e){return y.call(e)}(e)}function S(e){return null!=e&&"object"==typeof e}var C="[object Symbol]";var P=Array.isArray,L=/\s/;var I=/^\s+/;function N(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&L.test(e.charAt(t)););return t}(e)+1).replace(I,""):e}function M(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var w=NaN,B=/^[-+]0x[0-9a-f]+$/i,D=/^0b[01]+$/i,R=/^0o[0-7]+$/i,O=parseInt;function k(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||S(e)&&A(e)==C}(e))return w;if(M(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=M(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=N(e);var n=D.test(e);return n||R.test(e)?O(e.slice(2),n?2:8):B.test(e)?w:+e}function $(e){return e}var T="[object AsyncFunction]",F="[object Function]",x="[object GeneratorFunction]",G="[object Proxy]";function j(e){if(!M(e))return!1;var t=A(e);return t==F||t==x||t==T||t==G}var V,z=d["__core-js_shared__"],U=(V=/[^.]+$/.exec(z&&z.keys&&z.keys.IE_PROTO||""))?"Symbol(src)_1."+V:"";var H=Function.prototype.toString;var W=/^\[object .+?Constructor\]$/,X=Function.prototype,Y=Object.prototype,q=X.toString,Z=Y.hasOwnProperty,K=RegExp("^"+q.call(Z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function J(e){return!(!M(e)||(t=e,U&&U in t))&&(j(e)?K:W).test(function(e){if(null!=e){try{return H.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}function Q(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return J(n)?n:void 0}var ee=Object.create,te=function(){function e(){}return function(t){if(!M(t))return{};if(ee)return ee(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();var ne=Date.now;var re,ie,se,oe=function(){try{var e=Q(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),ae=oe?function(e,t){return oe(e,"toString",{configurable:!0,enumerable:!1,value:(n=t,function(){return n}),writable:!0});var n}:$,le=(re=ae,ie=0,se=0,function(){var e=ne(),t=16-(e-se);if(se=e,t>0){if(++ie>=800)return arguments[0]}else ie=0;return re.apply(void 0,arguments)}),ce=9007199254740991,ue=/^(?:0|[1-9]\d*)$/;function de(e,t){var n=typeof e;return!!(t=null==t?ce:t)&&("number"==n||"symbol"!=n&&ue.test(e))&&e>-1&&e%1==0&&e<t}function he(e,t,n){"__proto__"==t&&oe?oe(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function pe(e,t){return e===t||e!=e&&t!=t}var me=Object.prototype.hasOwnProperty;function fe(e,t,n){var r=e[t];me.call(e,t)&&pe(r,n)&&(void 0!==n||t in e)||he(e,t,n)}var ge=Math.max;function ye(e,t){return le(function(e,t,n){return t=ge(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,s=ge(r.length-t,0),o=Array(s);++i<s;)o[i]=r[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=r[i];return a[t]=n(o),function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}(e,this,a)}}(e,t,$),e+"")}var Ee=9007199254740991;function ve(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Ee}function _e(e){return null!=e&&ve(e.length)&&!j(e)}var be=Object.prototype;function Ae(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||be)}function Se(e){return S(e)&&"[object Arguments]"==A(e)}var Ce=Object.prototype,Pe=Ce.hasOwnProperty,Le=Ce.propertyIsEnumerable,Ie=Se(function(){return arguments}())?Se:function(e){return S(e)&&Pe.call(e,"callee")&&!Le.call(e,"callee")},Ne=Ie;var Me="object"==typeof exports&&exports&&!exports.nodeType&&exports,we=Me&&"object"==typeof module&&module&&!module.nodeType&&module,Be=we&&we.exports===Me?d.Buffer:void 0,De=(Be?Be.isBuffer:void 0)||function(){return!1},Re={};Re["[object Float32Array]"]=Re["[object Float64Array]"]=Re["[object Int8Array]"]=Re["[object Int16Array]"]=Re["[object Int32Array]"]=Re["[object Uint8Array]"]=Re["[object Uint8ClampedArray]"]=Re["[object Uint16Array]"]=Re["[object Uint32Array]"]=!0,Re["[object Arguments]"]=Re["[object Array]"]=Re["[object ArrayBuffer]"]=Re["[object Boolean]"]=Re["[object DataView]"]=Re["[object Date]"]=Re["[object Error]"]=Re["[object Function]"]=Re["[object Map]"]=Re["[object Number]"]=Re["[object Object]"]=Re["[object RegExp]"]=Re["[object Set]"]=Re["[object String]"]=Re["[object WeakMap]"]=!1;var Oe="object"==typeof exports&&exports&&!exports.nodeType&&exports,ke=Oe&&"object"==typeof module&&module&&!module.nodeType&&module,$e=ke&&ke.exports===Oe&&c.process,Te=function(){try{var e=ke&&ke.require&&ke.require("util").types;return e||$e&&$e.binding&&$e.binding("util")}catch(e){}}(),Fe=Te&&Te.isTypedArray,xe=Fe?function(e){return function(t){return e(t)}}(Fe):function(e){return S(e)&&ve(e.length)&&!!Re[A(e)]},Ge=Object.prototype.hasOwnProperty;function je(e,t){var n=P(e),r=!n&&Ne(e),i=!n&&!r&&De(e),s=!n&&!r&&!i&&xe(e),o=n||r||i||s,a=o?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],l=a.length;for(var c in e)!t&&!Ge.call(e,c)||o&&("length"==c||i&&("offset"==c||"parent"==c)||s&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||de(c,l))||a.push(c);return a}var Ve=Object.prototype.hasOwnProperty;function ze(e){if(!M(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=Ae(e),n=[];for(var r in e)("constructor"!=r||!t&&Ve.call(e,r))&&n.push(r);return n}function Ue(e){return _e(e)?je(e,!0):ze(e)}var He=Q(Object,"create");var We=Object.prototype.hasOwnProperty;var Xe=Object.prototype.hasOwnProperty;function Ye(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function qe(e,t){for(var n=e.length;n--;)if(pe(e[n][0],t))return n;return-1}Ye.prototype.clear=function(){this.__data__=He?He(null):{},this.size=0},Ye.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Ye.prototype.get=function(e){var t=this.__data__;if(He){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return We.call(t,e)?t[e]:void 0},Ye.prototype.has=function(e){var t=this.__data__;return He?void 0!==t[e]:Xe.call(t,e)},Ye.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=He&&void 0===t?"__lodash_hash_undefined__":t,this};var Ze=Array.prototype.splice;function Ke(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Ke.prototype.clear=function(){this.__data__=[],this.size=0},Ke.prototype.delete=function(e){var t=this.__data__,n=qe(t,e);return!(n<0)&&(n==t.length-1?t.pop():Ze.call(t,n,1),--this.size,!0)},Ke.prototype.get=function(e){var t=this.__data__,n=qe(t,e);return n<0?void 0:t[n][1]},Ke.prototype.has=function(e){return qe(this.__data__,e)>-1},Ke.prototype.set=function(e,t){var n=this.__data__,r=qe(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};var Je=Q(d,"Map");function Qe(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function et(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}et.prototype.clear=function(){this.size=0,this.__data__={hash:new Ye,map:new(Je||Ke),string:new Ye}},et.prototype.delete=function(e){var t=Qe(this,e).delete(e);return this.size-=t?1:0,t},et.prototype.get=function(e){return Qe(this,e).get(e)},et.prototype.has=function(e){return Qe(this,e).has(e)},et.prototype.set=function(e,t){var n=Qe(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};var tt=function(e,t){return function(n){return e(t(n))}}(Object.getPrototypeOf,Object),nt="[object Object]",rt=Function.prototype,it=Object.prototype,st=rt.toString,ot=it.hasOwnProperty,at=st.call(Object);function lt(e){var t=this.__data__=new Ke(e);this.size=t.size}lt.prototype.clear=function(){this.__data__=new Ke,this.size=0},lt.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},lt.prototype.get=function(e){return this.__data__.get(e)},lt.prototype.has=function(e){return this.__data__.has(e)},lt.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Ke){var r=n.__data__;if(!Je||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new et(r)}return n.set(e,t),this.size=n.size,this};var ct="object"==typeof exports&&exports&&!exports.nodeType&&exports,ut=ct&&"object"==typeof module&&module&&!module.nodeType&&module,dt=ut&&ut.exports===ct?d.Buffer:void 0,ht=dt?dt.allocUnsafe:void 0;var pt=d.Uint8Array;function mt(e,t){var n,r,i=t?(n=e.buffer,r=new n.constructor(n.byteLength),new pt(r).set(new pt(n)),r):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}var ft,gt=function(e,t,n){for(var r=-1,i=Object(e),s=n(e),o=s.length;o--;){var a=s[ft?o:++r];if(!1===t(i[a],a,i))break}return e},yt=function(){return d.Date.now()},Et=Math.max,vt=Math.min;function _t(e,t,n){(void 0!==n&&!pe(e[t],n)||void 0===n&&!(t in e))&&he(e,t,n)}function bt(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function At(e){return function(e,t,n,r){var i=!n;n||(n={});for(var s=-1,o=t.length;++s<o;){var a=t[s],l=r?r(n[a],e[a],a,n,e):void 0;void 0===l&&(l=e[a]),i?he(n,a,l):fe(n,a,l)}return n}(e,Ue(e))}function St(e,t,n,r,i,s,o){var a=bt(e,n),l=bt(t,n),c=o.get(l);if(c)_t(e,n,c);else{var u,d=s?s(a,l,n+"",e,t,o):void 0,h=void 0===d;if(h){var p=P(l),m=!p&&De(l),f=!p&&!m&&xe(l);d=l,p||m||f?P(a)?d=a:S(u=a)&&_e(u)?d=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}(a):m?(h=!1,d=function(e,t){if(t)return e.slice();var n=e.length,r=ht?ht(n):new e.constructor(n);return e.copy(r),r}(l,!0)):f?(h=!1,d=mt(l,!0)):d=[]:function(e){if(!S(e)||A(e)!=nt)return!1;var t=tt(e);if(null===t)return!0;var n=ot.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&st.call(n)==at}(l)||Ne(l)?(d=a,Ne(a)?d=At(a):M(a)&&!j(a)||(d=function(e){return"function"!=typeof e.constructor||Ae(e)?{}:te(tt(e))}(l))):h=!1}h&&(o.set(l,d),i(d,l,r,s,o),o.delete(l)),_t(e,n,d)}}function Ct(e,t,n,r,i){e!==t&&gt(t,(function(s,o){if(i||(i=new lt),M(s))St(e,t,o,n,Ct,r,i);else{var a=r?r(bt(e,o),s,o+"",e,t,i):void 0;void 0===a&&(a=s),_t(e,o,a)}}),Ue)}var Pt,Lt=(Pt=function(e,t,n){Ct(e,t,n)},ye((function(e,t){var n=-1,r=t.length,i=r>1?t[r-1]:void 0,s=r>2?t[2]:void 0;for(i=Pt.length>3&&"function"==typeof i?(r--,i):void 0,s&&function(e,t,n){if(!M(n))return!1;var r=typeof t;return!!("number"==r?_e(n)&&de(t,n.length):"string"==r&&t in n)&&pe(n[t],e)}(t[0],t[1],s)&&(i=r<3?void 0:i,r=1),e=Object(e);++n<r;){var o=t[n];o&&Pt(e,o,n,i)}return e})));const It={PauseStats:!1,PeeMetabolism:r,PoopMetabolism:r,MentalRegressionModifier:r,OpenRemoteSettings:!1,LockedOutOfSettings:!1,DisableWettingLeaks:!1,DisableSoilingLeaks:!0,OnDiaperChange:s,VisibleMessages:{changeDiaper:!0,checkDiaper:!0,lickPuddle:!0,wetDiaper:!0,wetClothing:!0,soilDiaper:!0,soilClothing:!0,usePotty:!0,useToilet:!0,wipePuddle:!0,statusMessages:!1,playerActivity:!0,pauseStats:!1},StatusMessages:{Bladder:!0,Bowel:!0,Soiliness:!0,Wetness:!0,MentalRegression:!0,Incontinence:!0,PuddleSize:!0},DisableClothingStains:!1,DisableDiaperStains:!1,AccidentsByActivities:!0},Nt={PuddleSize:{value:0},Bladder:{value:0,size:300},Bowel:{value:0,size:200},Soiliness:{value:0},Wetness:{value:0},WaterIntake:{value:15},FoodIntake:{value:200/60},Incontinence:{value:0},MentalRegression:{value:0}},Mt={Settings:It,Stats:Nt},wt=e=>{Player.ABCL=Lt(Player.ABCL||Mt,e),Bt()},Bt=function(e,t,n){var r,i,s,o,a,l,c=0,u=!1,d=!1,h=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function p(t){var n=r,s=i;return r=i=void 0,c=t,o=e.apply(s,n)}function m(e){var n=e-l;return void 0===l||n>=t||n<0||d&&e-c>=s}function f(){var e=yt();if(m(e))return g(e);a=setTimeout(f,function(e){var n=t-(e-l);return d?vt(n,s-(e-c)):n}(e))}function g(e){return a=void 0,h&&r?p(e):(r=i=void 0,o)}function y(){var e=yt(),n=m(e);if(r=arguments,i=this,l=e,n){if(void 0===a)return function(e){return c=e,a=setTimeout(f,t),u?p(e):o}(l);if(d)return clearTimeout(a),a=setTimeout(f,t),p(l)}return void 0===a&&(a=setTimeout(f,t)),o}return t=k(t)||0,M(n)&&(u=!!n.leading,s=(d="maxWait"in n)?Et(k(n.maxWait)||0,t):s,h="trailing"in n?!!n.trailing:h),y.cancel=function(){void 0!==a&&clearTimeout(a),c=0,r=l=i=a=void 0},y.flush=function(){return void 0===a?o:g(yt())},y}((()=>{const e=LZString.compressToBase64(JSON.stringify(Player.ABCL));Player.ExtensionSettings.ABCL=e,ServerPlayerExtensionSettingsSync("ABCL"),Tr()}),1e3),Dt=()=>{Player.ExtensionSettings.ABCL="N4XyA===",ServerPlayerExtensionSettingsSync("ABCL"),e.warn("cleared data")};var Rt={};!function(e){!function(){const t="1.2.0";function n(e){alert("Mod ERROR:\n"+e);const t=new Error(e);throw console.error(t),t}const r=new TextEncoder;function i(e){return!!e&&"object"==typeof e&&!Array.isArray(e)}function s(e){const t=new Set;return e.filter((e=>!t.has(e)&&t.add(e)))}const o=new Map,a=new Set;function l(e){a.has(e)||(a.add(e),console.warn(e))}function c(e){const t=[],n=new Map,r=new Set;for(const i of p.values()){const s=i.patching.get(e.name);if(s){t.push(...s.hooks);for(const[t,o]of s.patches.entries())n.has(t)&&n.get(t)!==o&&l(`ModSDK: Mod '${i.name}' is patching function ${e.name} with same pattern that is already applied by different mod, but with different pattern:\nPattern:\n${t}\nPatch1:\n${n.get(t)||""}\nPatch2:\n${o}`),n.set(t,o),r.add(i.name)}}t.sort(((e,t)=>t.priority-e.priority));const i=function(e,t){if(0===t.size)return e;let n=e.toString().replaceAll("\r\n","\n");for(const[r,i]of t.entries())n.includes(r)||l(`ModSDK: Patching ${e.name}: Patch ${r} not applied`),n=n.replaceAll(r,i);return(0,eval)(`(${n})`)}(e.original,n);let s=function(t){var n,s;const o=null===(s=(n=y.errorReporterHooks).hookChainExit)||void 0===s?void 0:s.call(n,e.name,r),a=i.apply(this,t);return null==o||o(),a};for(let n=t.length-1;n>=0;n--){const r=t[n],i=s;s=function(t){var n,s;const o=null===(s=(n=y.errorReporterHooks).hookEnter)||void 0===s?void 0:s.call(n,e.name,r.mod),a=r.hook.apply(this,[t,e=>{if(1!==arguments.length||!Array.isArray(t))throw new Error(`Mod ${r.mod} failed to call next hook: Expected args to be array, got ${typeof e}`);return i.call(this,e)}]);return null==o||o(),a}}return{hooks:t,patches:n,patchesSources:r,enter:s,final:i}}function u(e,t=!1){let n=o.get(e);if(n)t&&(n.precomputed=c(n));else{let t=window;const s=e.split(".");for(let n=0;n<s.length-1;n++)if(t=t[s[n]],!i(t))throw new Error(`ModSDK: Function ${e} to be patched not found; ${s.slice(0,n+1).join(".")} is not object`);const a=t[s[s.length-1]];if("function"!=typeof a)throw new Error(`ModSDK: Function ${e} to be patched not found`);const l=function(e){let t=-1;for(const n of r.encode(e)){let e=255&(t^n);for(let t=0;t<8;t++)e=1&e?-306674912^e>>>1:e>>>1;t=t>>>8^e}return(~t>>>0).toString(16).padStart(8,"0").toUpperCase()}(a.toString().replaceAll("\r\n","\n")),u={name:e,original:a,originalHash:l};n=Object.assign(Object.assign({},u),{precomputed:c(u),router:()=>{},context:t,contextProperty:s[s.length-1]}),n.router=function(e){return function(...t){return e.precomputed.enter.apply(this,[t])}}(n),o.set(e,n),t[n.contextProperty]=n.router}return n}function d(){for(const e of o.values())e.precomputed=c(e)}function h(){const e=new Map;for(const[t,n]of o)e.set(t,{name:t,original:n.original,originalHash:n.originalHash,sdkEntrypoint:n.router,currentEntrypoint:n.context[n.contextProperty],hookedByMods:s(n.precomputed.hooks.map((e=>e.mod))),patchedByMods:Array.from(n.precomputed.patchesSources)});return e}const p=new Map;function m(e){p.get(e.name)!==e&&n(`Failed to unload mod '${e.name}': Not registered`),p.delete(e.name),e.loaded=!1,d()}function f(e,t){e&&"object"==typeof e||n("Failed to register mod: Expected info object, got "+typeof e),"string"==typeof e.name&&e.name||n("Failed to register mod: Expected name to be non-empty string, got "+typeof e.name);let r=`'${e.name}'`;"string"==typeof e.fullName&&e.fullName||n(`Failed to register mod ${r}: Expected fullName to be non-empty string, got ${typeof e.fullName}`),r=`'${e.fullName} (${e.name})'`,"string"!=typeof e.version&&n(`Failed to register mod ${r}: Expected version to be string, got ${typeof e.version}`),e.repository||(e.repository=void 0),void 0!==e.repository&&"string"!=typeof e.repository&&n(`Failed to register mod ${r}: Expected repository to be undefined or string, got ${typeof e.version}`),null==t&&(t={}),t&&"object"==typeof t||n(`Failed to register mod ${r}: Expected options to be undefined or object, got ${typeof t}`);const s=!0===t.allowReplace,o=p.get(e.name);o&&(o.allowReplace&&s||n(`Refusing to load mod ${r}: it is already loaded and doesn't allow being replaced.\nWas the mod loaded multiple times?`),m(o));const a=e=>{let t=h.patching.get(e.name);return t||(t={hooks:[],patches:new Map},h.patching.set(e.name,t)),t},l=(e,t)=>(...i)=>{var s,o;const a=null===(o=(s=y.errorReporterHooks).apiEndpointEnter)||void 0===o?void 0:o.call(s,e,h.name);h.loaded||n(`Mod ${r} attempted to call SDK function after being unloaded`);const l=t(...i);return null==a||a(),l},c={unload:l("unload",(()=>m(h))),hookFunction:l("hookFunction",((e,t,i)=>{"string"==typeof e&&e||n(`Mod ${r} failed to patch a function: Expected function name string, got ${typeof e}`);const s=u(e),o=a(s);"number"!=typeof t&&n(`Mod ${r} failed to hook function '${e}': Expected priority number, got ${typeof t}`),"function"!=typeof i&&n(`Mod ${r} failed to hook function '${e}': Expected hook function, got ${typeof i}`);const l={mod:h.name,priority:t,hook:i};return o.hooks.push(l),d(),()=>{const e=o.hooks.indexOf(l);e>=0&&(o.hooks.splice(e,1),d())}})),patchFunction:l("patchFunction",((e,t)=>{"string"==typeof e&&e||n(`Mod ${r} failed to patch a function: Expected function name string, got ${typeof e}`);const s=u(e),o=a(s);i(t)||n(`Mod ${r} failed to patch function '${e}': Expected patches object, got ${typeof t}`);for(const[i,s]of Object.entries(t))"string"==typeof s?o.patches.set(i,s):null===s?o.patches.delete(i):n(`Mod ${r} failed to patch function '${e}': Invalid format of patch '${i}'`);d()})),removePatches:l("removePatches",(e=>{"string"==typeof e&&e||n(`Mod ${r} failed to patch a function: Expected function name string, got ${typeof e}`);const t=u(e);a(t).patches.clear(),d()})),callOriginal:l("callOriginal",((e,t,i)=>{"string"==typeof e&&e||n(`Mod ${r} failed to call a function: Expected function name string, got ${typeof e}`);const s=u(e);return Array.isArray(t)||n(`Mod ${r} failed to call a function: Expected args array, got ${typeof t}`),s.original.apply(null!=i?i:globalThis,t)})),getOriginalHash:l("getOriginalHash",(e=>("string"==typeof e&&e||n(`Mod ${r} failed to get hash: Expected function name string, got ${typeof e}`),u(e).originalHash)))},h={name:e.name,fullName:e.fullName,version:e.version,repository:e.repository,allowReplace:s,api:c,loaded:!0,patching:new Map};return p.set(e.name,h),Object.freeze(c)}function g(){const e=[];for(const t of p.values())e.push({name:t.name,fullName:t.fullName,version:t.version,repository:t.repository});return e}let y;const E=void 0===window.bcModSdk?window.bcModSdk=function(){const e={version:t,apiVersion:1,registerMod:f,getModsInfo:g,getPatchingInfo:h,errorReporterHooks:Object.seal({apiEndpointEnter:null,hookEnter:null,hookChainExit:null})};return y=e,Object.freeze(e)}():(i(window.bcModSdk)||n("Failed to init Mod SDK: Name already in use"),1!==window.bcModSdk.apiVersion&&n(`Failed to init Mod SDK: Different version already loaded ('1.2.0' vs '${window.bcModSdk.version}')`),window.bcModSdk.version!==t&&alert(`Mod SDK warning: Loading different but compatible versions ('1.2.0' vs '${window.bcModSdk.version}')\nOne of mods you are using is using an old version of SDK. It will work for now but please inform author to update`),window.bcModSdk);Object.defineProperty(e,"__esModule",{value:!0}),e.default=E}()}(Rt);var Ot=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(Rt);let kt,$t=class{constructor(e){this.hookMng=e,this.workList=[]}run(e,t){let n,r=!1;for(const i of this.workList)if("inject"===i.value)i.work(e,t);else if("next"===i.value)n=t(e),r=!0;else if("override"===i.value)n=i.work(e,t),r=!0;else if("flag"===i.value){if(!i.flag)break;i.once&&(i.flag=!1)}else if("check"===i.value&&!i.work(e,t))break;return r?n:t(e)}next(){return this.workList.push({value:"next"}),this}inject(e){return this.workList.push({value:"inject",work:e}),this}inside(e,{once:t=!1,priority:n=1}={}){const r={value:"flag",flag:!1,once:t};return this.hookMng.hookFunction(e,n,((e,t)=>{r.flag=!0;const n=t(e);return r.flag=!1,n})),this.workList.push(r),this}when(e){return this.workList.push({value:"check",work:e}),this}override(e){return this.workList.push({value:"override",work:e}),this}},Tt=class{static info(e){kt?.info(e)}static warn(e){kt?.warn(e)}static error(e){kt?.error(e)}},Ft=class{constructor(e=!1){this.done=e,this.list=[]}run(){for(this.done=!0;this.list.length>0;)this.list.shift()()}push(e){this.done?e():this.list.push(e)}};const xt=new Ft,Gt=new Ft,jt=new Ft,Vt=new Ft;function zt(){return null!=globalThis.Player&&"number"==typeof globalThis.Player.MemberNumber}const Ut=new class{constructor(){this.mMod=void 0}get mod(){return this.mMod}push(e,t){e.push(t)}init(e){this.mMod=Ot.registerMod(e),Vt.run(),Gt.run();const t=()=>jt.run();zt()?t():this.mod.hookFunction("LoginResponse",0,((e,n)=>{n(e),zt()&&t()})),xt.run()}initWithMod(e){this.mMod=e,Vt.run(),Gt.run();const t=()=>jt.run();zt()?t():this.mod.hookFunction("LoginResponse",0,((e,n)=>{n(e),zt()&&t()}))}afterInit(e){this.push(xt,e)}afterPlayerLogin(e){this.push(jt,e)}patchFunction(e,t){this.push(Vt,(()=>this.mod.patchFunction(e,t)))}invokeOriginal(e,...t){return this.mod?this.mod.callOriginal(e,t):globalThis[e]?.(...t)}hookFunction(e,t,n){this.push(Gt,(()=>this.mod.hookFunction(e,t,n)))}progressiveHook(e,t=1){const n=new $t(this);return this.hookFunction(e,t,((e,t)=>n.run(e,t))),n}insideFlag(e,t=1){const n={inside:!1};return this.hookFunction(e,t,((e,t)=>{n.inside=!0;const r=t(e);return n.inside=!1,r})),n}hookPlayerFunction(e,t,n){var r;r=()=>this.mod.hookFunction(e,t,n),zt()?jt.push(r):r()}globalFunction(e,t){"function"!=typeof t&&Tt.warn("globalFunction: param is not a function"),null==globalThis[e]?globalThis[e]=t:globalThis[e]!=t&&Tt.warn(`globalFunction: ${e} is already defined`)}randomGlobalFunction(e,t){const n=e=>e+Math.random().toString(16).substring(2);let r=n(e);for(;null!=globalThis[r];)r=n(e);return globalThis[r]=t,r}setLogger(e){!function(e){kt=e}(e)}};var Ht;Ut.init({name:"ABCL",fullName:"ABCL",version:"2.2.2",repository:"https://github.com/zoe-64/ABCL"}),function(e){e[e.OBSERVE=0]="OBSERVE",e[e.ADD_BEHAVIOR=1]="ADD_BEHAVIOR",e[e.MODIFY_BEHAVIOR=5]="MODIFY_BEHAVIOR",e[e.OVERRIDE_BEHAVIOR=10]="OVERRIDE_BEHAVIOR",e[e.TOP=100]="TOP"}(Ht||(Ht={}));const Wt=(e,t=[],n,r=!0)=>{if(!ServerPlayerIsInChatRoom())return;const i=document.createElement("div");i.innerHTML=(r?"(local) ":"")+e.split("\n").map((e=>e.trim())).join("<br/>"),i.classList.add("ABCLLocalMessage","ChatMessage",...t),n&&(i.style.cssText=n),document.querySelector("#TextAreaChatLog")?.appendChild(i),ElementScrollToEnd("TextAreaChatLog")};const Xt=async(e,t={})=>new Promise(((n,r)=>{const i=document.querySelector(e);if(i)return void n(i);const s=new MutationObserver((()=>{const r=document.querySelector(e);r&&(!t.childCheck||r.childElementCount>0)&&(s.disconnect(),clearTimeout(o),n(r))}));s.observe(document.body,{childList:!0,subtree:!0});const o=setTimeout((()=>{s.disconnect(),console.warn(`Element with selector "${e}" not found within timeout`)}),t.timeout||1e4)})),Yt=e=>`${e=e||"ABCL"}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;class qt{constructor(e){this.lastCallTime=0,this.allowedCallInterval=e}check(){return Date.now()-this.lastCallTime>this.allowedCallInterval&&(this.lastCallTime=Date.now(),!0)}reset(){this.lastCallTime=0}isReady(){return Date.now()-this.lastCallTime>this.allowedCallInterval}}const Zt=e=>"Default"!==e&&"string"==typeof e,Kt=(t,n)=>("string"==typeof t&&"Default"!==t&&e.warn(`Unknown color: ${t}`),t&&"Default"!==t?Array.isArray(t)?t.map((e=>"Default"===e?"#FFFFFF":e)):[t]:[...n.DefaultColor.map((e=>"Default"===e?"#FFFFFF":e))]),Jt=(e,t)=>{const n=e.querySelector(t);if(n)return n;throw new Error(`Element with selector "${t}" not found`)},Qt={state:0,memberNumber:0,setState:e=>{Qt.state=e(Qt.state)},setMemberNumber:e=>{Qt.setMemberNumber(e)},update:()=>{Qt.setState((e=>e+1))}};class en{constructor(e,t=!1){this.newX=0,this.newY=0,this.oldX=0,this.oldY=0,this.isDragging=!1,this.isResizing=!1,this.resizeDirection=null,this.edgeThreshold=10,this.resizable=!0,this.element=e,this.resizable=t,this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseEnter=this.onMouseEnter.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this),this.onMouseMoveForCursor=this.onMouseMoveForCursor.bind(this),this.element.addEventListener("mousedown",this.onMouseDown),this.element.addEventListener("mousemove",this.onMouseMoveForCursor),this.element.style.position="fixed",this.resizable&&(this.element.style.resize="none",this.element.addEventListener("mouseenter",this.onMouseEnter),this.element.addEventListener("mouseleave",this.onMouseLeave))}onMouseEnter(e){this.element.addEventListener("mousemove",this.onMouseMoveForCursor)}onMouseLeave(e){this.element.removeEventListener("mousemove",this.onMouseMoveForCursor),this.element.style.cursor="default"}onMouseMoveForCursor(e){const{offsetX:t,offsetY:n}=e,{offsetWidth:r,offsetHeight:i}=this.element;this.resizable&&(t<this.edgeThreshold||t>r-this.edgeThreshold?this.element.style.cursor="ew-resize":n<this.edgeThreshold||n>i-this.edgeThreshold?this.element.style.cursor="ns-resize":this.element.style.cursor="default")}onMouseDown(e){const{offsetX:t,offsetY:n}=e,{offsetWidth:r,offsetHeight:i}=this.element;this.resizable?t<this.edgeThreshold?(this.isResizing=!0,this.resizeDirection="left"):t>r-this.edgeThreshold?(this.isResizing=!0,this.resizeDirection="right"):n<this.edgeThreshold?(this.isResizing=!0,this.resizeDirection="top"):n>i-this.edgeThreshold?(this.isResizing=!0,this.resizeDirection="bottom"):this.isDragging=!0:this.isDragging=!0,(this.isDragging||this.isResizing)&&(e.preventDefault(),this.oldX=e.clientX,this.oldY=e.clientY,document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp))}onMouseMove(e){if(this.isDragging)this.newX=this.oldX-e.clientX,this.newY=this.oldY-e.clientY,this.oldX=e.clientX,this.oldY=e.clientY,this.element.style.top=this.element.offsetTop-this.newY+"px",this.element.style.left=this.element.offsetLeft-this.newX+"px";else if(this.isResizing){const t=e.clientX-this.oldX,n=e.clientY-this.oldY,r=getComputedStyle(this.element),i=parseInt(r.left,10),s=parseInt(r.top,10),o=parseInt(r.width,10),a=parseInt(r.height,10);switch(this.resizeDirection){case"left":this.element.style.width=o-t+"px",this.element.style.left=`${i+t/2}px`;break;case"right":this.element.style.width=`${o+t}px`,this.element.style.left=`${i+t/2}px`;break;case"top":this.element.style.height=a-n+"px",this.element.style.top=`${s+n/2}px`;break;case"bottom":this.element.style.height=`${a+n}px`,this.element.style.top=`${s+n/2}px`}this.oldX=e.clientX,this.oldY=e.clientY}}onMouseUp(e){e.preventDefault(),this.isDragging=!1,this.isResizing=!1,this.resizeDirection=null,document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp)}}class tn{constructor(e,t,n,r=-1){this.prompt=document.createElement("div"),new en(this.prompt),this.id=Yt(),this.message=e,this.onAccept=t,this.onDeny=n,this.show(),-1!==r&&setTimeout((()=>{this.prompt.remove()}),r)}show(){this.prompt.classList.add("ABCLPrompt","no-resize"),this.prompt.id=this.id,this.prompt.innerHTML=`<p>${this.message}</p><button class="ABCLPromptNo ABCLButton">Deny</button><button class="ABCLPromptYes ABCLButton">Accept</button>`,nn.appendChild(this.prompt),this.prompt.querySelector(`#${this.id} .ABCLPromptYes`)?.addEventListener("click",(()=>{this.onAccept(),this.prompt.remove()})),this.prompt.querySelector(`#${this.id} .ABCLPromptNo`)?.addEventListener("click",(()=>{this.onDeny(),this.prompt.remove()}))}}const nn=document.createElement("div");nn.id="ABCL-overlay";const rn=()=>{ElementPositionFixed(nn.id,0,0,2e3,1e3),ElementPositionFixed("ABCL-stats-panel",1700,0,300,1e3);const e=document.querySelectorAll(".ABCL-exit-button");for(let t=0;t<e.length;t++){const n=e[t];n.id=n.id||Yt(),ElementPositionFixed(n.id,1815,75,90,90)}};window.addEventListener("resize",rn),nn.classList.add("ABCL-overlay");const sn=e=>{if(!e)return;if("object"==typeof e)return e;return ChatRoomCharacter.filter((t=>{const n=t.Name.toLowerCase(),r=t.Nickname?.toLowerCase(),i=`${e}`.toLowerCase();return t.MemberNumber==e||n===i||r===i||n.startsWith(i)||r?.startsWith(i)}))[0]},on=e=>{const t=e.join(" "),n=sn(t);if(n)return n},an=(e,t,n=Player.ABCL.Version)=>Boolean(e?.ABCL&&(!t||e.ABCL.Version===n));function ln(e){if(!e)return"Unknown";const t=sn(e);return t?t.Nickname?t.Nickname:t.Name:"Unknown"}function cn(e,t=null,n=""){let r=e,i="He/Him"===CharacterPronounDescription(Player),s=i?"His":"Her",o=i?"Him":"Her",a=i?"He":"She",l="He/Him"===(t?CharacterPronounDescription(t):"They/Them"),c=t?.IsPlayer()?l?"himself":"herself":t?CharacterNickname(t):n,u=l?"His":"Her",d=t==Player?l?"Himself":"Herself":l?"Him":"Her",h=l?"He":"She";return r.replaceAll("%NAME%",CharacterNickname(Player)).replaceAll("%POSSESSIVE%",s.toLocaleLowerCase()).replaceAll("%PRONOUN%",a.toLocaleLowerCase()).replaceAll("%INTENSIVE%",o.toLocaleLowerCase()).replaceAll("%CAP_POSSESSIVE%",s).replaceAll("%CAP_PRONOUN%",a).replaceAll("%CAP_INTENSIVE%",o).replaceAll("%OPP_NAME%",c).replaceAll("%OPP_PRONOUN%",h.toLocaleLowerCase()).replaceAll("%OPP_POSSESSIVE%",u.toLocaleLowerCase()).replaceAll("%OPP_INTENSIVE%",d.toLocaleLowerCase()).replaceAll("%CAP_OPP_PRONOUN%",h).replaceAll("%CAP_OPP_POSSESSIVE%",u).replaceAll("%CAP_OPP_INTENSIVE%",d)}const un=(e,t,n=!1)=>{if(0===t)return;if(n&&(t*=100),t=Number(t.toPrecision(2)),void 0===Player.ABCL.Settings.StatusMessages[e])return;if(!Player.ABCL.Settings.StatusMessages[e])return;const r=Player.ABCL.Settings.StatusMessages[e],i=`[${t>0?"+":"-"}${Math.abs(t)}${n?"%":""} ${{Bladder:"PEE",Bowel:"POO",Incontinence:"INCON",MentalRegression:"REG",Soiliness:"MESS",Wetness:"WET",PuddleSize:"PUDL"}[e]}]`;r?Wt(i,["ChatMessageAction","ChatMessageNonDialogue"],"--label-color:#ff4949"):$r("onABCLMessage",{message:`${ln(Player.MemberNumber)}: ${i}`,local:r})};function dn(e,t=null,n,r){let i=cn(e,t);const s=!Player.ABCL.Settings.VisibleMessages[n];Wt(i,["ChatMessageAction","ChatMessageNonDialogue"],"--label-color:#ff4949",s),s?r&&r.MemberNumber!==Player.MemberNumber&&$r("onABCLMessage",{message:i,local:s},r.MemberNumber):$r("onABCLMessage",{message:i,local:s})}Ut.hookFunction("TextLoad",5,((e,t)=>"WetMinigame"===CurrentScreen||"MessMinigame"===CurrentScreen?void 0:t(e)));function hn(e){var t=e.name;console.log("Registering minigame: "+t),window[t+"Run"]=()=>e.Run(),window[t+"Click"]=()=>e.Click(),window[t+"Load"]=()=>e.Load(),window[t+"Unload"]=()=>e.Unload(),window[t+"Resize"]=()=>e.Resize(),window[t+"KeyDown"]=()=>e.KeyDown(),window[t+"Exit"]=()=>e.Exit(),window[t+"End"]=t=>e.End(t)}class pn{constructor(){this.name=""}Load(){}Unload(){}Resize(){}KeyDown(){}Exit(){}End(e){}}class mn extends pn{constructor(){super(...arguments),this.startText="",this.hintText="",this.failText="",this.successText="",this.tintColor=[{r:0,g:0,b:0,a:0}],this.GameStartTime=0,this.GameEndTime=0,this.StartDelay=4e3,this.AccidentVelocity=0,this.AccidentPosition=0,this.AccidentAcceleration=0,this.AccidentMaxPosition=100,this.AccidentGameDuration=5e3,this.AccidentNextTick=0,this.AccidentText="",this.AccidentChallenge=0,this.BaseGameLength=6e3}End(e){CommonSetScreen("Online","ChatRoom"),MiniGameVictory=e,MiniGameEnded=!0,MiniGameTimer=CommonTime(),this.GameEndTime=MiniGameTimer}get IsStartDelay(){return CommonTime()<this.GameStartTime}Load(){if(DrawFlashScreen("#000000",750,1e3),this.GameStartTime=CommonTime()+this.StartDelay,this.AccidentVelocity=0,this.AccidentAcceleration=0,"number"!=typeof MiniGameDifficulty)MiniGameTimer=CommonTime()+this.BaseGameLength,this.AccidentChallenge=5;else{var e=.25*(MiniGameDifficulty-8);this.AccidentGameDuration=this.BaseGameLength+1e3*e,MiniGameTimer=this.GameStartTime+this.AccidentGameDuration,this.AccidentChallenge=MiniGameDifficulty}this.AccidentMaxPosition=400,this.AccidentPosition=this.AccidentMaxPosition,console.info("Accident minigame started: difficulty - "+this.AccidentChallenge+" time - "+this.AccidentGameDuration),CharacterSetFacialExpression(Player,"Eyes","Daydream",10),this.AccidentChallenge>25?CharacterSetFacialExpression(Player,"Blush","ShortBreath",10):CharacterSetFacialExpression(Player,"Blush","Low",10)}get IsGameActive(){return CommonTime()<MiniGameTimer&&!MiniGameEnded&&!this.GameFailed}get IsGameTimeout(){return CommonTime()>=MiniGameTimer&&!MiniGameEnded}get IsEndGameReport(){return CommonTime()<this.GameEndTime+5e3}get GameFailed(){return this.AccidentPosition<=0}RunGame(e){var t=(this.AccidentGameDuration+CommonTime()-MiniGameTimer)/1e3;CommonTime()>this.AccidentNextTick&&(this.AccidentNextTick=CommonTime()+400,this.AccidentAcceleration=-1.25*this.AccidentChallenge-t*Math.random()),this.AccidentVelocity=Math.min(this.AccidentVelocity,this.AccidentVelocity+.25*this.AccidentAcceleration),this.AccidentPosition>=this.AccidentMaxPosition&&(this.AccidentVelocity=Math.min(0,this.AccidentVelocity)),this.AccidentPosition>0&&(this.AccidentPosition+=this.AccidentVelocity/1e3*e*3.5),this.AccidentPosition=Math.max(0,Math.min(this.AccidentPosition,this.AccidentMaxPosition)),DrawProgressBar(500-this.AccidentMaxPosition,800,2*this.AccidentMaxPosition,50,this.AccidentPosition/this.AccidentMaxPosition*100),DrawText(this.hintText,500,875,"white","black")}Run(){ChatRoomRun(CommonTime()),this.IsStartDelay?DrawText(this.startText,500,500,"white","black"):this.IsGameActive?this.RunGame(TimerRunInterval):!this.IsGameTimeout&&!this.GameFailed||MiniGameEnded||(this.End(this.AccidentPosition>0),MiniGameEnd())}Click(){var e;this.IsGameActive&&(this.AccidentVelocity=Math.max(this.AccidentVelocity+(e=11,Math.floor(Math.random()*e)+5),20))}}class fn extends mn{constructor(){super(...arguments),this.startText="A sudden pressure builds within you...",this.hintText="Click to maintain control. Keep it together!",this.failText="Oops! You've had an accident!",this.successText="Crisis averted! You stayed composed!",this.name="MessMinigame"}End(e){if(super.End(e),e)return Cn.stats.Incontinence-=zn(Cn.stats.Incontinence)/2,void Wt("You managed to keep it together!");Cn.soil(),Cn.onAccident()}}class gn extends mn{constructor(){super(...arguments),this.startText="You feel a trickle starting...",this.hintText="Click to squeeze tight. Don't let it get away!",this.failText="Oh no! You lost control!",this.successText="You held it in! Phew!",this.name="WetMinigame"}End(e){if(super.End(e),e)return Cn.stats.Incontinence-=zn(Cn.stats.Incontinence)/2,Wt("You managed to hold it in!"),void CharacterSetFacialExpression(Player,"Mouth","Happy",20);CharacterSetFacialExpression(Player,"Blush","Low",10),CharacterSetFacialExpression(Player,"Eyes","Surprised",9),Cn.wet(),Cn.onAccident()}}const yn="2.2.2",En="ABCL",vn=1002,_n=()=>{CharacterRefresh(Player,!0)},bn=new qt(72e5),An=new qt(72e5),Sn=new qt(3e5),Cn={onAccident:()=>{Cn.stats.MentalRegression+=Un()},update:()=>{Player.ABCL.Settings.PauseStats||(bn.allowedCallInterval=12e4/Math.max(.1,a[Player.ABCL.Settings.PoopMetabolism]),An.allowedCallInterval=12e4/Math.max(.1,a[Player.ABCL.Settings.PeeMetabolism]),Sn.check()&&(Cn.stats.MentalRegression+=Vn()),An.check()&&"Disabled"!==Player.ABCL.Settings.PeeMetabolism&&(Cn.stats.BladderValue+=Cn.stats.WaterIntake*a[Player.ABCL.Settings.PeeMetabolism],Cn.attemptWetting()),bn.check()&&"Disabled"!==Player.ABCL.Settings.PoopMetabolism&&(Cn.stats.BowelValue+=Cn.stats.FoodIntake*a[Player.ABCL.Settings.PoopMetabolism],Cn.attemptSoiling()),Pn.save())},wetClothing:()=>{if(Player.ABCL.Settings.DisableWettingLeaks)return;if(Wt("You've had a wet accident in your clothes!"),Cn.stats.PuddleSize+=Cn.stats.BladderValue,Cn.stats.BladderValue=0,wn()?dn("%NAME%'s diaper leaks and wet %POSSESSIVE% clothes causing a puddle to form.",void 0,"wetClothing"):dn("%NAME%'s wets %POSSESSIVE% clothes and leaks onto the floor.",void 0,"wetClothing"),Tr(),Player.ABCL.Settings.DisableClothingStains)return;const e="#96936C",n=InventoryGet(Player,"Panties");if(n&&!Mn(n)){const t=Kt(n.Color||n.Asset.DefaultColor,n.Asset);for(let n=0;n<t.length;n++)Zt(t[n])&&(t[n]=Bn(t[n],e,.3));n.Color=t}for(const n of Player.Appearance)if(t.ItemDefinitions.Pants.some((e=>e===n.Asset.Description))){const t=Kt(n.Color||n.Asset.DefaultColor,n.Asset);for(let n=0;n<t.length;n++)Zt(t[n])&&(t[n]=Bn(t[n],e,.3));n.Color=t}_n()},soilClothing:()=>{if(Player.ABCL.Settings.DisableSoilingLeaks)return;if(Cn.stats.BowelValue=0,wn()?dn("%NAME%'s diaper leaks and soils %POSSESSIVE% clothes.",void 0,"soilClothing"):dn("%NAME% soils %POSSESSIVE% clothes.",void 0,"soilClothing"),Tr(),Player.ABCL.Settings.DisableClothingStains)return;const e="#261a16",n=InventoryGet(Player,"Panties");if(n&&!Mn(n)){const t=Kt(n.Color||n.Asset.DefaultColor,n.Asset);for(let n=0;n<t.length;n++)Zt(t[n])&&(t[n]=Bn(t[n],e,.3));n.Color=t}for(const n of Player.Appearance)if(t.ItemDefinitions.Pants.some((e=>e===n.Asset.Description))){const t=Kt(n.Color||n.Asset.DefaultColor,n.Asset);for(let n=0;n<t.length;n++)Zt(t[n])&&(t[n]=Bn(t[n],e,.3));n.Color=t}_n()},wetDiaper:()=>{const e=$n(),t=Math.min(Cn.stats.BladderValue,Math.max(0,e-Cn.stats.WetnessValue));dn("%NAME% wets %POSSESSIVE% diaper.",void 0,"wetDiaper"),Cn.stats.BladderValue-=t,Cn.stats.WetnessValue+=t,Cn.stats.WetnessValue>=e&&Cn.wetClothing()},soilDiaper:()=>{const e=$n(),t=Math.min(Cn.stats.BowelValue,Math.max(0,e-Cn.stats.SoilinessValue));dn("%NAME% soils %POSSESSIVE% diaper.",void 0,"soilDiaper"),Cn.stats.BowelValue-=t,Cn.stats.SoilinessValue+=t,Cn.stats.SoilinessValue>=e&&Cn.soilClothing()},attemptWetting:()=>{const e=xn(Cn.stats.Incontinence),t=Gn(Cn.stats.Incontinence,Cn.stats.BladderFullness);if((Math.random()<t||Cn.stats.BladderFullness>e)&&Ln.check())return window?.LITTLISH_CLUB&&window.LITTLISH_CLUB.isRuleActive(Player,vn)?(new gn).End(!1):void MiniGameStart("WetMinigame",30*t,"CommonNoop")},attemptSoiling:()=>{const e=xn(Cn.stats.Incontinence),t=Gn(Cn.stats.Incontinence,Cn.stats.BowelFullness);if((Math.random()<t||Cn.stats.BowelFullness>e)&&Ln.check())return window?.LITTLISH_CLUB&&window.LITTLISH_CLUB.isRuleActive(Player,vn)?(new fn).End(!1):void MiniGameStart("MessMinigame",30*t,"CommonNoop")},wet:(e=!1)=>{const t=.3*Cn.stats.Incontinence,n=Cn.stats.BladderFullness<.3-t,r=!n,i=Cn.stats.BladderFullness>.6-t;n&&e?Wt("You try to pee, but it doesn't seem to be working."):(r&&(wn()?Cn.wetDiaper():Cn.wetClothing()),i&&e?Cn.stats.Incontinence-=zn(Cn.stats.Incontinence):Cn.stats.Incontinence+=zn(Cn.stats.Incontinence))},soil:(e=!1)=>{const t=.3*Cn.stats.Incontinence,n=Cn.stats.BowelFullness<.3-t,r=!n,i=Cn.stats.BowelFullness>.6-t;n&&e?Wt("You try to let go, but nothing seems to happen."):(r&&(wn()?Cn.soilDiaper():Cn.soilClothing()),i&&e?Cn.stats.Incontinence-=.01:Cn.stats.Incontinence+=.02)},stats:{set PuddleSize(e){e<0&&(e=0),e>250&&(e=250);const t=e-Player.ABCL.Stats.PuddleSize.value;un("PuddleSize",t),Player.ABCL.Stats.PuddleSize.value=e},get PuddleSize(){return Player.ABCL.Stats.PuddleSize.value},get MentalRegressionModifier(){return a[Player.ABCL.Settings.MentalRegressionModifier]},set MentalRegression(e){e<0&&(e=0),e>1&&(e=1);const t=e-Player.ABCL.Stats.MentalRegression.value;un("MentalRegression",t,!0),Player.ABCL.Stats.MentalRegression.value=e,Qt.update()},get MentalRegression(){return Player.ABCL.Stats.MentalRegression.value},set Incontinence(e){e<0&&(e=0),e>1&&(e=1);const t=e-Player.ABCL.Stats.Incontinence.value;un("Incontinence",t,!0),Player.ABCL.Stats.Incontinence.value=e,Qt.update()},get Incontinence(){return Player.ABCL.Stats.Incontinence.value},set WaterIntake(e){e<0&&(e=0),Player.ABCL.Stats.WaterIntake.value=e},get WaterIntake(){return Player.ABCL.Stats.WaterIntake.value},set FoodIntake(e){e<0&&(e=0),Player.ABCL.Stats.FoodIntake.value=e},get FoodIntake(){return Player.ABCL.Stats.FoodIntake.value},set BladderValue(e){e<0&&(e=0);const t=e/this.BladderSize-this.BladderFullness;un("Bladder",t,!0),Player.ABCL.Stats.Bladder.value=e,Qt.update()},get BladderValue(){return Player.ABCL.Stats.Bladder.value},set BladderSize(e){e<0&&(e=0),Player.ABCL.Stats.Bladder.size=e,Qt.update()},get BladderSize(){return Player.ABCL.Stats.Bladder.size},set WetnessValue(e){e<0&&(e=0);const t=e/$n()-this.WetnessPercentage;un("Wetness",t,!0),Player.ABCL.Stats.Wetness.value=e,kn(),Qt.update()},get WetnessValue(){return Player.ABCL.Stats.Wetness.value},set BladderFullness(e){e<0&&(e=0),this.BladderValue=e*this.BladderSize,Qt.update()},get BladderFullness(){return this.BladderValue/this.BladderSize},set BowelValue(e){e<0&&(e=0);const t=e/this.BowelSize-this.BowelFullness;un("Bowel",t,!0),Player.ABCL.Stats.Bowel.value=e,Qt.update()},get BowelValue(){return Player.ABCL.Stats.Bowel.value},set BowelSize(e){e<0&&(e=0),Player.ABCL.Stats.Bowel.size=e,Qt.update()},get BowelSize(){return Player.ABCL.Stats.Bowel.size},set SoilinessValue(e){e<0&&(e=0);const t=e/$n()-this.SoilinessPercentage;un("Soiliness",t,!0),Player.ABCL.Stats.Soiliness.value=e,kn(),Qt.update()},get SoilinessValue(){return Player.ABCL.Stats.Soiliness.value},set BowelFullness(e){e<0&&(e=0),this.BowelValue=e*this.BowelSize,Qt.update()},get BowelFullness(){return this.BowelValue/this.BowelSize},get SoilinessPercentage(){return 0==$n()?0:this.SoilinessValue/$n()},set SoilinessPercentage(e){e<0&&(e=0),this.SoilinessValue=e*$n()},get WetnessPercentage(){return 0==$n()?0:this.WetnessValue/$n()},set WetnessPercentage(e){e<0&&(e=0),this.WetnessValue=e*$n()}}},Pn=new class{constructor(e){this.lastSaveTime=0,this.allowedSaveInterval=e}save(){Date.now()-this.lastSaveTime>this.allowedSaveInterval&&(Bt(),this.lastSaveTime=Date.now())}}(12e4),Ln=new qt(12e4);window.abclPlayer=Cn;const In=(e="any")=>{const t=$n();return"pee"===e?Cn.stats.PuddleSize>0:"poop"===e?Cn.stats.SoilinessValue>=t:Cn.stats.SoilinessValue>=t||Cn.stats.WetnessValue>=t},Nn=()=>{const e=$n();return Cn.stats.SoilinessValue+Cn.stats.WetnessValue>=e/2},Mn=e=>e.Asset.Description.toLowerCase().includes("diaper")&&e.Asset.Description in t.Diapers;function wn(e=Player){if(!e)return!1;const t=InventoryGet(e,"ItemPelvis"),n=InventoryGet(e,"Panties");return Boolean(t&&Mn(t)||n&&Mn(n))}function Bn(e,t,n=.5){let r=DrawHexToRGB(e),i=DrawHexToRGB(t),s={r:Math.round(r.r*n+i.r*(1-n)),g:Math.round(r.g*n+i.g*(1-n)),b:Math.round(r.b*n+i.b*(1-n))};return DrawRGBToHex([s.r,s.g,s.b])}function Dn(e,t,n,r){return e>.75?e>.9?t:Bn(t,n,e-.75):Bn(n,r,e)}const Rn=(e=Player)=>{if(!wn())return!1;const t=InventoryGet(e,"ItemPelvis");return Boolean(t&&Mn(t)&&(Player.MemberNumber===e.MemberNumber?t.Property?.LockedBy:!(t.Property?.LockMemberNumber===e.MemberNumber||"ExclusivePadlock"===t.Property?.LockedBy)))},On=(e,n,r=Player)=>{if(Player.ABCL.Settings.DisableDiaperStains)return;const i=InventoryGet(r,e);if(i&&Mn(i)){const e=i.Color&&"string"!=typeof i.Color?[...i.Color]:[...i.Asset.DefaultColor],r=t.Diapers[i.Asset.Description],s=Math.min(Cn.stats.SoilinessValue+Cn.stats.WetnessValue/$n(),1);if("indicator"in r)for(const n of r.indicator)e[n]=Bn(t.DiaperColors.indicatorAccident,i.Asset.DefaultColor[n],s);if("gradients"in r)for(const t of r.gradients)i.Property?.Opacity&&"object"==typeof i.Property.Opacity&&(i.Property.Opacity[t]=s,e[t]=n);if("color"in r)for(const t of r.color)e[t]=n;i.Color=e}},kn=()=>{const e=Cn.stats.SoilinessValue/$n(),n=Cn.stats.WetnessValue/$n(),r=Bn(Dn(e,t.DiaperColors.maximummess,t.DiaperColors.middlemess,t.DiaperColors.clean),Dn(n,t.DiaperColors.maximumwet,t.DiaperColors.middlewet,t.DiaperColors.clean),Math.max(Math.min((e+(1-n))/2,2),0));On("ItemPelvis",r,Player),On("Panties",r,Player),_n()};function $n(e=Player){const t=InventoryGet(e,"ItemPelvis"),n=InventoryGet(e,"Panties");let r=50;return t&&Mn(t)&&(r+=Tn(t)),n&&Mn(n)&&(r+=Tn(n)),r}function Tn(e){return"Poofy Chastity Diaper"===e.Asset.Description&&1===e.Property?.TypeRecord?.typed?t.DiaperSizeScale.heavy_adult:t.DiaperSizeScale[t.Diapers[e.Asset.Description].size]}const Fn=()=>{const e=InventoryGet(Player,"ItemPelvis"),t=InventoryGet(Player,"Panties");let n={ItemPelvis:null,Panties:null};return e&&Mn(e)&&(n.ItemPelvis=e),t&&Mn(t)&&(n.Panties=t),n},xn=e=>.9-.5*e;function Gn(e,t){const n=.6*Math.pow(e,2)+.8*Math.pow(t,3);return Math.min(Math.max(n,0),1)}const jn=()=>{const e=Player.Appearance.map((e=>e.Asset.Description)),n=t.ItemDefinitions.BabyItems.concat(["milk","pacifier","bib"]).filter((t=>e.some((e=>e.toLocaleLowerCase().includes(t)))));return Math.min(.25*n.length,1)},Vn=()=>{let e=jn();Player.Appearance.some((e=>t.ItemDefinitions.BabyItems.includes(e.Asset.Description)))&&(e+=1),Nn()&&(e+=1),In()&&(e+=1);const n=e/4,r=.0025,i=Cn.stats.MentalRegression;return Cn.stats.MentalRegression<n?Math.round(r*e*(1+i/3)*5*Cn.stats.MentalRegressionModifier*100)/100:Math.round(-r/Math.max(1,e)/(1+i)*3*5*Cn.stats.MentalRegressionModifier*100)/100},zn=e=>{const t=[{increase:.01,start:0,end:.25},{increase:.005,start:.25,end:.5},{increase:.0025,start:.5,end:.75},{increase:.001,start:.75,end:1}];for(const{increase:n,start:r,end:i}of t)if(e>=r&&e<i)return n;return 0},Un=()=>{const e=1+jn()*Cn.stats.MentalRegressionModifier;return Cn.stats.MentalRegression<.25||.25>Cn.stats.MentalRegression&&Cn.stats.MentalRegression<.5&&Nn()?e/500:.5>Cn.stats.MentalRegression&&Cn.stats.MentalRegression<.75&&In()?e/1e3:.75>Cn.stats.MentalRegression&&Cn.stats.MentalRegression<1&&In()?e/1500:0},Hn=e=>{if(!wn(e))return"";const t=$n(e),n=e.ABCL.Stats.Soiliness.value/t>.5,r=e.ABCL.Stats.Wetness.value/t>.5,i=e.ABCL.Stats.Wetness.value/t>.8,s=e.ABCL.Stats.Soiliness.value/t>.8;return i&&s?"soggy and stinky":s?"stinky":i?"soggy":r?"wet":n?"messy":"dry"},Wn=(e,t)=>{if(e.MemberNumber!==Player.MemberNumber)return $r("changeDiaper-pending",{force:t},e.MemberNumber);Xn(e)},Xn=e=>{dn(cn(e.MemberNumber===Player.MemberNumber?"%NAME% changes %POSSESSIVE% diaper.":"%OPP_NAME% changes %NAME%'s diaper.",e),void 0,"changeDiaper",e),Cn.stats.WetnessValue=0,Cn.stats.SoilinessValue=0,kn()},Yn={activity:{ID:"change-diaper",Name:"Change Diaper",Image:"https://zoe-64.github.io/ABCL/versions/2.2.2/assets/activity/changeDiaper.svg",Target:["ItemPelvis"],OnClick:(e,t)=>Wn(e),Criteria:e=>wn(e)&&an(e)&&!Player.IsRestrained()&&!Rn()},command:{Tag:"change-diaper",Action:(e,t,n)=>{const r=on(n)??Player;if(!Yn.activity.Criteria(r))return Wt("Is either not diapered or not an ABCL player or you are restrained or diaper is locked.");Wn(r)},Description:" [MemberNumber|Name|Nickname]: Changes someone's diaper."},listeners:{"changeDiaper-accepted":({Sender:e})=>Wt(`${ln(e)} accepted your change diaper request.`),"changeDiaper-rejected":({Sender:e})=>Wt(`${ln(e)} rejected your change diaper request.`),"changeDiaper-pending":({Sender:e},{force:t})=>{if(t)return Xn(sn(e)??Player);switch(Player.ABCL.Settings.OnDiaperChange){case s:new tn(`${ln(e)} wants to change your diaper.`,(()=>{Xn(sn(e)??Player),$r("changeDiaper-accepted",void 0,e)}),(()=>$r("changeDiaper-rejected",void 0,e)),1e4);break;case o:Xn(sn(e)??Player),$r("changeDiaper-accepted",void 0,e);break;case i:$r("changeDiaper-rejected",void 0,e)}}}},qn=e=>{const t=e.MemberNumber===Player.MemberNumber;if(Qt.setMemberNumber(e.MemberNumber),Jt(document.body,"#ABCL-stats").classList.remove("ABCL-hidden"),setTimeout((()=>{rn()}),250),!(Math.random()<.75))return wn(e)?dn(cn(t?"%NAME% checks %POSSESSIVE% diaper.":"%NAME% checks %OPP_NAME%'s diaper.",e),void 0,"checkDiaper",e):dn(cn(t?"%NAME% checks %POSSESSIVE% clothes for any accidents.":"%NAME% checks %OPP_NAME%'s clothes for any accidents.",e),void 0,"checkDiaper",e)},Zn={activity:{ID:"check-diaper",Name:"Check Diaper",Image:"https://zoe-64.github.io/ABCL/versions/2.2.2/assets/activity/diaperCheck.png",OnClick:(e,t)=>qn(e),Target:["ItemPelvis"],Criteria:e=>an(e)&&!Player.IsRestrained()},command:{Tag:"check-diaper",Description:" [MemberNumber|Name|Nickname]: Checks someone's diaper.",Action:(e,t,n)=>{const r=on(n)??Player;if(!Zn.activity.Criteria(r))return Wt("Is not an ABCL player or you are restrained.");qn(r)}}},Kn=e=>{dn(cn("%OPP_NAME% rubs %OPP_POSSESSIVE% diaper against %NAME%'s face.",e),void 0,"playerActivity",e),ActivityEffectFlat(e,Player,8,"ItemVulva",1),CharacterSetFacialExpression(Player,"Blush","Medium",5),CharacterSetFacialExpression(Player,"Eyebrows","Soft",10),CharacterSetFacialExpression(Player,"Eyes","Dizzy",10),Cn.stats.MentalRegression+=.02*Cn.stats.MentalRegressionModifier},Jn={activity:{ID:"diaper-face-rub",Name:"Rub Diaper Against Face",Image:"https://zoe-64.github.io/ABCL/versions/2.2.2/assets/activity/diaperFaceRub.png",Target:["ItemNose"],OnClick:(e,t)=>(e=>{if(e.MemberNumber!==Player.MemberNumber)return ActivityEffectFlat(Player,Player,12,"ItemVulva",1),$r("diaper-face-rub",void 0,e.MemberNumber);Kn(e)})(e),Criteria:e=>wn(e)&&an(e)&&!Player.IsRestrained()&&e.MemberNumber!==Player.MemberNumber},listeners:{"diaper-face-rub":({Sender:e})=>Kn(sn(e)??Player)}},Qn=e=>{dn(cn("%OPP_NAME% sits with her diapered butt on %NAME%'s face.",e),void 0,"playerActivity",e),Cn.stats.MentalRegression+=.03*Cn.stats.MentalRegressionModifier,ActivityEffectFlat(Player,Player,8,"ItemNose",1),CharacterSetFacialExpression(Player,"Blush","ShortBreath",30),CharacterSetFacialExpression(Player,"Eyebrows","Soft",30),CharacterSetFacialExpression(Player,"Eyes","Dizzy",30)},er={activity:{ID:"diaper-face-sit",Name:"Sits with Diaper on Face",Image:"https://zoe-64.github.io/ABCL/versions/2.2.2/assets/activity/diaperFaceSit.png",Target:["ItemNose"],OnClick:(e,t)=>(e=>{if(e.MemberNumber!==Player.MemberNumber)return ActivityEffectFlat(Player,Player,5,"ItemButt",1),$r("diaper-face-sit",void 0,e.MemberNumber);Qn(e)})(e),Criteria:e=>wn(Player)&&an(e)&&!Player.IsRestrained()&&e.MemberNumber!==Player.MemberNumber},listeners:{"diaper-face-sit":({Sender:e})=>Qn(sn(e)??Player)}},tr=e=>{const t=Hn(Player),n="dry"===t?"crinkles":"sloshes",r="dry"===t?"crinkle":"slosh",i=e.MemberNumber===Player.MemberNumber,s=`%NAME% playfully pats %POSSESSIVE% ${t} diapered butt, enjoying the soft ${n} it makes.`,o=`%OPP_NAME% gives %NAME%'s diapered butt a playful pat, as the ${t} diaper ${r} softly.`;ActivityEffectFlat(Player,Player,1,"ItemButt",1),dn(cn(i?s:o,e),void 0,"playerActivity",e)},nr={activity:{ID:"diaper-pat-back",Name:"Diaper Pat Bottom",Image:"https://zoe-64.github.io/ABCL/versions/2.2.2/assets/activity/diaperPatBack.png",Target:["ItemButt"],OnClick:(e,t)=>(e=>{if(e.MemberNumber!==Player.MemberNumber)return $r("diaper-pat-back",void 0,e.MemberNumber);tr(e)})(e),Criteria:e=>an(e)&&wn(e)&&!Player.IsRestrained()},listeners:{"diaper-pat-back":({Sender:e})=>tr(sn(e)??Player)}},rr=e=>{const t=Hn(Player),n="dry"===t?"crinkles":"sloshes";dn(cn(e.MemberNumber===Player.MemberNumber?`%NAME% pats the front of %POSSESSIVE% ${t} diaper playfully, smiling at the soft ${n}.`:`%OPP_NAME% playfully pats the front of %NAME%'s ${t} diaper, as the padding ${n} softly.`,e),void 0,"playerActivity",e),ActivityEffectFlat(Player,Player,1,"ItemVulva",1)},ir={activity:{ID:"diaper-pat-front",Name:"Diaper Pat Crotch",Image:"https://zoe-64.github.io/ABCL/versions/2.2.2/assets/activity/diaperPatFront.png",Target:["ItemVulva"],OnClick:(e,t)=>(e=>{if(e.MemberNumber!==Player.MemberNumber)return $r("diaper-pat-front",void 0,e.MemberNumber);rr(e)})(e),Criteria:e=>an(e)&&wn(e)&&!Player.IsRestrained()},listeners:{"diaper-pat-front":({Sender:e})=>rr(sn(e)??Player)}},sr=(e,t)=>{dn(cn("%OPP_NAME% tugs %NAME%'s diaper waistband and pees inside.",e),void 0,"playerActivity",e),CharacterSetFacialExpression(Player,"Blush","Low",8),CharacterSetFacialExpression(Player,"Eyebrows","Soft",8),CharacterSetFacialExpression(Player,"Eyes","Surprised",5),Cn.stats.WetnessValue+=t??0},or={activity:{ID:"pee-in-diaper",Name:"Pees in Diaper",Image:"https://zoe-64.github.io/ABCL/versions/2.2.2/assets/activity/diaperPeeOthersDiaper.png",Target:["ItemPelvis"],OnClick:(e,t)=>((e,t)=>{if(e.MemberNumber!==Player.MemberNumber)return $r("diaper-pee-others-diaper",{volume:t},e.MemberNumber);Cn.stats.BladderValue=0,sr(e,t)})(e,Cn.stats.BladderValue),Criteria:e=>an(e)&&wn(e)&&Cn.stats.BladderValue>0&&e!==Player&&!Player.IsRestrained()},listeners:{"diaper-pee-others-diaper":({Sender:e},{volume:t})=>sr(sn(e)??Player,t)}},ar=e=>{dn(cn(e.MemberNumber===Player.MemberNumber?"%NAME% pours water in %POSSESSIVE% diaper.":"%OPP_NAME% pours water in %NAME%'s diaper.",e),void 0,"playerActivity",e),Cn.stats.WetnessValue+=500,CharacterSetFacialExpression(Player,"Blush","Low",8),CharacterSetFacialExpression(Player,"Eyebrows","Soft",8),CharacterSetFacialExpression(Player,"Eyes","Surprised",5),CharacterSetFacialExpression(Player,"Eyes","Daydream",2)},lr={activity:{ID:"diaper-pour",Name:"Pour Water in Diaper",Image:"https://zoe-64.github.io/ABCL/versions/2.2.2/assets/activity/diaperPour.png",Target:["ItemPelvis"],OnClick:(e,t)=>(e=>{if(e.MemberNumber!==Player.MemberNumber)return $r("diaper-pour",void 0,e.MemberNumber);ar(e)})(e),Criteria:e=>wn(e)&&an(e)&&!Player.IsRestrained()},listeners:{"diaper-pour":({Sender:e})=>ar(sn(e)??Player)}},cr=e=>{const t=Hn(Player),n="dry"===t?"crinkles":"sloshes";dn(cn(e.MemberNumber===Player.MemberNumber?`%NAME% blushes as %PRONOUN% rubs %POSSESSIVE% ${t} diapered butt with both hands, breath hitching at the soft ${n} under %POSSESSIVE% hands.`:`%OPP_NAME% runs %OPP_POSSESSIVE% hand over %NAME%'s ${t} diapered butt, rubbing affectionate circles into the ${t} padding.`,e),void 0,"playerActivity",e),ActivityEffectFlat(Player,Player,5,"ItemButt",1),Cn.stats.Incontinence>Math.random()&&Cn.attemptSoiling()},ur={activity:{ID:"diaper-rub-back",Name:"Diaper Rub Bottom",Image:"https://zoe-64.github.io/ABCL/versions/2.2.2/assets/activity/diaperRubBack.png",Target:["ItemButt"],OnClick:(e,t)=>(e=>{if(e.MemberNumber!==Player.MemberNumber)return $r("diaper-rub-back",void 0,e.MemberNumber);cr(e)})(e),Criteria:e=>an(e)&&wn(e)&&!Player.IsRestrained()},listeners:{"diaper-rub-back":({Sender:e})=>cr(sn(e)??Player)}},dr=e=>{const t=Hn(Player);dn(cn(e.MemberNumber===Player.MemberNumber?`%NAME% blushes as %PRONOUN% rubs circles over the front of %POSSESSIVE% ${t} diaper, biting %POSSESSIVE% lip as %PRONOUN% grinds down into %POSSESSIVE% own hand.`:`%OPP_NAME% rubs up and down %NAME%'s ${t} diaper, %OPP_POSSESSIVE% fingers pressing into the ${t} padding over the front and between %POSSESSIVE% legs.`,e),void 0,"playerActivity",e),ActivityEffectFlat(Player,Player,10,"ItemVulva",1),Cn.stats.Incontinence>Math.random()&&Cn.attemptWetting()},hr={activity:{ID:"diaper-rub-front",Name:"Diaper Rub",Image:"https://zoe-64.github.io/ABCL/versions/2.2.2/assets/activity/diaperRubFront.png",Target:["ItemVulva"],OnClick:(e,t)=>(e=>{if(e.MemberNumber!==Player.MemberNumber)return $r("diaper-rub-front",void 0,e.MemberNumber);dr(e)})(e),Criteria:e=>an(e)&&wn(e)&&!Player.IsRestrained()},listeners:{"diaper-rub-front":({Sender:e})=>dr(sn(e)??Player)}},pr=e=>{const t=Hn(Player);dn(cn(e.MemberNumber===Player.MemberNumber?`%NAME% gives %POSSESSIVE% ${t} diapered butt a squeeze, blushing a little as it squishes under %POSSESSIVE% hand.`:`%OPP_NAME% gives %NAME%'s ${t} diapered butt a teasing squeeze, smiling as %OPP_PRONOUN% squishes and kneads the ${t} padding.`,e),void 0,"playerActivity",e)},mr={activity:{ID:"diaper-squish-back",Name:"Diaper Squish Bottom",Image:"https://zoe-64.github.io/ABCL/versions/2.2.2/assets/activity/diaperSquishBack.png",Target:["ItemButt"],OnClick:(e,t)=>(e=>{if(e.MemberNumber!==Player.MemberNumber)return $r("diaper-squish-back",void 0,e.MemberNumber);pr(e)})(e),Criteria:e=>an(e)&&wn(e)&&!Player.IsRestrained()},listeners:{"diaper-squish-back":({Sender:e})=>pr(sn(e)??Player)}},fr=e=>{const t=Hn(Player);dn(cn(e.MemberNumber===Player.MemberNumber?`%NAME% presses into the front of %POSSESSIVE% ${t} diaper, blushing as %PRONOUN% squishes %POSSESSIVE% ${t} padding.`:`%OPP_NAME% presses her hand into %NAME%'s ${t} diaper, giggling as %OPP_PRONOUN% squishes the ${t} padding between %POSSESSIVE% legs.`,e),void 0,"playerActivity",e)},gr={activity:{ID:"diaper-squish-front",Name:"Diaper Squish Crotch",Image:"https://zoe-64.github.io/ABCL/versions/2.2.2/assets/activity/diaperSquishFront.png",Target:["ItemVulva"],OnClick:(e,t)=>(e=>{if(e.MemberNumber!==Player.MemberNumber)return $r("diaper-squish-front",void 0,e.MemberNumber);fr(e)})(e),Criteria:e=>an(e)&&wn(e)&&!Player.IsRestrained()},listeners:{"diaper-squish-front":({Sender:e})=>fr(sn(e)??Player)}},yr=e=>{if(!(e.MemberNumber===Player.MemberNumber))return $r("lick-puddle",void 0,e.MemberNumber);Er(Player)},Er=e=>{dn(cn(e.MemberNumber===Player.MemberNumber?"%NAME% licks %POSSESSIVE% puddle of pee.":"%OPP_NAME% licks %NAME%'s puddle of pee.",e),void 0,"lickPuddle",e),CharacterSetFacialExpression(Player,"Fluids","DroolLow",20),Tr(),_n(),Cn.stats.PuddleSize-=50},vr={activity:{ID:"lick-puddle",Name:"Lick Puddle",Image:"https://zoe-64.github.io/ABCL/versions/2.2.2/assets/activity/lickPuddle.png",Target:["ItemBoots"],OnClick:(e,t)=>yr(e),Criteria:e=>an(e)&&e.ABCL.Stats.PuddleSize.value>0},command:{Tag:"lick-puddle",Action:(e,t,n)=>{const r=on(n)??Player;if(!vr.activity.Criteria(r))return Wt("Is either not an ABCL player or has no puddle.");yr(r)},Description:" [MemberNumber|Name|Nickname]: Licks a puddle of pee."},listeners:{"lick-puddle":({Sender:e})=>Er(sn(e)??Player)}},_r={listeners:{onABCLMessage:({Sender:e},{message:t,local:n})=>{Wt(t,void 0,"background: #FFA9A93B",n)}}},br=()=>{const e=Player.ABCL.Settings.PauseStats;dn(e?"%NAME% resumed their ABCL stats.":"%NAME% paused their ABCL stats.",Player,"pauseStats"),Player.ABCL.Settings.PauseStats=!e},Ar={activity:{ID:"pauseStats",Name:"Pause Stats",Image:"https://zoe-64.github.io/ABCL/versions/2.2.2/assets/activity/pauseStats.png",TargetSelf:["ItemPelvis"],OnClick:(e,t)=>br(),Criteria:e=>!0},command:{Tag:"pause-stats",Action:(e,t,n)=>br(),Description:" Pauses the ABCL stats."}},Sr={listeners:{sync:({Sender:t},n)=>{if(!t)return;console.log("sync:ABCL"),e.debug({message:"Received updated data",data:n});const r=sn(t);r&&(r.ABCL={Stats:n.stats,Version:n.version,Settings:n.settings})},init:({Sender:t})=>{console.log("init"),e.debug("Received request for data"),Tr(t)}}},Cr={activity:{ID:"pee",Name:"Pee",Image:"https://zoe-64.github.io/ABCL/versions/2.2.2/assets/activity/wetDiaper.svg",OnClick:(e,t)=>Cn.wet(!0),TargetSelf:["ItemPelvis"]},command:{Tag:"pee",Action:(e,t,n)=>Cn.wet(!0),Description:" Lets go of your bladder."}},Pr={activity:{ID:"poop",Name:"Poop",Image:"https://zoe-64.github.io/ABCL/versions/2.2.2/assets/activity/soilDiaper.svg",OnClick:(e,t)=>Cn.soil(!0),TargetSelf:["ItemPelvis"]},command:{Tag:"poop",Action:()=>Cn.soil(!0),Description:" Relaxes your bowels."}},Lr=()=>{const e=.3*Cn.stats.Incontinence,t=Cn.stats.BladderFullness>.6||Cn.stats.BowelFullness>.6,n=Cn.stats.BladderFullness<.3-e&&Cn.stats.BowelFullness<.3-e,r=Cn.stats.MentalRegression>.9,i=Cn.stats.MentalRegression<.3;if(n)return void dn("%NAME% tries to use the potty but can't seem to get anything out.",void 0,"usePotty");Cn.stats.BowelFullness=0,Cn.stats.BladderFullness=0;let s="";i&&(s="and feels embarrased",CharacterSetFacialExpression(Player,"Blush","Low",10),Cn.stats.MentalRegression+=.04*Cn.stats.MentalRegressionModifier),t&&!r&&(s+=i?" but is releaved":"and feels releaved",Cn.stats.Incontinence+=-.01,Cn.stats.MentalRegression-=.02*Cn.stats.MentalRegressionModifier,CharacterSetFacialExpression(Player,"Mouth","Happy",8)),dn("%NAME% sits down and uses the potty "+s+".",void 0,"usePotty")},Ir={activity:{ID:"potty",Name:"Sit and Use Potty",Image:"https://zoe-64.github.io/ABCL/versions/2.2.2/assets/activity/potty-temp.png",OnClick:(e,t)=>Lr(),TargetSelf:["ItemButt"],Criteria:e=>!(wn(e)&&Rn()||Player.IsRestrained())},command:{Tag:"use-potty",Action:(e,t,n)=>{if(!Ir.activity?.Criteria(Player))return Wt("You are restrained or diaper is locked.");Lr()},Description:" Sit down and use the potty."}},Nr=()=>{const e=.3*Cn.stats.Incontinence,t=Cn.stats.BladderFullness<.3&&Cn.stats.BowelFullness<.3,n=Cn.stats.BladderFullness>.6-e||Cn.stats.BowelFullness>.6-e;if(t)return Wt("You try to use the toilet but you can't seem to get anything out.");let r="";n&&(r="and feels releaved",Cn.stats.MentalRegression-=.02*Cn.stats.MentalRegressionModifier,Cn.stats.Incontinence+=-.01),Cn.stats.BladderFullness=0,Cn.stats.BowelFullness=0,dn("%NAME% goes to the bathroom and uses the toilet "+r+".",void 0,"useToilet")},Mr={activity:{ID:"toilet",Name:"Sit and Use Toilet",Image:"https://zoe-64.github.io/ABCL/versions/2.2.2/assets/activity/toilet-temp.png",OnClick:(e,t)=>Nr(),Criteria:e=>Cn.stats.MentalRegression<.3&&!(wn(e)&&Rn())&&!Player.IsRestrained(),TargetSelf:["ItemButt"]},command:{Tag:"use-toilet",Action:()=>Cn.stats.MentalRegression<.3?(CharacterSetFacialExpression(Player,"Eyes","Dizzy",8),Wt("You feel uncomfortable, the toilet is cold and hard almost like ice. You can't use it.")):wn()&&(Player.IsRestrained()||Rn())?Wt("You can't use the toilet while your diaper is locked."):void Nr(),Description:" Sit down and use the toilet."}},wr=e=>{if(e.MemberNumber!==Player.MemberNumber)return $r("wipe-puddle",void 0,e.MemberNumber);Br(Player)},Br=e=>{if(Cn.stats.PuddleSize=0,Tr(),_n(),e.MemberNumber!==Player.MemberNumber)return dn(cn("%OPP_NAME% wipes %NAME%'s puddle of pee.",e),void 0,"wipePuddle",e);dn(cn("%NAME% wipes %POSSESSIVE% puddle of pee.",e),void 0,"wipePuddle",e)},Dr={activity:{ID:"wipe-puddle",Name:"Wipe Puddle",Image:"./Assets/Female3DCG/ItemHandheld/Preview/Towel.png",Target:["ItemBoots"],OnClick:(e,t)=>wr(e),Criteria:e=>an(e)&&e.ABCL.Stats.PuddleSize.value>0&&!Player.IsRestrained()},command:{Tag:"wipe-puddle",Action:(e,t,n)=>{const r=sn(n[0])??Player;if(!Dr.activity.Criteria(r))return Wt("Is either not an ABCL player or has no puddle. Or you are restrained.");wr(r)},Description:" [MemberNumber|Name|Nickname]: Wipes a puddle of pee."},listeners:{"wipe-puddle":({Sender:e})=>{Br(sn(e)??Player)}}};class Rr{constructor(e,t,n,r,i,s,o){this.id=e,this.name=t,this.image=n,this.onClick=r,this.target=i,this.targetSelf=s,this.criteria=o}fitsCriteria(e,t){return Boolean((!this.criteria||this.criteria(e))&&(this.target?.includes(t)||this.targetSelf?.includes(t)&&Player.MemberNumber===e?.MemberNumber))}createButton(){const e=document.createElement("button");return e.id=this.id,e.name=`ABCL_${this.name}`,e.dataset.group="ItemArms",e.className="blank-button button button-styling HideOnPopup dialog-grid-button",e.innerHTML=`<img decoding="async" loading="lazy" src="${this.image}" class="button-image"><span class="button-label button-label-bottom">${this.name}</span>`,e.addEventListener("click",(e=>{const t=CurrentCharacter?.FocusGroup?CurrentCharacter:Player,n=t?.FocusGroup?.Name;this.onClick&&n&&(this.onClick(t,n),DialogLeave())})),e}static isInserted(e){return Boolean(document.getElementById(e))}}const Or=[Yn,Zn,Cr,Pr,Ir,Mr,Sr,vr,Dr,_r,Jn,er,nr,ir,or,lr,hr,ur,mr,gr,Ar],kr=Or.reduce(((e,{command:t})=>t?[...e,t]:e),[]);Or.reduce(((e,{activity:t})=>t?[...e,t]:e),[]);const $r=(e,t,n)=>{const r={Type:"Hidden",Content:`${En}Msg`,Sender:Player.MemberNumber,Target:n,Dictionary:[{type:e,data:t}]};ServerSend("ChatRoomChat",r),console.log("sendDataToAction",e,t,n)},Tr=t=>{console.log("sendUpdateMyData target",t),$r("sync",{settings:Player[En].Settings,stats:Player[En].Stats,version:yn},t),e.debug({message:`Sending updated data to ${t??"everyone"}`})},Fr=async()=>{await async function(e,t=(()=>!1)){for(;!e();){if(t())return!1;await new Promise((e=>setTimeout(e,10)))}return!0}((()=>ServerSocket&&ServerIsConnected)),Ut.hookFunction("DrawCharacter",1,((e,t)=>{const[n,r,i,s]=e;if(an(n)&&n.ABCL.Stats.PuddleSize.value>0){const e=n.ABCL.Stats.PuddleSize.value/300,t=512*e,o=235*e;DrawImageResize("https://zoe-64.github.io/ABCL/versions/2.2.2/assets/puddle.png",r+(250*s-t/2),i+(940*s-o/2),t,o)}return t(e)})),Ut.hookFunction("ChatRoomSync",1,((e,t)=>(Tr(),t(e)))),Ut.hookFunction("ChatRoomMessage",1,((t,n)=>"ServerEnter"===t[0].Content&&t[0].Sender===Player.MemberNumber?($r("init",1),void e.debug("Requesting data from others.")):((e=>{if("ABCLMsg"!==e?.Content)return;if(!e.Sender||!e.Dictionary)return;if(e.Sender===Player.MemberNumber)return;if("Hidden"!==e.Type)return;if(!e.Dictionary[0]?.type)return;const t=e.Dictionary[0]?.type,n=e.Dictionary[0]?.data;for(const r of Or){const i=r.listeners?.[t];i&&i(e,n)}console.log("receivePacket",t,n,e.Sender)})(t[0]),n(t)))),Ut.hookFunction("CharacterAppearanceSetItem",1,((e,t)=>{let[n,r,i]=e;const s=t(e);return"ItemPelvis"===r&&i&&Mn({Asset:i})&&kn(),s})),Ut.hookFunction("ActivityRun",1,((e,t)=>{const r=t(e),[i,s,o,a,...l]=e,c=a?.Activity;if(Player.ABCL.Settings.AccidentsByActivities&&s.MemberNumber===Player.MemberNumber&&c.Name in n){const e=n[c.Name];"Disabled"!==Player.ABCL.Settings.PeeMetabolism&&e.wetting&&Math.random()<e.wetting*(1+2*Cn.stats.Incontinence)&&Cn.attemptWetting(),"Disabled"!==Player.ABCL.Settings.PoopMetabolism&&e.messing&&Math.random()<e.messing*(1+2*Cn.stats.Incontinence)&&Cn.attemptSoiling()}return r})),Ut.hookFunction("PreferenceSubscreenChatClick",1,((t,n)=>{if(MouseIn(1815,75,90,90)){const t=Player.ChatSettings?.ColorTheme??"Light";t.startsWith("Light")&&nn&&!nn.classList.contains("sl-theme-light")&&(nn.classList.remove("sl-theme-dark"),nn.classList.add("sl-theme-light"),nn.style.color="black",e.info("SL theme switching: Light")),t.startsWith("Dark")&&nn&&!nn.classList.contains("sl-theme-dark")&&(nn.classList.remove("sl-theme-light"),nn.classList.add("sl-theme-dark"),nn.style.color="white",e.info("SL theme switching: Dark"))}return n(t)}))},xr=[],Gr=["Refusing to load mod"];window.addEventListener("error",(async e=>{if(console.error(e.filename),!e.filename.toLowerCase().includes("abcl")||Gr.some((t=>e.message.toLowerCase().includes(t.toLowerCase()))))return;const t=`${e.message} at ${e.filename} ${e.lineno}`;if(xr.includes(t))return;xr.push(t);const n={username:`${Player.Name} ${""===Player.Nickname?"":`aka ${Player.Nickname}`} (${Player.MemberNumber})`,thread_name:`${En} ${yn} Error ${e.message}`.slice(0,100),content:`\n    error: ${t}\n\`\`\`\n${e.error.stack}\n\`\`\`\nmods: ${Ot.getModsInfo().map((e=>e.name)).join(", ")}`};await fetch("https://discord.com/api/webhooks/1340000414506029162/aqt7qruFnzDMM5BN_kLtv9gCcallIF-JeRVYl9k23uSIlxrHRvcFMy5mtPUPGDpWZhHX",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})}));var jr,Vr,zr,Ur,Hr,Wr,Xr,Yr,qr,Zr,Kr,Jr={},Qr=[],ei=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,ti=Array.isArray;function ni(e,t){for(var n in t)e[n]=t[n];return e}function ri(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function ii(e,t,n,r,i){var s={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:null==i?++zr:i,__i:-1,__u:0};return null==i&&null!=Vr.vnode&&Vr.vnode(s),s}function si(e){return e.children}function oi(e,t){this.props=e,this.context=t}function ai(e,t){if(null==t)return e.__?ai(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?ai(e):null}function li(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return li(e)}}function ci(e){(!e.__d&&(e.__d=!0)&&Ur.push(e)&&!ui.__r++||Hr!==Vr.debounceRendering)&&((Hr=Vr.debounceRendering)||Wr)(ui)}function ui(){for(var e,t,n,r,i,s,o,a=1;Ur.length;)Ur.length>a&&Ur.sort(Xr),e=Ur.shift(),a=Ur.length,e.__d&&(n=void 0,i=(r=(t=e).__v).__e,s=[],o=[],t.__P&&((n=ni({},r)).__v=r.__v+1,Vr.vnode&&Vr.vnode(n),yi(t.__P,n,r,t.__n,t.__P.namespaceURI,32&r.__u?[i]:null,s,null==i?ai(r):i,!!(32&r.__u),o),n.__v=r.__v,n.__.__k[n.__i]=n,Ei(s,n,o),n.__e!=i&&li(n)));ui.__r=0}function di(e,t,n,r,i,s,o,a,l,c,u){var d,h,p,m,f,g,y=r&&r.__k||Qr,E=t.length;for(l=function(e,t,n,r,i){var s,o,a,l,c,u=n.length,d=u,h=0;for(e.__k=new Array(i),s=0;s<i;s++)null!=(o=t[s])&&"boolean"!=typeof o&&"function"!=typeof o?(l=s+h,(o=e.__k[s]="string"==typeof o||"number"==typeof o||"bigint"==typeof o||o.constructor==String?ii(null,o,null,null,null):ti(o)?ii(si,{children:o},null,null,null):void 0===o.constructor&&o.__b>0?ii(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=e,o.__b=e.__b+1,a=null,-1!==(c=o.__i=pi(o,n,l,d))&&(d--,(a=n[c])&&(a.__u|=2)),null==a||null===a.__v?(-1==c&&(i>u?h--:i<u&&h++),"function"!=typeof o.type&&(o.__u|=4)):c!=l&&(c==l-1?h--:c==l+1?h++:(c>l?h--:h++,o.__u|=4))):e.__k[s]=null;if(d)for(s=0;s<u;s++)null!=(a=n[s])&&!(2&a.__u)&&(a.__e==r&&(r=ai(a)),bi(a,a));return r}(n,t,y,l,E),d=0;d<E;d++)null!=(p=n.__k[d])&&(h=-1===p.__i?Jr:y[p.__i]||Jr,p.__i=d,g=yi(e,p,h,i,s,o,a,l,c,u),m=p.__e,p.ref&&h.ref!=p.ref&&(h.ref&&_i(h.ref,null,p),u.push(p.ref,p.__c||m,p)),null==f&&null!=m&&(f=m),4&p.__u||h.__k===p.__k?l=hi(p,l,e):"function"==typeof p.type&&void 0!==g?l=g:m&&(l=m.nextSibling),p.__u&=-7);return n.__e=f,l}function hi(e,t,n){var r,i;if("function"==typeof e.type){for(r=e.__k,i=0;r&&i<r.length;i++)r[i]&&(r[i].__=e,t=hi(r[i],t,n));return t}e.__e!=t&&(t&&e.type&&!n.contains(t)&&(t=ai(e)),n.insertBefore(e.__e,t||null),t=e.__e);do{t=t&&t.nextSibling}while(null!=t&&8==t.nodeType);return t}function pi(e,t,n,r){var i,s,o=e.key,a=e.type,l=t[n];if(null===l&&null==e.key||l&&o==l.key&&a===l.type&&!(2&l.__u))return n;if(r>(null==l||2&l.__u?0:1))for(i=n-1,s=n+1;i>=0||s<t.length;){if(i>=0){if((l=t[i])&&!(2&l.__u)&&o==l.key&&a===l.type)return i;i--}if(s<t.length){if((l=t[s])&&!(2&l.__u)&&o==l.key&&a===l.type)return s;s++}}return-1}function mi(e,t,n){"-"==t[0]?e.setProperty(t,null==n?"":n):e[t]=null==n?"":"number"!=typeof n||ei.test(t)?n:n+"px"}function fi(e,t,n,r,i){var s;e:if("style"==t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof r&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||mi(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||mi(e.style,t,n[t])}else if("o"==t[0]&&"n"==t[1])s=t!=(t=t.replace(Yr,"$1")),t=t.toLowerCase()in e||"onFocusOut"==t||"onFocusIn"==t?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+s]=n,n?r?n.t=r.t:(n.t=qr,e.addEventListener(t,s?Kr:Zr,s)):e.removeEventListener(t,s?Kr:Zr,s);else{if("http://www.w3.org/2000/svg"==i)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!=t&&"height"!=t&&"href"!=t&&"list"!=t&&"form"!=t&&"tabIndex"!=t&&"download"!=t&&"rowSpan"!=t&&"colSpan"!=t&&"role"!=t&&"popover"!=t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null==n||!1===n&&"-"!=t[4]?e.removeAttribute(t):e.setAttribute(t,"popover"==t&&1==n?"":n))}}function gi(e){return function(t){if(this.l){var n=this.l[t.type+e];if(null==t.u)t.u=qr++;else if(t.u<n.t)return;return n(Vr.event?Vr.event(t):t)}}}function yi(e,t,n,r,i,s,o,a,l,c){var u,d,h,p,m,f,g,y,E,v,_,b,A,S,C,P,L,I=t.type;if(void 0!==t.constructor)return null;128&n.__u&&(l=!!(32&n.__u),s=[a=t.__e=n.__e]),(u=Vr.__b)&&u(t);e:if("function"==typeof I)try{if(y=t.props,E="prototype"in I&&I.prototype.render,v=(u=I.contextType)&&r[u.__c],_=u?v?v.props.value:u.__:r,n.__c?g=(d=t.__c=n.__c).__=d.__E:(E?t.__c=d=new I(y,_):(t.__c=d=new oi(y,_),d.constructor=I,d.render=Ai),v&&v.sub(d),d.props=y,d.state||(d.state={}),d.context=_,d.__n=r,h=d.__d=!0,d.__h=[],d._sb=[]),E&&null==d.__s&&(d.__s=d.state),E&&null!=I.getDerivedStateFromProps&&(d.__s==d.state&&(d.__s=ni({},d.__s)),ni(d.__s,I.getDerivedStateFromProps(y,d.__s))),p=d.props,m=d.state,d.__v=t,h)E&&null==I.getDerivedStateFromProps&&null!=d.componentWillMount&&d.componentWillMount(),E&&null!=d.componentDidMount&&d.__h.push(d.componentDidMount);else{if(E&&null==I.getDerivedStateFromProps&&y!==p&&null!=d.componentWillReceiveProps&&d.componentWillReceiveProps(y,_),!d.__e&&(null!=d.shouldComponentUpdate&&!1===d.shouldComponentUpdate(y,d.__s,_)||t.__v==n.__v)){for(t.__v!=n.__v&&(d.props=y,d.state=d.__s,d.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some((function(e){e&&(e.__=t)})),b=0;b<d._sb.length;b++)d.__h.push(d._sb[b]);d._sb=[],d.__h.length&&o.push(d);break e}null!=d.componentWillUpdate&&d.componentWillUpdate(y,d.__s,_),E&&null!=d.componentDidUpdate&&d.__h.push((function(){d.componentDidUpdate(p,m,f)}))}if(d.context=_,d.props=y,d.__P=e,d.__e=!1,A=Vr.__r,S=0,E){for(d.state=d.__s,d.__d=!1,A&&A(t),u=d.render(d.props,d.state,d.context),C=0;C<d._sb.length;C++)d.__h.push(d._sb[C]);d._sb=[]}else do{d.__d=!1,A&&A(t),u=d.render(d.props,d.state,d.context),d.state=d.__s}while(d.__d&&++S<25);d.state=d.__s,null!=d.getChildContext&&(r=ni(ni({},r),d.getChildContext())),E&&!h&&null!=d.getSnapshotBeforeUpdate&&(f=d.getSnapshotBeforeUpdate(p,m)),P=u,null!=u&&u.type===si&&null==u.key&&(P=vi(u.props.children)),a=di(e,ti(P)?P:[P],t,n,r,i,s,o,a,l,c),d.base=t.__e,t.__u&=-161,d.__h.length&&o.push(d),g&&(d.__E=d.__=null)}catch(e){if(t.__v=null,l||null!=s)if(e.then){for(t.__u|=l?160:128;a&&8==a.nodeType&&a.nextSibling;)a=a.nextSibling;s[s.indexOf(a)]=null,t.__e=a}else for(L=s.length;L--;)ri(s[L]);else t.__e=n.__e,t.__k=n.__k;Vr.__e(e,t,n)}else null==s&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):a=t.__e=function(e,t,n,r,i,s,o,a,l){var c,u,d,h,p,m,f,g=n.props,y=t.props,E=t.type;if("svg"==E?i="http://www.w3.org/2000/svg":"math"==E?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),null!=s)for(c=0;c<s.length;c++)if((p=s[c])&&"setAttribute"in p==!!E&&(E?p.localName==E:3==p.nodeType)){e=p,s[c]=null;break}if(null==e){if(null==E)return document.createTextNode(y);e=document.createElementNS(i,E,y.is&&y),a&&(Vr.__m&&Vr.__m(t,s),a=!1),s=null}if(null===E)g===y||a&&e.data===y||(e.data=y);else{if(s=s&&jr.call(e.childNodes),g=n.props||Jr,!a&&null!=s)for(g={},c=0;c<e.attributes.length;c++)g[(p=e.attributes[c]).name]=p.value;for(c in g)if(p=g[c],"children"==c);else if("dangerouslySetInnerHTML"==c)d=p;else if(!(c in y)){if("value"==c&&"defaultValue"in y||"checked"==c&&"defaultChecked"in y)continue;fi(e,c,null,p,i)}for(c in y)p=y[c],"children"==c?h=p:"dangerouslySetInnerHTML"==c?u=p:"value"==c?m=p:"checked"==c?f=p:a&&"function"!=typeof p||g[c]===p||fi(e,c,p,g[c],i);if(u)a||d&&(u.__html===d.__html||u.__html===e.innerHTML)||(e.innerHTML=u.__html),t.__k=[];else if(d&&(e.innerHTML=""),di("template"===t.type?e.content:e,ti(h)?h:[h],t,n,r,"foreignObject"==E?"http://www.w3.org/1999/xhtml":i,s,o,s?s[0]:n.__k&&ai(n,0),a,l),null!=s)for(c=s.length;c--;)ri(s[c]);a||(c="value","progress"==E&&null==m?e.removeAttribute("value"):void 0!==m&&(m!==e[c]||"progress"==E&&!m||"option"==E&&m!==g[c])&&fi(e,c,m,g[c],i),c="checked",void 0!==f&&f!==e[c]&&fi(e,c,f,g[c],i))}return e}(n.__e,t,n,r,i,s,o,l,c);return(u=Vr.diffed)&&u(t),128&t.__u?void 0:a}function Ei(e,t,n){for(var r=0;r<n.length;r++)_i(n[r],n[++r],n[++r]);Vr.__c&&Vr.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){Vr.__e(e,t.__v)}}))}function vi(e){return"object"!=typeof e||null==e?e:ti(e)?e.map(vi):ni({},e)}function _i(e,t,n){try{if("function"==typeof e){var r="function"==typeof e.__u;r&&e.__u(),r&&null==t||(e.__u=e(t))}else e.current=t}catch(e){Vr.__e(e,n)}}function bi(e,t,n){var r,i;if(Vr.unmount&&Vr.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||_i(r,null,t)),null!=(r=e.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(e){Vr.__e(e,t)}r.base=r.__P=null}if(r=e.__k)for(i=0;i<r.length;i++)r[i]&&bi(r[i],t,n||"function"!=typeof e.type);n||ri(e.__e),e.__c=e.__=e.__e=void 0}function Ai(e,t,n){return this.constructor(e,n)}function Si(e,t,n){var r,i,s,o;t==document&&(t=document.documentElement),Vr.__&&Vr.__(e,t),i=(r="function"==typeof n)?null:n&&n.__k||t.__k,s=[],o=[],yi(t,e=(!r&&n||t).__k=function(e,t,n){var r,i,s,o={};for(s in t)"key"==s?r=t[s]:"ref"==s?i=t[s]:o[s]=t[s];if(arguments.length>2&&(o.children=arguments.length>3?jr.call(arguments,2):n),"function"==typeof e&&null!=e.defaultProps)for(s in e.defaultProps)void 0===o[s]&&(o[s]=e.defaultProps[s]);return ii(e,o,r,i,null)}(si,null,[e]),i||Jr,Jr,t.namespaceURI,!r&&n?[n]:i?null:t.firstChild?jr.call(t.childNodes):null,s,!r&&n?n:i?i.__e:t.firstChild,r,o),Ei(s,e,o)}jr=Qr.slice,Vr={__e:function(e,t,n,r){for(var i,s,o;t=t.__;)if((i=t.__c)&&!i.__)try{if((s=i.constructor)&&null!=s.getDerivedStateFromError&&(i.setState(s.getDerivedStateFromError(e)),o=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(e,r||{}),o=i.__d),o)return i.__E=i}catch(t){e=t}throw e}},zr=0,oi.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=ni({},this.state),"function"==typeof e&&(e=e(ni({},n),this.props)),e&&ni(n,e),null!=e&&this.__v&&(t&&this._sb.push(t),ci(this))},oi.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),ci(this))},oi.prototype.render=si,Ur=[],Wr="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Xr=function(e,t){return e.__v.__b-t.__v.__b},ui.__r=0,Yr=/(PointerCapture)$|Capture$/i,qr=0,Zr=gi(!1),Kr=gi(!0);var Ci=0;function Pi(e,t,n,r,i,s){t||(t={});var o,a,l=t;if("ref"in l)for(a in l={},t)"ref"==a?o=t[a]:l[a]=t[a];var c={type:e,props:l,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Ci,__i:-1,__u:0,__source:i,__self:s};if("function"==typeof e&&(o=e.defaultProps))for(a in o)void 0===l[a]&&(l[a]=o[a]);return Vr.vnode&&Vr.vnode(c),c}function Li(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===n&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}Li(".ABCL-settings-page{height:79%;margin:5% 10dvw 0dvh 5dvw;overflow-y:auto}.ABCL-settings-title{margin-top:0;text-align:center;width:fit-content}.ABCL-divider{margin:1% 0}.ABCL-checkbox-group{display:flex;flex-wrap:wrap;font-size:.8em;gap:1.5vw}.ABCL-settings-section{margin-bottom:.7%;margin-top:2.1%}.ABCL-page-list{display:flex;flex-direction:column;gap:.5em;margin:1%;>*{border:1px solid #000;flex:1 1 auto;padding:10px;text-align:left}}.ABCL-contact-info{display:flex;flex-direction:column;gap:.5em;padding:1%;width:fit-content}.ABCL-settings-menu{display:flex;flex-direction:row;justify-content:space-between;width:56%;>section{display:flex;flex-direction:column;gap:.2em;padding:1%;>div>*{width:100%}}}.ABCL-button{background-color:#fff;border:1px solid #000;cursor:pointer;padding:.3em;white-space:nowrap;width:fit-content;&:hover{background-color:cyan}}");var Ii,Ni,Mi,wi,Bi=0,Di=[],Ri=Vr,Oi=Ri.__b,ki=Ri.__r,$i=Ri.diffed,Ti=Ri.__c,Fi=Ri.unmount,xi=Ri.__;function Gi(e,t){Ri.__h&&Ri.__h(Ni,e,Bi||t),Bi=0;var n=Ni.__H||(Ni.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function ji(e){return Bi=1,function(e,t,n){var r=Gi(Ii++,2);if(r.t=e,!r.__c&&(r.__=[n?n(t):Yi(void 0,t),function(e){var t=r.__N?r.__N[0]:r.__[0],n=r.t(t,e);t!==n&&(r.__N=[n,r.__[1]],r.__c.setState({}))}],r.__c=Ni,!Ni.__f)){var i=function(e,t,n){if(!r.__c.__H)return!0;var i=r.__c.__H.__.filter((function(e){return!!e.__c}));if(i.every((function(e){return!e.__N})))return!s||s.call(this,e,t,n);var o=r.__c.props!==e;return i.forEach((function(e){if(e.__N){var t=e.__[0];e.__=e.__N,e.__N=void 0,t!==e.__[0]&&(o=!0)}})),s&&s.call(this,e,t,n)||o};Ni.__f=!0;var s=Ni.shouldComponentUpdate,o=Ni.componentWillUpdate;Ni.componentWillUpdate=function(e,t,n){if(this.__e){var r=s;s=void 0,i(e,t,n),s=r}o&&o.call(this,e,t,n)},Ni.shouldComponentUpdate=i}return r.__N||r.__}(Yi,e)}function Vi(e,t){var n=Gi(Ii++,3);!Ri.__s&&function(e,t){return!e||e.length!==t.length||t.some((function(t,n){return t!==e[n]}))}(n.__H,t)&&(n.__=e,n.u=t,Ni.__H.__h.push(n))}function zi(){for(var e;e=Di.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Wi),e.__H.__h.forEach(Xi),e.__H.__h=[]}catch(t){e.__H.__h=[],Ri.__e(t,e.__v)}}Ri.__b=function(e){Ni=null,Oi&&Oi(e)},Ri.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),xi&&xi(e,t)},Ri.__r=function(e){ki&&ki(e),Ii=0;var t=(Ni=e.__c).__H;t&&(Mi===Ni?(t.__h=[],Ni.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.u=e.__N=void 0}))):(t.__h.forEach(Wi),t.__h.forEach(Xi),t.__h=[],Ii=0)),Mi=Ni},Ri.diffed=function(e){$i&&$i(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==Di.push(t)&&wi===Ri.requestAnimationFrame||((wi=Ri.requestAnimationFrame)||Hi)(zi)),t.__H.__.forEach((function(e){e.u&&(e.__H=e.u),e.u=void 0}))),Mi=Ni=null},Ri.__c=function(e,t){t.some((function(e){try{e.__h.forEach(Wi),e.__h=e.__h.filter((function(e){return!e.__||Xi(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Ri.__e(n,e.__v)}})),Ti&&Ti(e,t)},Ri.unmount=function(e){Fi&&Fi(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{Wi(e)}catch(e){t=e}})),n.__H=void 0,t&&Ri.__e(t,n.__v))};var Ui="function"==typeof requestAnimationFrame;function Hi(e){var t,n=function(){clearTimeout(r),Ui&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);Ui&&(t=requestAnimationFrame(n))}function Wi(e){var t=Ni,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),Ni=t}function Xi(e){var t=Ni;e.__c=e.__(),Ni=t}function Yi(e,t){return"function"==typeof t?t(e):t}function qi({options:e,value:t,setValue:n,label:r}){return Pi("div",{className:"ABCL-group",children:[Pi("p",{children:r}),e.map(((e,r)=>Pi("button",{className:`ABCL-group-button ${t===e&&"ABCL-group-button-selected"}`,onClick:()=>n(e),children:e},r)))]})}Li(".ABCL-group-button{background-color:var(--tmd-element,#919191);border:1px solid var(--tmd-element,#262626);color:var(--tmd-text,#fff);cursor:pointer;padding:5px}.ABCL-group-button-selected{background-color:var(--tmd-accent,#000)}.ABCL-group{align-items:center;display:flex;padding:5px 0;width:fit-content}.ABCL-group p{margin-right:10px}");function Zi({checked:e,setChecked:t,label:n}){return Pi("div",{className:"ABCL-checkbox",children:[Pi("input",{type:"checkbox",checked:e,onChange:e=>t(e.target.checked)}),Pi("p",{style:{marginLeft:"5px"},children:n})]})}function Ki({setPage:e}){const[t,n]=ji(Player.ABCL.Settings.PeeMetabolism),[r,i]=ji(Player.ABCL.Settings.PoopMetabolism),[s,o]=ji(Player.ABCL.Settings.MentalRegressionModifier),[a,l]=ji(Player.ABCL.Settings.OnDiaperChange);return Pi("div",{className:"ABCL-settings-section",children:[Pi("h2",{children:"Wet and Soiling"}),Pi("button",{onClick:()=>e("menu"),className:"ABCL-exit-button"}),Pi("div",{children:Pi("div",{className:"ABCL-checkbox-group",children:[Pi(Zi,{checked:Player.ABCL.Settings.PauseStats,setChecked:e=>Player.ABCL.Settings.PauseStats=e,label:"Pause Stats"}),Pi(Zi,{checked:Player.ABCL.Settings.DisableWettingLeaks,setChecked:e=>Player.ABCL.Settings.DisableWettingLeaks=e,label:"Disable Wetting Leaks / Puddles"}),Pi(Zi,{checked:Player.ABCL.Settings.DisableSoilingLeaks,setChecked:e=>Player.ABCL.Settings.DisableSoilingLeaks=e,label:"Disable Messy Leaks"}),Pi(Zi,{checked:Player.ABCL.Settings.DisableClothingStains,setChecked:e=>Player.ABCL.Settings.DisableClothingStains=e,label:"Disable Clothing Stains"}),Pi(Zi,{checked:Player.ABCL.Settings.DisableDiaperStains,setChecked:e=>Player.ABCL.Settings.DisableDiaperStains=e,label:"Disable Diaper Stains"}),Pi(Zi,{checked:Player.ABCL.Settings.AccidentsByActivities,setChecked:e=>Player.ABCL.Settings.AccidentsByActivities=e,label:"Accidents by Activities (Experimental)"})]})}),Pi(qi,{options:["Disabled","Slow","Normal","Fast","Faster","Fastest"],value:t,setValue:e=>{n(e),Player.ABCL.Settings.PeeMetabolism=e},label:"Pee Metabolism"}),Pi(qi,{options:["Disabled","Slow","Normal","Fast","Faster","Fastest"],value:r,setValue:e=>{i(e),Player.ABCL.Settings.PoopMetabolism=e},label:"Poop Metabolism"}),Pi(qi,{options:["Disabled","Slow","Normal","Fast","Faster","Fastest"],value:s,setValue:e=>{o(e),Player.ABCL.Settings.MentalRegressionModifier=e},label:"Regression Speed"}),Pi(qi,{options:["Deny","Ask","Allow"],value:a,setValue:e=>{l(e),Player.ABCL.Settings.OnDiaperChange=e},label:"On Diaper Prompt"})]})}function Ji({setPage:e}){return Pi("div",{children:[Pi("button",{onClick:()=>e("menu"),className:"ABCL-exit-button"}),Pi("div",{children:[Pi("h2",{children:"Visible Messages to Players"}),Pi("div",{className:"ABCL-checkbox-group",children:[Pi(Zi,{checked:Player.ABCL.Settings.VisibleMessages.wetDiaper,setChecked:e=>Player.ABCL.Settings.VisibleMessages.wetDiaper=e,label:"Wetting Diapers"}),Pi(Zi,{checked:Player.ABCL.Settings.VisibleMessages.wetClothing,setChecked:e=>Player.ABCL.Settings.VisibleMessages.wetClothing=e,label:"Wetting Clothes"}),Pi(Zi,{checked:Player.ABCL.Settings.VisibleMessages.soilDiaper,setChecked:e=>Player.ABCL.Settings.VisibleMessages.soilDiaper=e,label:"Soiling Diapers"}),Pi(Zi,{checked:Player.ABCL.Settings.VisibleMessages.soilClothing,setChecked:e=>Player.ABCL.Settings.VisibleMessages.soilClothing=e,label:"Soiling Clothes"}),Pi(Zi,{checked:Player.ABCL.Settings.VisibleMessages.changeDiaper,setChecked:e=>Player.ABCL.Settings.VisibleMessages.changeDiaper=e,label:"Changing Diapers"}),Pi(Zi,{checked:Player.ABCL.Settings.VisibleMessages.checkDiaper,setChecked:e=>Player.ABCL.Settings.VisibleMessages.checkDiaper=e,label:"Checking Diapers"}),Pi(Zi,{checked:Player.ABCL.Settings.VisibleMessages.lickPuddle,setChecked:e=>Player.ABCL.Settings.VisibleMessages.lickPuddle=e,label:"Licking Puddles"}),Pi(Zi,{checked:Player.ABCL.Settings.VisibleMessages.wipePuddle,setChecked:e=>Player.ABCL.Settings.VisibleMessages.wipePuddle=e,label:"Wiping Puddle"}),Pi(Zi,{checked:Player.ABCL.Settings.VisibleMessages.usePotty,setChecked:e=>Player.ABCL.Settings.VisibleMessages.usePotty=e,label:"Using Potty"}),Pi(Zi,{checked:Player.ABCL.Settings.VisibleMessages.useToilet,setChecked:e=>Player.ABCL.Settings.VisibleMessages.useToilet=e,label:"Using Toilet"}),Pi(Zi,{checked:Player.ABCL.Settings.VisibleMessages.statusMessages,setChecked:e=>Player.ABCL.Settings.VisibleMessages.statusMessages=e,label:"Show Status Messages"})]})]}),Pi("div",{children:[Pi("h2",{children:"Visible Status Messages to Yourself"}),Pi("div",{className:"ABCL-checkbox-group",children:[Pi(Zi,{checked:Player.ABCL.Settings.StatusMessages.Wetness??!1,setChecked:e=>Player.ABCL.Settings.StatusMessages.Wetness=e,label:"Show wetness status message"}),Pi(Zi,{checked:Player.ABCL.Settings.StatusMessages.Soiliness??!1,setChecked:e=>Player.ABCL.Settings.StatusMessages.Soiliness=e,label:"Show soiliness status message"}),Pi(Zi,{checked:Player.ABCL.Settings.StatusMessages.Bladder??!1,setChecked:e=>Player.ABCL.Settings.StatusMessages.Bladder=e,label:"Show bladder status message"}),Pi(Zi,{checked:Player.ABCL.Settings.StatusMessages.Bowel??!1,setChecked:e=>Player.ABCL.Settings.StatusMessages.Bowel=e,label:"Show bowel status message"}),Pi(Zi,{checked:Player.ABCL.Settings.StatusMessages.Incontinence??!1,setChecked:e=>Player.ABCL.Settings.StatusMessages.Incontinence=e,label:"Show incontinence status message"}),Pi(Zi,{checked:Player.ABCL.Settings.StatusMessages.MentalRegression??!1,setChecked:e=>Player.ABCL.Settings.StatusMessages.MentalRegression=e,label:"Show mental regression status message"}),Pi(Zi,{checked:Player.ABCL.Settings.StatusMessages.PuddleSize??!1,setChecked:e=>Player.ABCL.Settings.StatusMessages.PuddleSize=e,label:"Show puddle size status message"})]})]})]})}Li(".ABCL-checkbox{align-items:center;display:flex;padding:.7%;white-space:nowrap;width:fit-content}.ABCL-checkbox input{aspect-ratio:1/1;height:100%;width:auto}.ABCL-checkbox p{margin:.35%}");function Qi({setPage:e}){return Pi("div",{children:[Pi("button",{onClick:()=>e("menu"),className:"ABCL-exit-button"}),Pi("div",{children:[Pi("h1",{children:["ABCL ","2.2.2"]}),Pi("p",{children:["An addon for"," ",Pi("a",{target:"_blank",href:"https://www.bondageprojects.com/club_game/",children:"Bondage Club"})," ","that adds ABDL features to the game."]}),Pi("p",{children:["Made by"," ",Pi("a",{target:"_blank",href:"https://github.com/zoe-64",children:"Zoe"})," ","and"," ",Pi("a",{target:"_blank",href:"https://github.com/kjbro",children:"En (mama)"}),"."]}),Pi("p",{children:["Thanks to",Pi("div",{className:"ABCL-thanks-list",children:[Pi("p",{children:[Pi("a",{target:"_blank",children:Pi("span",{children:"Firefly"})})," ","- ",Pi("span",{"data-reason":!0,children:"for the original idea"})]}),Pi("p",{children:[Pi("a",{target:"_blank",href:"https://github.com/mochamaple",children:[Pi("span",{"data-name":!0}),"Maple"]})," ","- ",Pi("span",{"data-reason":!0,children:"for the mod plugin template"})]}),Pi("p",{children:[Pi("a",{target:"_blank",href:"https://github.com/FurryZoi",children:[Pi("span",{"data-name":!0}),"Zoi"]})," ","- ",Pi("span",{"data-reason":!0,children:"for helping get themed to work"})]}),Pi("p",{children:[Pi("a",{target:"_blank",href:"https://github.com/minimar",children:[Pi("span",{"data-name":!0}),"minimar"]})," ","- ",Pi("span",{"data-reason":!0,children:"for helping with typos"})]}),Pi("p",{children:[Pi("a",{target:"_blank",href:"https://github.com/dDeepLb",children:[Pi("span",{"data-name":!0}),"Deep (papa)"]})," ","- ",Pi("span",{"data-reason":!0,children:"for helping with code review and testing"})]}),Pi("p",{children:[Pi("a",{target:"_blank",href:"https://github.com/dynilath",children:[Pi("span",{"data-name":!0}),"Da'Inihlus"]})," ","- ",Pi("span",{"data-reason":!0,children:"for mod items architecture"})]}),Pi("p",{children:[Pi("a",{target:"_blank",href:"https://github.com/tetris245",children:[Pi("span",{"data-name":!0}),"Nemesea"]})," ","- ",Pi("span",{"data-reason":!0,children:"for getting me started with modding in bc"})]}),Pi("p",{children:[Pi("a",{target:"_blank",href:"https://github.com/littlesera",children:[Pi("span",{"data-name":!0}),"Sera"]})," ","- ",Pi("span",{"data-reason":!0,children:"for helping during the development process"})]})]})]}),Pi("p",{children:["Source code available on"," ",Pi("a",{target:"_blank",href:"https://github.com/zoe-64/ABCL",children:"GitHub"}),"."]})]})]})}function es(){const[e,t]=ji("menu");return Vi((()=>{rn()}),[e]),Pi("div",{id:"ABCL-settings-page",className:"ABCL-hidden ABCL-settings-page",children:[Pi("button",{onClick:()=>PreferenceSubscreenExtensionsExit(),className:"ABCL-exit-button"}),Pi("div",{children:Pi("h1",{className:"ABCL-settings-title",children:" ABCL Settings "})}),{menu:Pi("div",{className:"ABCL-settings-menu",children:[Pi("section",{children:[Pi("h2",{children:"Menu"}),Pi("div",{className:"ABCL-page-list ABCL-settings-section",children:[Pi("button",{onClick:()=>t("messages"),className:"ABCL-button",children:"Messages"}),Pi("button",{onClick:()=>t("stats"),className:"ABCL-button",children:"Stats"}),Pi("button",{onClick:()=>t("about"),className:"ABCL-button",children:["About ABCL ","2.2.2"]})]})]}),Pi("section",{children:[Pi("h2",{children:"Support"}),Pi("div",{className:"ABCL-contact-info ABCL-settings-section",id:"ABCL-contact-info",children:[Pi("button",{onClick:()=>window.open("https://discord.gg/ENYGwmgDmQ","_blank"),className:"ABCL-button",children:"Join our Discord"}),Pi("button",{onClick:()=>window.open("https://docs.google.com/forms/d/e/1FAIpQLSdOMGAEmOlFTpbcdkdn8b380p50WAE8qPux-45WvFM3qhf9_w/viewform","_blank"),className:"ABCL-button",children:"Give Feedback"})]})]})]}),messages:Pi(Ji,{setPage:t}),stats:Pi(Ki,{setPage:t}),about:Pi(Qi,{setPage:t})}[e]]})}Li(".ABCL-thanks-list{display:flex;flex-direction:column}");function ts({value:e,label:t,color:n="#FFFFFF",foreground:r="#000000",format:i=(e=>(100*e).toFixed(0))}){return Pi("div",{class:"value-bar no-resize",children:[Pi("div",{style:{background:r,width:"100%",height:"10px"},children:Pi("div",{style:{background:n,width:100*e+"%",height:"100%"}})}),Pi("p",{class:"value-bar-label",children:t}),Pi("p",{class:"value-bar-value",children:[i(e),"%"]})]})}Li("");function ns(){const[e,t]=ji((()=>ChatRoomCharacter.filter((e=>an(e))))),[n,r]=ji(0);Vi((()=>(Qt.setState=()=>{},Qt.setMemberNumber=r,()=>{Qt.setState=()=>{},Qt.setMemberNumber=()=>{}})),[]);const i=sn(n),s=i&&an(i),o=s?i.ABCL.Stats.MentalRegression.value:0,a=s?i.ABCL.Stats.Incontinence.value:0,l=s?i.ABCL.Stats.Soiliness.value/$n(i):0,c=s?i.ABCL.Stats.Wetness.value/$n(i):0,u=s?i.ABCL.Stats.Bowel.value/i.ABCL.Stats.Bowel.size:0,d=s?i.ABCL.Stats.Bladder.value/i.ABCL.Stats.Bladder.size:0,h=!!s&&i.ABCL.Settings.PauseStats;return Vi((()=>{rn()}),[n]),Pi("div",{className:"ABCL-hidden",id:"ABCL-stats",children:[Pi("div",{className:"ABCL-stats-overlay",onClick:()=>document.getElementById("ABCL-stats")?.classList.add("ABCL-hidden")}),Pi("div",{className:"ABCL-stats-panel",id:"ABCL-stats-panel",children:[Pi("select",{class:"ABCL-stats-select",onClick:()=>{t(ChatRoomCharacter.filter((e=>an(e))))},value:n,onChange:e=>{r(parseInt(e.target.value))},children:e.map((e=>Pi("option",{value:e.MemberNumber,children:ln(e.MemberNumber)},e.MemberNumber)))}),Pi("div",{className:"ABCL-stats-container",children:[Pi(ts,{value:a,label:"Incontinence",color:"#cb5b5bff",foreground:"#eeacacff"}),Pi(ts,{value:o,label:"Mental Regression",color:"#ad74beff",foreground:"#e6bff1ff"}),Pi(ts,{value:l,label:"Soiliness",color:"#ab674aff",foreground:"#d1aa98ff"}),Pi(ts,{value:c,label:"Wetness",color:"#e7c463ff",foreground:"#f3e1aeff"}),Pi(ts,{value:u,label:"Bowel Fullness",color:"#7c4c36ff",foreground:"#b7795cff"}),Pi(ts,{value:d,label:"Bladder Fullness",color:"#cba01eff",foreground:"#eacd73ff"}),Pi("p",{children:[Pi("span",{children:"Stats: "}),Pi("span",{children:h?"Paused":"Active"})]}),Pi("button",{onClick:()=>rn(),children:"Refresh"})]})]})]})}Li(".ABCL-stats-overlay{height:100%;left:0;position:absolute;top:0;width:100%}.ABCL-stats-panel{background-color:var(--tmd-element,#fff)}.ABCL-stats-select{background-color:#f9f9f9;border:1px solid #ccc;border-radius:.35%;color:#333;margin:8%;padding:.7%;width:84%}.ABCL-stats-container{display:flex;flex-direction:column;font-size:.5em;gap:1em;padding:8%}");function rs(){return Pi(si,{children:[Pi(ns,{}),Pi(es,{})]})}Li(".ABCL-hidden{display:none!important}.ABCL-overlay{pointer-events:none;z-index:1}.ABCL-overlay *{pointer-events:fill}.ABCL-exit-button{background-color:#fff;background-image:url(Icons/Exit.png);background-position:50%;background-repeat:no-repeat;background-size:contain;border:1px solid #000;cursor:pointer;:hover{background-color:cyan}}#fusam-addon-manager-container{position:absolute;top:0}");const is=async()=>{Si(Pi(rs,{}),nn),PreferenceRegisterExtensionSetting({Identifier:"ABCL",ButtonText:"ABCL Settings",Image:"https://zoe-64.github.io/ABCL/versions/2.2.2/assets/abcl.png",run:()=>{},click:()=>{},exit:()=>(Jt(document.body,"#ABCL-settings-page").classList.add("ABCL-hidden"),Bt(),!0),load:()=>{Jt(document.body,"#ABCL-settings-page").classList.remove("ABCL-hidden"),rn()}})};const ss=new Set(["ItemTorso","ItemTorso2"]),os={ItemTorso:ss,ItemTorso2:ss},as={},ls={};function cs(e){return(os[e]&&Array.from(os[e])||[e]).map((e=>us(e)))}function us(e){return{name:e,group:AssetGroupGet("Female3DCG",e)}}function ds(e){return as[e]}class hs{static add(e){for(const[t,n]of Object.entries(e))for(const[e,r]of Object.entries(n))cs(t).forEach((({name:t})=>{AssetFemale3DCGExtended[t]||(AssetFemale3DCGExtended[t]={}),AssetFemale3DCGExtended[t][e]||(AssetFemale3DCGExtended[t][e]=r)}))}static get value(){return AssetFemale3DCGExtended}}const ps={};class ms{static add(e,t){return 0===Object.keys(ps).length&&AssetFemale3DCG.forEach((e=>{ps[e.Group]||(ps[e.Group]={});for(const t of e.Asset){const n=fs(t);ps[e.Group][n.Name]=n}})),ps[e]||(ps[e]={}),ps[e][t.Name]=t,ps}static get value(){return ps}}function fs(e){return"string"==typeof e?{Name:e}:e}function gs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ys,Es,vs,_s;function bs(){if(Es)return ys;Es=1;const e="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};return ys=e}function As(){if(_s)return vs;_s=1;const e=Number.MAX_SAFE_INTEGER||9007199254740991;return vs={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:e,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}}var Ss,Cs,Ps,Ls,Is,Ns,Ms,ws,Bs,Ds,Rs,Os={exports:{}};function ks(){if(Ms)return Ns;Ms=1;const e=bs(),{MAX_LENGTH:t,MAX_SAFE_INTEGER:n}=As(),{safeRe:r,safeSrc:i,t:s}=(Ss||(Ss=1,function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:i}=As(),s=bs(),o=(t=e.exports={}).re=[],a=t.safeRe=[],l=t.src=[],c=t.safeSrc=[],u=t.t={};let d=0;const h="[a-zA-Z0-9-]",p=[["\\s",1],["\\d",i],[h,r]],m=(e,t,n)=>{const r=(e=>{for(const[t,n]of p)e=e.split(`${t}*`).join(`${t}{0,${n}}`).split(`${t}+`).join(`${t}{1,${n}}`);return e})(t),i=d++;s(e,i,t),u[e]=i,l[i]=t,c[i]=r,o[i]=new RegExp(t,n?"g":void 0),a[i]=new RegExp(r,n?"g":void 0)};m("NUMERICIDENTIFIER","0|[1-9]\\d*"),m("NUMERICIDENTIFIERLOOSE","\\d+"),m("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${h}*`),m("MAINVERSION",`(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})`),m("MAINVERSIONLOOSE",`(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})`),m("PRERELEASEIDENTIFIER",`(?:${l[u.NUMERICIDENTIFIER]}|${l[u.NONNUMERICIDENTIFIER]})`),m("PRERELEASEIDENTIFIERLOOSE",`(?:${l[u.NUMERICIDENTIFIERLOOSE]}|${l[u.NONNUMERICIDENTIFIER]})`),m("PRERELEASE",`(?:-(${l[u.PRERELEASEIDENTIFIER]}(?:\\.${l[u.PRERELEASEIDENTIFIER]})*))`),m("PRERELEASELOOSE",`(?:-?(${l[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[u.PRERELEASEIDENTIFIERLOOSE]})*))`),m("BUILDIDENTIFIER",`${h}+`),m("BUILD",`(?:\\+(${l[u.BUILDIDENTIFIER]}(?:\\.${l[u.BUILDIDENTIFIER]})*))`),m("FULLPLAIN",`v?${l[u.MAINVERSION]}${l[u.PRERELEASE]}?${l[u.BUILD]}?`),m("FULL",`^${l[u.FULLPLAIN]}$`),m("LOOSEPLAIN",`[v=\\s]*${l[u.MAINVERSIONLOOSE]}${l[u.PRERELEASELOOSE]}?${l[u.BUILD]}?`),m("LOOSE",`^${l[u.LOOSEPLAIN]}$`),m("GTLT","((?:<|>)?=?)"),m("XRANGEIDENTIFIERLOOSE",`${l[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),m("XRANGEIDENTIFIER",`${l[u.NUMERICIDENTIFIER]}|x|X|\\*`),m("XRANGEPLAIN",`[v=\\s]*(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:${l[u.PRERELEASE]})?${l[u.BUILD]}?)?)?`),m("XRANGEPLAINLOOSE",`[v=\\s]*(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:${l[u.PRERELEASELOOSE]})?${l[u.BUILD]}?)?)?`),m("XRANGE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAIN]}$`),m("XRANGELOOSE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAINLOOSE]}$`),m("COERCEPLAIN",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?`),m("COERCE",`${l[u.COERCEPLAIN]}(?:$|[^\\d])`),m("COERCEFULL",l[u.COERCEPLAIN]+`(?:${l[u.PRERELEASE]})?`+`(?:${l[u.BUILD]})?(?:$|[^\\d])`),m("COERCERTL",l[u.COERCE],!0),m("COERCERTLFULL",l[u.COERCEFULL],!0),m("LONETILDE","(?:~>?)"),m("TILDETRIM",`(\\s*)${l[u.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",m("TILDE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAIN]}$`),m("TILDELOOSE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAINLOOSE]}$`),m("LONECARET","(?:\\^)"),m("CARETTRIM",`(\\s*)${l[u.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",m("CARET",`^${l[u.LONECARET]}${l[u.XRANGEPLAIN]}$`),m("CARETLOOSE",`^${l[u.LONECARET]}${l[u.XRANGEPLAINLOOSE]}$`),m("COMPARATORLOOSE",`^${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]})$|^$`),m("COMPARATOR",`^${l[u.GTLT]}\\s*(${l[u.FULLPLAIN]})$|^$`),m("COMPARATORTRIM",`(\\s*)${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]}|${l[u.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",m("HYPHENRANGE",`^\\s*(${l[u.XRANGEPLAIN]})\\s+-\\s+(${l[u.XRANGEPLAIN]})\\s*$`),m("HYPHENRANGELOOSE",`^\\s*(${l[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[u.XRANGEPLAINLOOSE]})\\s*$`),m("STAR","(<|>)?=?\\s*\\*"),m("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),m("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(Os,Os.exports)),Os.exports),o=function(){if(Ps)return Cs;Ps=1;const e=Object.freeze({loose:!0}),t=Object.freeze({});return Cs=n=>n?"object"!=typeof n?e:n:t}(),{compareIdentifiers:a}=function(){if(Is)return Ls;Is=1;const e=/^[0-9]+$/,t=(t,n)=>{const r=e.test(t),i=e.test(n);return r&&i&&(t=+t,n=+n),t===n?0:r&&!i?-1:i&&!r?1:t<n?-1:1};return Ls={compareIdentifiers:t,rcompareIdentifiers:(e,n)=>t(n,e)},Ls}();class l{constructor(i,a){if(a=o(a),i instanceof l){if(i.loose===!!a.loose&&i.includePrerelease===!!a.includePrerelease)return i;i=i.version}else if("string"!=typeof i)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof i}".`);if(i.length>t)throw new TypeError(`version is longer than ${t} characters`);e("SemVer",i,a),this.options=a,this.loose=!!a.loose,this.includePrerelease=!!a.includePrerelease;const c=i.trim().match(a.loose?r[s.LOOSE]:r[s.FULL]);if(!c)throw new TypeError(`Invalid Version: ${i}`);if(this.raw=i,this.major=+c[1],this.minor=+c[2],this.patch=+c[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");c[4]?this.prerelease=c[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<n)return t}return e})):this.prerelease=[],this.build=c[5]?c[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(e("SemVer.compare",this.version,this.options,t),!(t instanceof l)){if("string"==typeof t&&t===this.version)return 0;t=new l(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(e){return e instanceof l||(e=new l(e,this.options)),a(this.major,e.major)||a(this.minor,e.minor)||a(this.patch,e.patch)}comparePre(t){if(t instanceof l||(t=new l(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let n=0;do{const r=this.prerelease[n],i=t.prerelease[n];if(e("prerelease compare",n,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return-1;if(r!==i)return a(r,i)}while(++n)}compareBuild(t){t instanceof l||(t=new l(t,this.options));let n=0;do{const r=this.build[n],i=t.build[n];if(e("build compare",n,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return-1;if(r!==i)return a(r,i)}while(++n)}inc(e,t,n){if(e.startsWith("pre")){if(!t&&!1===n)throw new Error("invalid increment argument: identifier is empty");if(t){const e=new RegExp(`^${this.options.loose?i[s.PRERELEASELOOSE]:i[s.PRERELEASE]}$`),n=`-${t}`.match(e);if(!n||n[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"release":if(0===this.prerelease.length)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(n)?1:0;if(0===this.prerelease.length)this.prerelease=[e];else{let r=this.prerelease.length;for(;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);if(-1===r){if(t===this.prerelease.join(".")&&!1===n)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let r=[t,e];!1===n&&(r=[t]),0===a(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=r):this.prerelease=r}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return Ns=l}var $s,Ts,Fs,xs,Gs=function(){if(Rs)return Ds;Rs=1;const e=function(){if(Bs)return ws;Bs=1;const e=ks();return ws=(t,n,r=!1)=>{if(t instanceof e)return t;try{return new e(t,n)}catch(e){if(!r)return null;throw e}}}();return Ds=(t,n)=>{const r=e(t,n);return r?r.version:null},Ds}(),js=gs(Gs),Vs=function(){if(xs)return Fs;xs=1;const e=function(){if(Ts)return $s;Ts=1;const e=ks();return $s=(t,n,r)=>new e(t,r).compare(new e(n,r)),$s}();return Fs=(t,n,r)=>e(t,n,r)<0,Fs}(),zs=gs(Vs);function Us(e){return globalThis[e]}let Hs=class e{static _initStorage(){var e,t;Us(this._namespace)||(e=this._namespace,t={},globalThis[e]=t)}static get(e,t){this._initStorage();const n=Us(this._namespace);return e in n||(n[e]=t()),n[e]}static getMayOverride(e,t){this._initStorage();const n=Us(this._namespace);return n[e]=t(n[e]),n[e]}static getByVersion(e,t,n,r){if(this._initStorage(),!js(t))throw new Error(`Invalid version for ${e}: ${t}`);const i=Us(this._namespace),s=`${e}.__Version`,o=i[e],a=i[s];return o?a&&!zs(a,t)||(i[e]=r(a,o),i[s]=t):(i[e]=n(o),i[s]=t),i[e]}static set(e,t){this._initStorage(),Us(this._namespace)[e]=t}static has(e){return this._initStorage(),e in Us(this._namespace)}static delete(e){this._initStorage();const t=Us(this._namespace);return e in t&&delete t[e]}static setImplementation(t){const n=["get","set","has","delete"];for(const r of n){if("function"!=typeof t[r])throw new Error(`Implementation must provide a '${r}' function`);e[r]=t[r]}}static createNamespace(t){return{get:(n,r)=>e.get(`${t}.${n}`,r),getMayOverride:(n,r)=>e.getMayOverride(`${t}.${n}`,r),set:(n,r)=>e.set(`${t}.${n}`,r),has:n=>e.has(`${t}.${n}`),delete:n=>e.delete(`${t}.${n}`)}}};Hs._namespace="__BC_LUZI_GLOBALS__",Hs.createNamespace("OnceFlag");let Ws=class{get globalFuncName(){return this._globalFuncName}constructor(e,t){this.functions=[],this._globalFuncName=`${e}_${Math.random().toString(16).substring(2)}`,this.functions.push(((e,...n)=>t(...n))),globalThis[this._globalFuncName]=(...e)=>this.run(...e)}register(e){return this.functions.push(e),this}run(...e){let t;for(const n of this.functions)t=n(t,...e);return t}};function Xs(e,t,n){return Hs.get(e,(()=>{const r=new Ws(e,t);return n?.(r),r}))}const Ys={},qs={},Zs=[],Ks=(e,t)=>qs[e]?.[t];function Js(){return qs}function Qs(e){return!!(e&&e.Asset&&Ks(e.Asset.Group.Name,e.Asset.Name))}function eo(e,t){const n="TW"!==TranslationLanguage?TranslationLanguage:"CN";let r=e(n);return void 0!==r?r:(r="CN"===n?e("CN"):e("EN")||e("CN"),void 0!==r?r:t)}function to(e,t){return eo((t=>e[t]),t)}function no(e,t,n){return eo((n=>e[n]?.[t]),n)}const ro={};function io(e){for(const[t,n]of Object.entries(e)){ro[t]||(ro[t]={});for(const[e,r]of Object.entries(n))ro[t][e]=r,e.includes("ItemTorso2")?ro[t][e.replace("ItemTorso2","ItemTorso")]=r:e.includes("ItemTorso")&&(ro[t][e.replace("ItemTorso","ItemTorso2")]=r)}}let so=!1;function oo(e){return to(e,e.CN)}function ao(e,t){return e?e.CN?e:{...e,CN:t}:{CN:t}}function lo(e,t,n){const r={};for(const[i,s]of Object.entries(n))s[e]?.[t]&&(r[i]=s[e][t]);return r}function co(e,t,n){const r={};for(const[i,s]of Object.entries(n))s[e]?.[t]&&(r[i]=s[e][t]);return r}const uo={},ho={};class po{static setAsset(e,t,n){Object.entries(n).forEach((([n,r])=>{const i=n;uo[i]||(uo[i]={}),uo[i][e]||(uo[i][e]={}),uo[i][e][t]=r}))}static setGroup(e,t){Object.entries(t).forEach((([t,n])=>{const r=t;ho[r]||(ho[r]={}),ho[r][e]=n}))}}function mo(e,t){e.Description=t}function fo(){Object.values(Ys).forEach((e=>mo(e,function(e){return no(ho,e,e.replace(/_.*?Luzi$/,""))}(e.Name)))),Object.values(Js()).map((e=>Object.values(e))).flat().forEach((e=>mo(e,function(e,t){return n=uo,r=e,i=t,eo((e=>n[e]?.[r]?.[i]),t.replace(/_.*?Luzi$/,""));var n,r,i}(e.Group.Name,e.Name)))),Object.entries(Js()).map((([e,t])=>({group:ds(e),asset:t}))).filter((({group:e})=>!!e)).map((({group:e,asset:t})=>Object.entries(t).map((([t,n])=>({asset:n,fromAsset:AssetGet("Female3DCG",e,t)}))))).flat().filter((({fromAsset:e})=>!!e)).forEach((({asset:e,fromAsset:t})=>mo(e,t.Description)));const e=TextAllScreenCache.get(AssetStringsPath),t=e=>{const t=ls,n=new Set,r=AssetGroup.map((e=>e.Name)).sort(((e,t)=>t.length-e.length));Object.entries(e.cache).forEach((([i,s])=>{if(n.has(i))return;const o=r.find((e=>i.startsWith(e)));if(!o)return;n.add(i);const a=t[o];if(!a)return;const l=i.slice(o.length);a.forEach((t=>{const n=t+l;e.cache[n]||(e.cache[n]=s)}))}))};e&&(e.loaded?t(e):e.rebuildListeners.push((e=>e&&t(e))))}let go=!1;const yo=new Map,Eo=new Map;let vo,_o,bo;function Ao(e,t,n,r=!1){r&&yo.has(e)||yo.set(e,{desc:t,fallback:n,noOverride:r})}function So(e,t,{entries:n,noOverride:r}={}){const i=function(e){if(!e)return e=>({CN:e});const t={};for(const[n,r]of Object.entries(e))for(const[e,i]of Object.entries(r))t[e]||(t[e]={}),t[e][n]=i;return e=>t[e]||{CN:e}}(n),s=new Set;t.Layer?.filter((e=>!e.CopyLayerColor&&(e.AllowColorize??!0)&&!e.HideColoring)).forEach((({Name:n,ColorGroup:o})=>{n?Ao(`${e}${t.Name}${n}`,i(n),n,!!r):Ao(`${e}${t.Name}`,{CN:t.Name.replace(/_.*?Luzi$/,"")},t.Name,!!r),o&&s.add(o)})),s.forEach((n=>function(e,t,n,r=!1){r&&Eo.has(e)||Eo.set(e,{desc:t,fallback:n,noOverride:r})}(`${e}${t.Name}${n}`,i(n),n,!!r)))}class Co{static info(e){bo?.info(e)}static warn(e){bo?.warn(e)}static error(e){bo?.error(e)}}let Po=!1;const Lo=[];function Io(e){Po?e():Lo.push(e)}const No={},Mo={};function wo(e,t){const n=AssetGroupGet("Female3DCG",e);Po&&n?t(n):(Mo[e]||(Mo[e]=[]),Mo[e].push(t))}let Bo=!1;const Do=[];function Ro(e){Bo?e():Do.push(e)}const Oo=new Set;function ko(e,t,{extendedConfig:n,translation:r,dynamicName:i,preimage:s,noMirror:o,layerNames:a,assetStrings:l}={}){!function(e,t){const n=AssetGroupGet("Female3DCG",e);Po&&n?t(n):(No[e]||(No[e]=[]),No[e].push(t))}(e,(e=>{ms.add(e.Name,t),n&&hs.add(n)}));const c=e;!function(e,t,n){const r=n=>{const i=t?[us(e)]:cs(e),s=i.find((({group:e})=>!e));if(s)return Oo.has(s.name)?void console.error(`[AssetManager] Required group "${s.name}" not found`):(Oo.add(s.name),void wo(s.name,(()=>r(n))));i.forEach((({group:e})=>n(e)))};Po?r(n):wo(e,(()=>r(n)))}(e,!!o,(e=>{const n=e.Name,o=fs(t),u=AssetResolveCopyConfig.AssetDefinition(o,n,ms.value);if(!u)return;const d=ao(r,u.Name.replace(/_.*?Luzi$/,""));void 0!==Js()[n]?.[o.Name]&&console.warn(`[AssetManager] Asset {${n}:${o.Name}} already existed!`),function(...[e,t,n]){Ut.invokeOriginal("AssetAdd",e,t,n);const r=e.Name,i=t.Name;qs[r]||(qs[r]={});const s=AssetGet("Female3DCG",r,i);return s?(qs[r][i]=s,Promise.resolve(s)):Promise.reject(`Asset ${r}:${i} not found`)}(e,u,hs.value).then((e=>{if(e.DynamicGroupName===e.Group.Name&&(e.DynamicGroupName=i||c),s){const t=AssetGet("Female3DCG",s.Name,u.Name);t&&(e.Description=t.Description,e.DynamicGroupName=t.DynamicGroupName,["ScriptDraw","BeforeDraw","AfterDraw"].filter((e=>t[`Dynamic${e}`])).forEach((e=>function(e,t,n,r){const i=`Assets${t}${n.Name}${r}`,s=`Assets${e}${n.Name}${r}`;globalThis[i]&&(globalThis[s]=globalThis[i])}(n,s.Name,u,e))))}else e.Description=oo(d),function(e,t){Zs.push({name:e,asset:t})}(u.Name,e),So(e.DynamicGroupName,u,{entries:a,noOverride:!a});l&&function(e,t,n){for(const[r,i]of Object.entries(n)){ro[r]||(ro[r]={});for(const[n,s]of Object.entries(i))ro[r][`${e}${t}${n}`]=s}}(e.Group.Name,e.Name,l)})),po.setAsset(n,u.Name,d)}))}const $o={};function To(e,{translation:t,dynamicName:n,preimage:r}={}){Io((()=>{const i=ao(t,e.Group.replace(/_.*?Luzi$/,""));(function(...[e,t]){const n=Ut.invokeOriginal("AssetGroupAdd",e,t);return Ys[n.Name]=n,Promise.resolve(n)})("Female3DCG",e).then((t=>{t.Description=oo(i),n&&(t.DynamicGroupName=n),e.Asset.forEach((t=>{ko(e.Group,fs(t),{dynamicName:n,preimage:r})}))})),po.setGroup(e.Group,i)}))}const Fo=new Set;function xo(e,t,n){const r=()=>{const i=AssetFemale3DCG.find((e=>e.Group===t)),s=AssetGroupGet("Female3DCG",t),o=AssetFemale3DCGExtended[t];if(!i||!s)return Fo.has(t)?void console.error(`[AssetManager] Group ${t} not found`):(Fo.add(t),void Io(r));var a,l;l=e,os[a=t]||(os[a]=new Set([a])),os[a].add(l),ls[a]||(ls[a]=new Set),ls[a].add(l),as[l]=a;const c=ao(n,e.replace(/_.*?Luzi$/,""));To({...i,Group:e,Default:!1,Random:!1},{translation:c,dynamicName:i.DynamicGroupName||i.Group,preimage:s}),AssetFemale3DCGExtended[e]=o};Io(r)}let Go,jo=!1;var Vo,zo,Uo,Ho;function Wo(){if(zo)return Vo;zo=1;const e="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};return Vo=e}function Xo(){if(Ho)return Uo;Ho=1;const e=Number.MAX_SAFE_INTEGER||9007199254740991;return Uo={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:e,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}}var Yo,qo,Zo,Ko,Jo,Qo,ea,ta,na,ra,ia,sa={exports:{}};var oa=function(){if(ia)return ra;ia=1;const e=function(){if(na)return ta;na=1;const e=function(){if(ea)return Qo;ea=1;const e=Wo(),{MAX_LENGTH:t,MAX_SAFE_INTEGER:n}=Xo(),{safeRe:r,safeSrc:i,t:s}=(Yo||(Yo=1,function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:i}=Xo(),s=Wo(),o=(t=e.exports={}).re=[],a=t.safeRe=[],l=t.src=[],c=t.safeSrc=[],u=t.t={};let d=0;const h="[a-zA-Z0-9-]",p=[["\\s",1],["\\d",i],[h,r]],m=(e,t,n)=>{const r=(e=>{for(const[t,n]of p)e=e.split(`${t}*`).join(`${t}{0,${n}}`).split(`${t}+`).join(`${t}{1,${n}}`);return e})(t),i=d++;s(e,i,t),u[e]=i,l[i]=t,c[i]=r,o[i]=new RegExp(t,n?"g":void 0),a[i]=new RegExp(r,n?"g":void 0)};m("NUMERICIDENTIFIER","0|[1-9]\\d*"),m("NUMERICIDENTIFIERLOOSE","\\d+"),m("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${h}*`),m("MAINVERSION",`(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})`),m("MAINVERSIONLOOSE",`(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})`),m("PRERELEASEIDENTIFIER",`(?:${l[u.NUMERICIDENTIFIER]}|${l[u.NONNUMERICIDENTIFIER]})`),m("PRERELEASEIDENTIFIERLOOSE",`(?:${l[u.NUMERICIDENTIFIERLOOSE]}|${l[u.NONNUMERICIDENTIFIER]})`),m("PRERELEASE",`(?:-(${l[u.PRERELEASEIDENTIFIER]}(?:\\.${l[u.PRERELEASEIDENTIFIER]})*))`),m("PRERELEASELOOSE",`(?:-?(${l[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[u.PRERELEASEIDENTIFIERLOOSE]})*))`),m("BUILDIDENTIFIER",`${h}+`),m("BUILD",`(?:\\+(${l[u.BUILDIDENTIFIER]}(?:\\.${l[u.BUILDIDENTIFIER]})*))`),m("FULLPLAIN",`v?${l[u.MAINVERSION]}${l[u.PRERELEASE]}?${l[u.BUILD]}?`),m("FULL",`^${l[u.FULLPLAIN]}$`),m("LOOSEPLAIN",`[v=\\s]*${l[u.MAINVERSIONLOOSE]}${l[u.PRERELEASELOOSE]}?${l[u.BUILD]}?`),m("LOOSE",`^${l[u.LOOSEPLAIN]}$`),m("GTLT","((?:<|>)?=?)"),m("XRANGEIDENTIFIERLOOSE",`${l[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),m("XRANGEIDENTIFIER",`${l[u.NUMERICIDENTIFIER]}|x|X|\\*`),m("XRANGEPLAIN",`[v=\\s]*(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:${l[u.PRERELEASE]})?${l[u.BUILD]}?)?)?`),m("XRANGEPLAINLOOSE",`[v=\\s]*(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:${l[u.PRERELEASELOOSE]})?${l[u.BUILD]}?)?)?`),m("XRANGE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAIN]}$`),m("XRANGELOOSE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAINLOOSE]}$`),m("COERCEPLAIN",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?`),m("COERCE",`${l[u.COERCEPLAIN]}(?:$|[^\\d])`),m("COERCEFULL",l[u.COERCEPLAIN]+`(?:${l[u.PRERELEASE]})?`+`(?:${l[u.BUILD]})?(?:$|[^\\d])`),m("COERCERTL",l[u.COERCE],!0),m("COERCERTLFULL",l[u.COERCEFULL],!0),m("LONETILDE","(?:~>?)"),m("TILDETRIM",`(\\s*)${l[u.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",m("TILDE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAIN]}$`),m("TILDELOOSE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAINLOOSE]}$`),m("LONECARET","(?:\\^)"),m("CARETTRIM",`(\\s*)${l[u.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",m("CARET",`^${l[u.LONECARET]}${l[u.XRANGEPLAIN]}$`),m("CARETLOOSE",`^${l[u.LONECARET]}${l[u.XRANGEPLAINLOOSE]}$`),m("COMPARATORLOOSE",`^${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]})$|^$`),m("COMPARATOR",`^${l[u.GTLT]}\\s*(${l[u.FULLPLAIN]})$|^$`),m("COMPARATORTRIM",`(\\s*)${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]}|${l[u.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",m("HYPHENRANGE",`^\\s*(${l[u.XRANGEPLAIN]})\\s+-\\s+(${l[u.XRANGEPLAIN]})\\s*$`),m("HYPHENRANGELOOSE",`^\\s*(${l[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[u.XRANGEPLAINLOOSE]})\\s*$`),m("STAR","(<|>)?=?\\s*\\*"),m("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),m("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(sa,sa.exports)),sa.exports),o=function(){if(Zo)return qo;Zo=1;const e=Object.freeze({loose:!0}),t=Object.freeze({});return qo=n=>n?"object"!=typeof n?e:n:t}(),{compareIdentifiers:a}=function(){if(Jo)return Ko;Jo=1;const e=/^[0-9]+$/,t=(t,n)=>{const r=e.test(t),i=e.test(n);return r&&i&&(t=+t,n=+n),t===n?0:r&&!i?-1:i&&!r?1:t<n?-1:1};return Ko={compareIdentifiers:t,rcompareIdentifiers:(e,n)=>t(n,e)},Ko}();class l{constructor(i,a){if(a=o(a),i instanceof l){if(i.loose===!!a.loose&&i.includePrerelease===!!a.includePrerelease)return i;i=i.version}else if("string"!=typeof i)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof i}".`);if(i.length>t)throw new TypeError(`version is longer than ${t} characters`);e("SemVer",i,a),this.options=a,this.loose=!!a.loose,this.includePrerelease=!!a.includePrerelease;const c=i.trim().match(a.loose?r[s.LOOSE]:r[s.FULL]);if(!c)throw new TypeError(`Invalid Version: ${i}`);if(this.raw=i,this.major=+c[1],this.minor=+c[2],this.patch=+c[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");c[4]?this.prerelease=c[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<n)return t}return e})):this.prerelease=[],this.build=c[5]?c[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(e("SemVer.compare",this.version,this.options,t),!(t instanceof l)){if("string"==typeof t&&t===this.version)return 0;t=new l(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(e){return e instanceof l||(e=new l(e,this.options)),a(this.major,e.major)||a(this.minor,e.minor)||a(this.patch,e.patch)}comparePre(t){if(t instanceof l||(t=new l(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let n=0;do{const r=this.prerelease[n],i=t.prerelease[n];if(e("prerelease compare",n,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return-1;if(r!==i)return a(r,i)}while(++n)}compareBuild(t){t instanceof l||(t=new l(t,this.options));let n=0;do{const r=this.build[n],i=t.build[n];if(e("build compare",n,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return-1;if(r!==i)return a(r,i)}while(++n)}inc(e,t,n){if(e.startsWith("pre")){if(!t&&!1===n)throw new Error("invalid increment argument: identifier is empty");if(t){const e=new RegExp(`^${this.options.loose?i[s.PRERELEASELOOSE]:i[s.PRERELEASE]}$`),n=`-${t}`.match(e);if(!n||n[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"release":if(0===this.prerelease.length)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(n)?1:0;if(0===this.prerelease.length)this.prerelease=[e];else{let r=this.prerelease.length;for(;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);if(-1===r){if(t===this.prerelease.join(".")&&!1===n)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let r=[t,e];!1===n&&(r=[t]),0===a(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=r):this.prerelease=r}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return Qo=l}();return ta=(t,n,r=!1)=>{if(t instanceof e)return t;try{return new e(t,n)}catch(e){if(!r)return null;throw e}},ta}();return ra=(t,n)=>{const r=e(t,n);return r?r.version:null},ra}(),aa=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(oa);function la(e){return globalThis[e]}class ca{static _initStorage(){var e,t;la(this._namespace)||(e=this._namespace,t={},globalThis[e]=t)}static get(e,t){this._initStorage();const n=la(this._namespace);return e in n||(n[e]=t()),n[e]}static getMayOverride(e,t){this._initStorage();const n=la(this._namespace);return n[e]=t(n[e]),n[e]}static getByVersion(e,t,n,r){if(this._initStorage(),!aa(t))throw new Error(`Invalid version for ${e}: ${t}`);const i=la(this._namespace),s=`${e}.__Version`,o=i[e],a=i[s];return o?a&&!zs(a,t)||(i[e]=r(a,o),i[s]=t):(i[e]=n(o),i[s]=t),i[e]}static set(e,t){this._initStorage(),la(this._namespace)[e]=t}static has(e){return this._initStorage(),e in la(this._namespace)}static delete(e){this._initStorage();const t=la(this._namespace);return e in t&&delete t[e]}static setImplementation(e){const t=["get","set","has","delete"];for(const n of t){if("function"!=typeof e[n])throw new Error(`Implementation must provide a '${n}' function`);ca[n]=e[n]}}static createNamespace(e){return{get:(t,n)=>ca.get(`${e}.${t}`,n),getMayOverride:(t,n)=>ca.getMayOverride(`${e}.${t}`,n),set:(t,n)=>ca.set(`${e}.${t}`,n),has:t=>ca.has(`${e}.${t}`),delete:t=>ca.delete(`${e}.${t}`)}}}ca._namespace="__BC_LUZI_GLOBALS__";const ua=ca.createNamespace("OnceFlag");function da(e){return new Promise((t=>setTimeout(t,e)))}class ha{static get emptyImage(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAG3RFWHRTb2Z0d2FyZQBDZWxzeXMgU3R1ZGlvIFRvb2zBp+F8AAAADUlEQVQI12P4//8/AwAI/AL+XJ/P2gAAAABJRU5ErkJggg=="}static assetPreviewIconPath(e){const t="Asset"in e?e.Asset:e;return`${AssetGetPreviewPath(t)}/${t.Name}.png`}static activityPreviewIconPath(e){return`Assets/Female3DCG/Activity/${("Activity"in e?e.Activity:e).Name}.png`}}function pa(e,t){const n=new Set;let r=e;for(;t[r];){if(n.has(r))return console.warn(`Circular dependency detected during resolution: ${r}`),"";n.add(r),r=t[r]}return r}function ma(e){const t={};for(const n of Object.keys(e)){const r=pa(n,e);if(!r)return console.warn(`Circular dependency detected during optimization: ${n}`),null;t[n]=r}return t}const fa=new class{constructor(){this.basic={},this.custom={},this.customSrc={}}addImgMapping(e){const t={...this.customSrc,...e},n=ma(t);n?(this.customSrc=t,this.custom=n):console.warn("Failed to add mappings due to circular dependencies.")}rebuildCustomMapping(){const e=ma(this.customSrc);e?this.custom=e:console.warn("Failed to rebuild mappings due to circular dependencies.")}migrateTo(e){e.customSrc={...e.customSrc,...this.customSrc},e.basic={...e.basic,...this.basic},e.rebuildCustomMapping(),this.customSrc=e.customSrc,this.basic=e.basic,this.custom=e.custom}setBasicImgMapping(e){this.basic={...e,...this.basic}}mapImgSrc(e){if("string"!=typeof e)return e;if(!e.endsWith(".png"))return e;if(e.startsWith("data:image"))return e;if(e.startsWith("http"))return e;const t=e.startsWith("./")?e.slice(2):e;let n=t;return this.custom[n]&&(n=this.custom[n]),this.basic[n]&&(n=this.basic[n]),n!==t?n:e}mapImg(e,t){let n=e;n.startsWith("data:image")||n.startsWith("http")||(this.custom[n]&&(n=this.custom[n]),this.basic[n]&&(n=this.basic[n]),n!==e&&t(n))}};class ga{constructor(){!function(e){ua.get(e,(()=>!1))||(ua.set(e,!0),Ut.patchFunction("GLDrawLoadImage",{"Img.src = url;":'Img.crossOrigin = "Anonymous";\n\t\tImg.src = url;'}))}("ImgMappingOnce.GLDrawLoadImage.crossOrigin"),["DrawImageEx","DrawImageResize","GLDrawImage","DrawGetImage"].forEach((e=>{Ut.hookFunction(e,0,((e,t)=>(e[0]=fa.mapImgSrc(e[0]),t(e))))})),"R114"!==GameVersion&&Ut.hookFunction("GLDrawLoadTextureAlphaMask",0,((e,t)=>(Array.isArray(e[5])&&(e[5]=e[5].map((e=>({...e,Url:fa.mapImgSrc(e.Url)})))),t(e)))),(async()=>{await function(e,t=100){return(async()=>{for(;!e();)await da(t)})()}((()=>void 0!==globalThis.ElementButton)),Ut.hookFunction("ElementButton.CreateForAsset",0,((e,t)=>(fa.mapImg(ha.assetPreviewIconPath(e[1]),(t=>{e[4]={...e[4],image:t}})),t(e)))),Ut.hookFunction("ElementButton.CreateForActivity",0,((e,t)=>{const n=e[1],r=e[4]?.image??(n.Item?ha.assetPreviewIconPath(n.Item.Asset):`Assets/Female3DCG/Activity/${n.Activity.Name}.png`);return fa.mapImg(r,(t=>{e[4]={...e[4],image:t}})),t(e)})),Ut.hookFunction("ElementButton.Create",0,((e,t)=>{if(e[0]?.startsWith("dialog-inventory")){const t=e[2];t?.icons&&(t.icons=t.icons.map((e=>{if("string"==typeof e&&e.endsWith("Padlock")){const t=`Assets/Female3DCG/ItemMisc/Preview/${e}.png`,n=fa.mapImgSrc(t);if(n!==t)return{name:e,iconSrc:n,tooltipText:InterfaceTextGet("PreviewIconPadlock").replace("AssetName",AssetGet("Female3DCG","ItemMisc",e)?.Description??e)}}return e})))}if(e[0]?.startsWith("dialog-expression-button-grid-Emoticon")){const t=e[2];t?.image&&(t.image=fa.mapImgSrc(t.image))}return t(e)}))})()}get storage(){return fa}addImgMapping(e){fa.addImgMapping(e)}setBasicImgMapping(e){fa.setBasicImgMapping(e)}}const ya=ca.get("ImageMapping@1.1.1",(()=>new ga)),Ea=new class{addAsset(e,t,n,r,i=!1){ko(e,t,n?{extendedConfig:{[e]:{[t.Name]:n}},translation:r,noMirror:i}:{translation:r,noMirror:i})}addAssetWithConfig(e,t,n){ko(e,t,{translation:n.translation,noMirror:n.noMirror,layerNames:n.layerNames,...n.extended?{extendedConfig:{[e]:{[t.Name]:n.extended}}}:{},assetStrings:n.assetStrings??n.assetDialogs})}addGroupedAssetsWithConfig(e,t,n){for(const[r,i]of Object.entries(e))for(const e of i){const i=r;ko(i,e,{translation:co(i,e.Name,t),layerNames:lo(i,e.Name,n)})}}addGroupedAssets(e,t,n){for(const[r,i]of Object.entries(e))for(const e of i){const i=r,s=t&&co(i,e.Name,t);ko(i,e,{extendedConfig:n&&n[i]?.[e.Name]&&{[i]:{[e.Name]:n[i][e.Name]}},translation:s})}}addGroupedConfig(e){!function(e){e&&hs.add(e)}(e)}modifyAsset(e,t,n){!function(e,t,n){"string"==typeof e&&(e=[e]);for(const r of e){const e=i=>{const s=AssetGet("Female3DCG",i.Name,t);if(s)n(i,s);else{if($o[r]||($o[r]=new Set),$o[r].has(t))return void console.error(`[AssetManager] Asset ${r}:${t} not found`);$o[r].add(t),wo(r,e)}};wo(r,e)}}(e,t,n)}modifyAssetLayers(e,t){!function(e,t){Ro((()=>{Asset.filter(e).forEach((e=>{e.Layer.forEach((n=>t(e,n)))}))}))}(e,t)}modifyGroup(e,t){!function(e,t){wo(e,(e=>t(e)))}(e,t)}addCustomAssetString(e){io(e)}addCustomDialog(e){io(e)}addImageMapping(e){ya.addImgMapping(e)}get imageMapping(){return ya}addGroup(e,t){To(e,{translation:t})}addCopyGroup(e,t,n){xo(e,t,n)}addLayerNames(e,t,n){So(e,t,{entries:n})}addLayerNamesByEntry(e,t,n){}assetIsCustomed(e){return void 0!==Js()[e.Group.Name]?.[e.Name]}assetNameIsStrictCustomed(e){return void 0!==(t=e,Zs.find((e=>e.name===t))?.asset);var t}afterLoad(e){Ro(e)}init(e){!function(){if(so)return;so=!0;const e=e=>no(ro,e);Ut.progressiveHook("AssetTextGet").override(((t,n)=>e(t[0])||n(t))),Ut.progressiveHook("ChatRoomPublishCustomAction").inject((t=>{const[n,r,i]=t,s=e(n);s&&i.push({Tag:`MISSING TEXT IN "Interface.csv": ${n}`,Text:s})})).next()}(),function(){if(go)return;go=!0;const e=TextAllScreenCache.get(AssetStringsPath);e&&e.loaded&&("EN"===TranslationLanguage||"Bloated"!==e.get("Bloated"))&&fo(),Ut.progressiveHook("AssetBuildDescription").next().inject(fo),Ut.progressiveHook("TranslationAssetProcess").next().inject(fo),Xs("CustomDialogInject",(()=>{}),(e=>Ut.patchFunction("ChatRoomPublishAction",{"\t\tdictionary.focusGroup(C.FocusGroup.Name);\n\t}":`\t\tdictionary.focusGroup(C.FocusGroup.Name);\n\t}\n\t${e.globalFuncName}(dictionary, PrevItem, NextItem);\n`}))).register(((e,t,n,r)=>{for(const[e,i]of[["PrevAsset",n],["NextAsset",r]])Qs(i)&&t.text(e,i.Asset.Description)}))}(),Xs("LayerNameInject",(()=>{}),(e=>Ut.patchFunction("ItemColorLoad",{"ItemColorGroupNames = new TextCache(`Assets/${c.AssetFamily}/ColorGroups.csv`);":`ItemColorGroupNames = new TextCache(\`Assets/\${c.AssetFamily}/ColorGroups.csv\`);${e.globalFuncName}(()=>ItemColorLayerNames, ()=>ItemColorGroupNames);`}))).register(((e,t,n)=>{vo=t,_o=n})),Ut.hookFunction("ItemColorLoad",0,((e,t)=>{const n=t(e),r=vo?.();var i;r&&r.cache&&(i=r,yo.forEach(((e,t)=>{i.cache[t]&&e.noOverride||(i.cache[t]=to(e.desc,e.fallback))})));const s=_o?.();return s&&s.cache&&function(e){Eo.forEach(((t,n)=>{e.cache[n]&&t.noOverride||(e.cache[n]=to(t.desc,t.fallback))}))}(s),n})),function(){let e=!1;Ut.progressiveHook("DialogInventoryBuild").inject((t=>{t[2]||(e=!0)})),Ut.progressiveHook("DialogInventoryAdd").next().inject((t=>{if(!e)return;e=!1;const n=t[1].Asset.Group.Name,r=new Set(DialogInventory.map((e=>e.Asset.Name)));qs[n]&&Object.entries(qs[n]).filter((([e,t])=>!t.NotVisibleOnScreen?.includes("LuziScreen")&&!r.has(e))).forEach((([e,n])=>DialogInventoryAdd(t[0],{Asset:n},!1)))}));const t=(...[e,t])=>{const[n,r,i]=e;return!!Ks(i,r)||t(e)};if(Ut.progressiveHook("InventoryAvailable").inside("CharacterAppearanceValidate").override(t),Ut.progressiveHook("InventoryAvailable").inside("CraftingItemListBuild").override(t),Ut.progressiveHook("InventoryAvailable").inside("WardrobeFastLoad").override(t),"R114"===GameVersion){Ut.progressiveHook("CraftingValidate").inject((e=>{const t=e[0]?.Item;if(!t)return;const n=CraftingAssets[t]?.[0];n&&function(e,t){const n=Ks(e,t);return!!n&&!n.NotVisibleOnScreen?.includes("LuziScreen")}(n.Group.Name,n.Name)&&(e[3]=!1)}));const e=e=>Object.values(e).map((e=>Object.values(e))).flat().map((e=>({Asset:e})));Xs("CraftingInventory",(()=>Player.Inventory),(e=>Ut.patchFunction("CraftingRun",{"for (let Item of Player.Inventory) {":`for (let Item of ${e.globalFuncName}()) {`}))).register((t=>[...t,...e(qs).flat()]))}else Ut.progressiveHook("InventoryAvailable").inside("CraftingValidate").override(t)}(),e(),function(e={start:"Start loading",end:"Loading completed, time usage: "}){const t=()=>{Co.info(e.start);const t=Date.now();for(function(){for(;Lo.length>0;)Lo.shift()()}(),Po=!0,AssetGroup.forEach((e=>function(e){if(No[e.Name])for(;No[e.Name].length>0;)No[e.Name].shift()(e)}(e))),AssetGroup.forEach((e=>function(e){if(Mo[e.Name])for(;Mo[e.Name].length>0;)Mo[e.Name].shift()(e)}(e))),CraftingAssets=CraftingAssetsPopulate(),Bo=!0;Do.length>0;)Do.shift()();const n=Date.now();Co.info(`${e.end} ${n-t}ms`)};AssetGroup.length>50?t():Ut.progressiveHook("AssetLoadAll",1).next().inject((()=>t()))}()}enableValidation(e){!function(e){Go=e,jo||(jo=!0,Ut.hookFunction("ValidationResolveRemoveDiff",1,((e,t)=>{const[n,r]=e;return!r.fromModUser&&Ks(n.Asset.Group.Name,n.Asset.Name)?{item:n,valid:!1}:t(e)})),Ut.hookFunction("ValidationResolveSwapDiff",1,((e,t)=>{const[n,r,i]=e;return!i.fromModUser&&Ks(n.Asset.Group.Name,n.Asset.Name)?{item:n,valid:!1}:t(e)})),Ut.hookFunction("ValidationResolveAppearanceDiff",1,((e,t)=>(Go&&(e[3].fromModUser=Go(e[3])),t(e)))))}(e)}setLogger(e){!function(e){bo=e}(e)}typeBodyGroupNames(){return this}},va={Name:"Stroller",Random:!1,Left:0,Top:0,Priority:40,Fetish:["ABDL"],Category:["ABDL"],DefaultColor:["#676285"],SetPose:[...PoseAllKneeling],AllowActivePose:[...PoseAllKneeling],Difficulty:8,RemoveTime:15,AllowLock:!0,AllowTighten:!0,Effect:[E.Freeze,E.Leash],AllowEffect:[E.Leash,E.IsLeashed],OverrideHeight:{Height:-100,Priority:51,HeightRatioProportion:0},ParentGroup:{},Layer:[{Priority:3,Name:"Outline"}]},_a={EN:"Stroller (DO NOT USE PLZZZ)",RU:"Стрелка",CN:"婴儿推车"};Ea.init((()=>{Ea.addImageMapping({"Assets/Female3DCG/ItemDevices/Stroller_Outline.png":"https://zoe-64.github.io/ABCL/versions/2.2.2/assets/items/other/stroller/Stroller_Outline.png","Assets/Female3DCG/ItemDevices/Preview/Stroller.png":"https://zoe-64.github.io/ABCL/versions/2.2.2/assets/items/other/stroller/Stroller_Outline.png"}),Ea.addAsset("ItemDevices",va,void 0,_a)}));const ba=()=>{"ChatRoom"===CurrentScreen&&Cn.update()};Ut.afterPlayerLogin((async()=>{console.log("init"),(async()=>{const t=LZString.decompressFromBase64(Player.ExtensionSettings.ABCL),n=t?JSON.parse(t):{Settings:{},Stats:{}};if("2.0.0"===n.ModVersion){const e=n.Settings.Metabolism,t=n.Settings.DisableWetting;n.Settings={...Object.fromEntries(Object.entries(n.Settings).filter((([e])=>!["DisableWetting","DisableSoiling","Metabolism","CaregiverIDs"].includes(e))).map((([e,{value:t}])=>[e,t]))),PeeMetabolism:t?"Disabled":e,PoopMetabolism:t?"Disabled":e},n.ModVersion=void 0,n.Version="2.0.1"}const r=Lt({Settings:It,Stats:Nt,Version:"2.2.2"},n);e.debug({message:"Merged settings object",modStorageObject:r}),Player.ABCL=r})(),is(),Ut.hookFunction("DialogMenuMapping.activities.GetClickStatus",1,((e,t)=>{const[n,r,i]=e;return r?t(e):null})),Ut.hookFunction("DialogChangeMode",1,(async(e,t)=>{const[n]=e;if(t(e),"activities"!==n)return;const r=CurrentCharacter?.FocusGroup?CurrentCharacter:Player,i=await Xt("#dialog-activity-grid"),s=r.FocusGroup?.Name;if(s)for(const{activity:e}of Or){if(!e)continue;const t=new Rr(e.ID,e.Name,e.Image,e.OnClick,e.Target,e.TargetSelf,e.Criteria);t.fitsCriteria(r,s)&&(Rr.isInserted(e.ID)||i.appendChild(t.createButton()))}})),CommandCombine(kr),Fr(),hn(new fn),hn(new gn),document.body.appendChild(nn),Xt("#chat-room-div",{childCheck:!0,timeout:1e22}).then((()=>{Xt(".ABCL-overlay",{timeout:1e22}).then((()=>{document.removeChild(nn),setTimeout((()=>{document.appendChild(nn)}),1e3)}))})),window.ABCL={version:"2.2.2",inModSubscreen:()=>Boolean(nn.querySelector(".ABCLSettingPage")?.classList.contains("ABCL-hidden")),isABCLPlayer:an,wet:Cn.wet,attemptWetting:Cn.attemptWetting,soil:Cn.soil,attemptSoiling:Cn.attemptSoiling,settings:Player.ABCL.Settings,stats:Cn.stats,actions:{changeDiaper:Wn,checkDiaper:qn,diaperFaceRub:()=>$r("diaperFaceRub",void 0,Player.MemberNumber),diaperFaceSit:()=>$r("diaperFaceSit",void 0,Player.MemberNumber),diaperPatBack:()=>$r("diaperPatBack",void 0,Player.MemberNumber),diaperPatFront:()=>$r("diaperPatFront",void 0,Player.MemberNumber),diaperPeeOthersDiaper:()=>$r("diaperPeeOthersDiaper",void 0,Player.MemberNumber),diaperPour:()=>$r("diaperPour",void 0,Player.MemberNumber),diaperRubBack:()=>$r("diaperRubBack",void 0,Player.MemberNumber),diaperRubFront:()=>$r("diaperRubFront",void 0,Player.MemberNumber),diaperSquishBack:()=>$r("diaperSquishBack",void 0,Player.MemberNumber),diaperSquishFront:()=>$r("diaperSquishFront",void 0,Player.MemberNumber),wipePuddle:()=>$r("wipePuddle",void 0,Player.MemberNumber),lickPuddle:()=>$r("lickPuddle",void 0,Player.MemberNumber),sendABCLmessage:(e,t)=>$r("onABCLMessage",{message:e,local:t},Player.MemberNumber),useToilet:()=>Nr(),usePotty:()=>Lr(),get canUseToilet(){return Mr.activity?.Criteria?.(Player)},get canUsePotty(){return Ir.activity?.Criteria?.(Player)},get canChangeDiaper(){return Yn.activity?.Criteria?.(Player)},get canCheckDiaper(){return Zn.activity?.Criteria?.(Player)}},raw:{sendUpdateMyData:Tr,sendDataToAction:$r,mentalRegressionBonus:jn,mentalRegressionOvertime:Vn,mentalRegressionOnAccident:Un,incontinenceOnAccident:zn,incontinenceChanceFormula:Gn,incontinenceLimitFormula:xn,updateDiaperColor:kn,getPlayerDiaperSize:$n,getPlayerDiaper:Fn,getDiaperVerb:Hn,setDiaperColor:On,isDiaperLocked:Rn,isDiaperDirty:Nn,isDiaper:Mn,isABCLPlayer:an,isLeaking:In,hasDiaper:wn,utility:{getCharacter:sn},clearData:Dt,updateData:wt}},setInterval(ba,6e4),e.info("Ready.")}))}();
//# sourceMappingURL=abcl.js.map
